I001 [*] Import block is un-sorted or un-formatted
 --> app/api/main.py:1:1
  |
1 | / from app.api.routers import system
2 | | from fastapi import FastAPI
  | |___________________________^
  |
help: Organize imports

F401 [*] `fastapi.Request` imported but unused
  --> app/api/routers/admin.py:8:56
   |
 6 | import json
 7 |
 8 | from fastapi import APIRouter, Depends, HTTPException, Request
   |                                                        ^^^^^^^
 9 | from fastapi.responses import StreamingResponse
10 | from pydantic import BaseModel
   |
help: Remove unused import: `fastapi.Request`

I001 [*] Import block is un-sorted or un-formatted
 --> app/api/routers/chat.py:2:1
  |
1 |   # app/api/routers/chat.py
2 | / import json
3 | |
4 | | from fastapi import APIRouter, Depends, WebSocket, WebSocketDisconnect
5 | |
6 | | from app.core.ai_gateway import AIClient, get_ai_client
  | |_______________________________________________________^
  |
help: Organize imports

I001 [*] Import block is un-sorted or un-formatted
  --> app/api/routers/system.py:8:1
   |
 6 |   """
 7 |
 8 | / from fastapi import APIRouter, Depends, status
 9 | | from fastapi.responses import JSONResponse
10 | | from sqlalchemy.ext.asyncio import AsyncSession
11 | | from sqlalchemy import text
12 | |
13 | | from app.core.database import get_db
   | |____________________________________^
14 |
15 |   router = APIRouter(
   |
help: Organize imports

I001 [*] Import block is un-sorted or un-formatted
  --> app/cli_handlers/db_cli.py:2:1
   |
 1 |   # app/cli_handlers/db_cli.py
 2 | / import os
 3 | | from collections.abc import Generator
 4 | | from contextlib import contextmanager
 5 | |
 6 | | import click
 7 | | from sqlalchemy import create_engine
 8 | | from sqlalchemy.orm import Session, sessionmaker
 9 | |
10 | | from app import models  # Import models to register them
11 | | from app.extensions import db
   | |_____________________________^
   |
help: Organize imports

I001 [*] Import block is un-sorted or un-formatted
  --> app/core/ai_gateway.py:11:1
   |
 9 |   """
10 |
11 | / import os
12 | | from typing import Protocol, runtime_checkable, AsyncGenerator
13 | | import httpx
14 | | import json
   | |___________^
15 |
16 |   # --- Configuration ---
   |
help: Organize imports

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
  --> app/core/ai_gateway.py:12:1
   |
11 | import os
12 | from typing import Protocol, runtime_checkable, AsyncGenerator
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
13 | import httpx
14 | import json
   |
help: Import from `collections.abc`

I001 [*] Import block is un-sorted or un-formatted
  --> app/core/database.py:10:1
   |
 8 |   """
 9 |
10 | / import os
11 | | from typing import AsyncGenerator
12 | |
13 | | from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
14 | | from sqlalchemy.orm import sessionmaker, declarative_base
   | |_________________________________________________________^
15 |
16 |   # ======================================================================================
   |
help: Organize imports

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`
  --> app/core/database.py:11:1
   |
10 | import os
11 | from typing import AsyncGenerator
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
12 |
13 | from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
   |
help: Import from `collections.abc`

E402 Module level import not at top of file
  --> app/core/factories.py:52:1
   |
52 | from app.gateways.ai_service_gateway import AIServiceGateway
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
53 | from app.protocols.http_client import HttpClient, RequestsAdapter
   |

E402 Module level import not at top of file
  --> app/core/factories.py:53:1
   |
52 | from app.gateways.ai_service_gateway import AIServiceGateway
53 | from app.protocols.http_client import HttpClient, RequestsAdapter
   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
   |

I001 [*] Import block is un-sorted or un-formatted
  --> app/core/time.py:10:1
   |
 8 |   """
 9 |
10 | / from contextlib import contextmanager
11 | | from app.core.database import AsyncSessionLocal
   | |_______________________________________________^
12 |
13 |   # ======================================================================================
   |
help: Organize imports

I001 [*] Import block is un-sorted or un-formatted
  --> app/main.py:9:1
   |
 7 |   """
 8 |
 9 | / from fastapi.staticfiles import StaticFiles
10 | |
11 | | from app.api.routers import admin, chat, system, ai_service
12 | | from app.kernel import app
   | |__________________________^
13 |
14 |   # ======================================================================================
   |
help: Organize imports

I001 [*] Import block is un-sorted or un-formatted
  --> app/services/admin_ai_service.py:28:1
   |
26 |   """
27 |
28 | / from __future__ import annotations
29 | |
30 | | import json
31 | | import logging
32 | | import os
33 | | import time
34 | | from datetime import UTC, datetime
35 | | from typing import Any
36 | |
37 | | from app.extensions import db
38 | | from app.models import (
39 | |     AdminConversation,
40 | |     AdminMessage,
41 | |     User,
42 | |     utc_now,
43 | | )
   | |_^
44 |
45 |   try:
   |
help: Organize imports

F821 Undefined name `current_app`
   --> app/services/api_gateway_service.py:410:17
    |
409 |             except Exception as e:
410 |                 current_app.logger.warning(f"Error evaluating provider {provider_name}: {e}")
    |                 ^^^^^^^^^^^
411 |                 continue
    |

F821 Undefined name `current_app`
   --> app/services/api_gateway_service.py:620:21
    |
619 |                 except Exception as e:
620 |                     current_app.logger.error(f"Policy evaluation error: {e}")
    |                     ^^^^^^^^^^^
621 |                     continue
    |

F821 Undefined name `current_app`
   --> app/services/api_gateway_service.py:703:9
    |
701 |         """Register a gateway route"""
702 |         self.routes[route.route_id] = route
703 |         current_app.logger.info(f"Registered route: {route.route_id} -> {route.path_pattern}")
    |         ^^^^^^^^^^^
704 |
705 |     def register_upstream_service(self, service: UpstreamService):
    |

F821 Undefined name `current_app`
   --> app/services/api_gateway_service.py:708:9
    |
706 |         """Register an upstream service"""
707 |         self.upstream_services[service.service_id] = service
708 |         current_app.logger.info(f"Registered upstream service: {service.service_id}")
    |         ^^^^^^^^^^^
709 |
710 |     def process_request(
    |

F821 Undefined name `current_app`
   --> app/services/api_gateway_service.py:771:13
    |
770 |         except Exception as e:
771 |             current_app.logger.error(f"Gateway processing error: {e}", exc_info=True)
    |             ^^^^^^^^^^^
772 |             return {"error": "Internal gateway error", "status": "error", "message": str(e)}, 500
    |

F821 Undefined name `current_app`
   --> app/services/api_gateway_service.py:836:17
    |
834 |                 return result
835 |             except Exception as e:
836 |                 current_app.logger.error(f"Endpoint error: {e}", exc_info=True)
    |                 ^^^^^^^^^^^
837 |                 return jsonify({"error": "Internal error", "message": str(e)}), 500
    |

I001 [*] Import block is un-sorted or un-formatted
  --> app/services/prompt_engineering_service.py:69:1
   |
67 |   """
68 |
69 | / from __future__ import annotations
70 | |
71 | | import logging
72 | | import os
73 | | import re
74 | | import time
75 | | from typing import Any
76 | |
77 | | from app.extensions import db
78 | | from app.models import GeneratedPrompt, PromptTemplate, User
   | |____________________________________________________________^
79 |
80 |   try:
   |
help: Organize imports

I001 [*] Import block is un-sorted or un-formatted
 --> tests/conftest.py:2:1
  |
1 |   # tests/conftest.py
2 | / import os
3 | | import asyncio
4 | | from typing import AsyncGenerator, Generator
  | |____________________________________________^
5 |
6 |   # Set environment variables for testing BEFORE application imports
  |
help: Organize imports

UP035 [*] Import from `collections.abc` instead: `AsyncGenerator`, `Generator`
 --> tests/conftest.py:4:1
  |
2 | import os
3 | import asyncio
4 | from typing import AsyncGenerator, Generator
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
5 |
6 | # Set environment variables for testing BEFORE application imports
  |
help: Import from `collections.abc`

I001 [*] Import block is un-sorted or un-formatted
  --> tests/conftest.py:11:1
   |
 9 |   os.environ["OPENROUTER_API_KEY"] = "test-key" # Required by ENERGY-ENGINE
10 |
11 | / import pytest
12 | | import pytest_asyncio
13 | | from fastapi.testclient import TestClient
14 | | from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession
15 | | from sqlalchemy.orm import sessionmaker
16 | |
17 | | from app.core.database import get_db, Base
18 | | from app.kernel import app
   | |__________________________^
19 |
20 |   # Use a separate database for testing
   |
help: Organize imports

I001 [*] Import block is un-sorted or un-formatted
  --> tests/test_ai_service.py:12:1
   |
10 |   """
11 |
12 | / import json
13 | | from datetime import UTC, datetime, timedelta
14 | | from unittest.mock import patch
15 | |
16 | | import jwt
17 | | import pytest
18 | | from fastapi.testclient import TestClient
19 | |
20 | | # Ensure the app is imported correctly
21 | | from ai_service_standalone.main import ALGORITHM, SECRET_KEY, app
22 | | from tests._helpers import parse_response_json
   | |______________________________________________^
23 |
24 |   client = TestClient(app)
   |
help: Organize imports

F841 Local variable `f` is assigned to but never used
  --> tests/test_settings_smoke.py:53:39
   |
51 |     # Create an empty temporary .env file
52 |     empty_env_path = os.path.join(os.path.dirname(__file__), "empty.env")
53 |     with open(empty_env_path, "w") as f:
   |                                       ^
54 |         pass
   |
help: Remove assignment to unused variable `f`

I001 [*] Import block is un-sorted or un-formatted
  --> tests/transcendent/test_energy_engine.py:7:1
   |
 5 |   These tests verify the Law of Energetic Continuity.
 6 |   """
 7 | / import pytest
 8 | | from httpx import AsyncClient
 9 | | from app.kernel import app  # Use the unified app
10 | | from unittest.mock import MagicMock, AsyncMock
11 | |
12 | | from app.core.ai_gateway import get_ai_client
   | |_____________________________________________^
13 |
14 |   @pytest.mark.skip(reason="Skipping due to persistent issues with AsyncClient and dependency overrides.")
   |
help: Organize imports

F401 [*] `unittest.mock.AsyncMock` imported but unused
  --> tests/transcendent/test_energy_engine.py:10:38
   |
 8 | from httpx import AsyncClient
 9 | from app.kernel import app  # Use the unified app
10 | from unittest.mock import MagicMock, AsyncMock
   |                                      ^^^^^^^^^
11 |
12 | from app.core.ai_gateway import get_ai_client
   |
help: Remove unused import: `unittest.mock.AsyncMock`

I001 [*] Import block is un-sorted or un-formatted
  --> tests/transcendent/test_space_engine.py:8:1
   |
 6 |   """
 7 |
 8 | / import pytest
 9 | | from sqlalchemy.orm import declarative_base
10 | | from app.core.database import Base, get_db
11 | | from app.models import User  # Import a model to check its base
   | |___________________________^
12 |
13 |   def test_models_use_correct_base():
   |
help: Organize imports

F401 [*] `sqlalchemy.orm.declarative_base` imported but unused
  --> tests/transcendent/test_space_engine.py:9:28
   |
 8 | import pytest
 9 | from sqlalchemy.orm import declarative_base
   |                            ^^^^^^^^^^^^^^^^
10 | from app.core.database import Base, get_db
11 | from app.models import User  # Import a model to check its base
   |
help: Remove unused import: `sqlalchemy.orm.declarative_base`

I001 [*] Import block is un-sorted or un-formatted
  --> tests/transcendent/test_time_engine.py:7:1
   |
 5 |   These tests verify the Law of Temporal Coherence.
 6 |   """
 7 | / import pytest
 8 | | from app.core.time import legacy_context
 9 | | from sqlalchemy.ext.asyncio import AsyncSession
   | |_______________________________________________^
10 |
11 |   def test_legacy_context_provides_db_session(client):
   |
help: Organize imports

F401 [*] `pytest` imported but unused
 --> tests/transcendent/test_time_engine.py:7:8
  |
5 | These tests verify the Law of Temporal Coherence.
6 | """
7 | import pytest
  |        ^^^^^^
8 | from app.core.time import legacy_context
9 | from sqlalchemy.ext.asyncio import AsyncSession
  |
help: Remove unused import: `pytest`

I001 [*] Import block is un-sorted or un-formatted
  --> tests/unit/services/test_database_service.py:10:1
   |
 8 |   """
 9 |
10 | / from logging import getLogger
11 | |
12 | | import pytest
13 | | from sqlalchemy import create_engine
14 | | from sqlalchemy.orm import sessionmaker
15 | |
16 | | from app.config.settings import AppSettings
17 | | from app.extensions import Base  # Import the actual Base
18 | | from app.models import User  # Import a representative model
19 | | from app.services.database_service import DatabaseService
   | |_________________________________________________________^
   |
help: Organize imports

Found 33 errors.
[*] 24 fixable with the `--fix` option (1 hidden fix can be enabled with the `--unsafe-fixes` option).
