# البرهان الكنسي لشمولية NEXP لمسألة Dec-POMDP ذات أفق محدود (وكيلان)

## 1) تعريف المسألة المستهدفة
نعرّف مسألة القرار لــ Dec-POMDP ذات أفق محدود $T$ لوكيلين ($m=2$):

> **المدخل:** نموذج Dec-POMDP محدود الأفق مع مكافآت، وعتبة $R^\*$.
>
> **السؤال:** هل توجد سياسة مشتركة (سياسة محلية لكل وكيل تعتمد فقط على تاريخه الرصدي المحلي) تحقق قيمة متوقعة لا تقل عن $R^\*$؟

سنثبت أنها **NEXP-Complete** عبر:
1. الانتماء إلى NEXP.
2. الاختزال من مشكلة التبليط غير الحتمية (Non-Deterministic Tiling Problem).

## 2) الانتماء إلى NEXP (Membership)
حجم السياسة المحلية لكل وكيل في أفق $T$ قد يكون أسيًا في حجم المدخل. يمكن لآلة غير حتمية أن **تخمن** السياسات المحلية للوكيلين (كشجرتين للقرارات على مشاهداتهما)، ثم تتحقق في وقت أسي من القيمة المتوقعة عبر محاكاة الاحتمالات والانتقالات حتى الأفق $T$. لذلك، المشكلة تقع في NEXP.

## 3) مشكلة التبليط غير الحتمية (NDT)
المدخل التقليدي لمشكلة التبليط غير الحتمية يكون بالشكل الآتي:

- مجموعة بلاطات $\mathcal{T}$.
- علاقات توافق أفقي $H \subseteq \mathcal{T} \times \mathcal{T}$.
- علاقات توافق رأسي $V \subseteq \mathcal{T} \times \mathcal{T}$.
- دالة أو قيد يحدد شكل شبكة بحجم أسي (مثلاً $2^n \times 2^n$) بشكل **موجز**.

**القرار:** هل يوجد تبليط كامل للشبكة يحقق قيود $H$ و $V$؟

هذه المسألة معروفة بأنها NEXP-Complete عند تمثيل الشبكة بشكل موجز.

## 4) فكرة الاختزال الكنسي إلى Dec-POMDP
نحوّل مثيل التبليط إلى Dec-POMDP بحيث:
- البيئة تختار **زوجًا من الإحداثيات** (موقعين في الشبكة).
- كل وكيل يرى **جزءًا محليًا فقط** من الإحداثيات.
- كل وكيل يختار بلاطة للموقع الذي يراه.
- المكافأة تكون عالية **إذا وفقط إذا** الاختياران متوافقان مع القيود المطلوبة (الأفقية/الرأسية/الهوية).

الفكرة الجوهرية: إذا كانت هناك سياسة مشتركة تحقق مكافأة متوقعة قصوى، فهذا يعني وجود تبليط كامل ومتناسق للشبكة.

## 5) البناء الرسمي للاختزال
### 5.1 تمثيل المواقع
نعتبر شبكة بحجم $2^n \times 2^n$. الإحداثي $(i, j)$ يرمز إليه بسلسلتين ثنائيتين بطول $n$. البيئة تختار زوج مواقع:
- $(i_1, j_1)$ و $(i_2, j_2)$
ثم ترسل لكل وكيل معلومات محلية:
- الوكيل 1 يرى $(i_1, j_1)$.
- الوكيل 2 يرى $(i_2, j_2)$.

### 5.2 توزيع الحالات والانتقالات
نعرّف الحالات على أنها مراحل تكويد ثنائي للإحداثيات، بحيث تُقدَّم الإحداثيات لكل وكيل على مدى خطوات متعددة. الأفق $T$ يكون متعدد الحدود في $n$ (مثلاً $O(n)$)، إذ في كل خطوة يُكشف بتّ واحد من الإحداثيات لكل وكيل.

### 5.3 الأفعال (اختيار البلاطة)
بعد اكتمال كشف الإحداثيات، يختار كل وكيل بلاطة $t \in \mathcal{T}$ لموقعه.

### 5.4 الملاحظات المحلية
ملاحظة كل وكيل هي فقط إحداثياته، **ولا يرى إحداثيات الوكيل الآخر**. هذا يُجبر السياسة على أن تكون دالة في الإحداثيات المحلية فقط، وهو ما يماثل تعيين بلاطة لكل موقع في الشبكة.

### 5.5 المكافآت المحلية (تجسيد القيود)
تقوم البيئة باختيار زوج مواقع وفق الحالات التالية (بشكل موزون عشوائيًا وباحتمال موجب لكل حالة):

1. **نفس الخانة:** إذا كان $(i_1, j_1) = (i_2, j_2)$ يجب أن يختار الوكيلان نفس البلاطة. إذا اختلفا يحصلان على مكافأة 0.
2. **جوار أفقي:** إذا كان الموقعان أفقيين متجاورين (مثلاً $(i, j)$ و $(i, j+1)$)، تُعطى مكافأة 1 فقط إذا كان الزوج $(t_1, t_2) \in H$.
3. **جوار رأسي:** إذا كان الموقعان رأسيين متجاورين (مثلاً $(i, j)$ و $(i+1, j)$)، تُعطى مكافأة 1 فقط إذا كان الزوج $(t_1, t_2) \in V$.
4. **حالات أخرى:** يمكن إعطاء مكافأة 1 افتراضيًا بحيث لا تؤثر على صحة القيود.

### 5.6 قيمة المكافأة والقرار
نختار العتبة $R^\* = 1$.
- إذا وُجد تبليط صحيح، فهناك سياسة تعيّن بلاطة لكل إحداثي بحيث تمر جميع الاختبارات السابقة؛ بالتالي تحصل على مكافأة متوقعة 1.
- إذا لم يوجد تبليط صحيح، فستفشل بعض المقارنات المحتمة (ذات احتمال موجب)، مما يخفض المكافأة المتوقعة عن 1.

إذن: وجود سياسة بقيمة $\ge 1$ يعادل وجود تبليط صحيح.

## 6) لماذا هذا الاختزال يعتمد على اللامركزية
جوهر الاختزال هو **تقييد المعلومات** لكل وكيل حتى لا يستطيع استنتاج الموقع الآخر. هذا الإخفاء القسري يحوّل السياسة المحلية إلى **تعيين ثابت للبلاطات عبر الشبكة**.

## 7) لماذا يفشل في حالة التحكم المركزي
في التحكم المركزي (POMDP مركزي)، المتحكم يرى **الملاحظة المشتركة** كاملة. عندها يستطيع:
- معرفة الإحداثيين معًا في كل حلقة.
- اختيار زوج البلاطات **حسب الزوج المحدد فقط** دون الالتزام بتعيين عالمي ثابت.
- تمرير كل اختبار محليًا حتى لو لم يوجد تبليط عالمي متسق.

بعبارة أخرى، التحكم المركزي يسمح بتكييف البلاطة في كل حلقة حسب زوج المواقع المختارة، وهذا **يكسر جوهر الاختزال** الذي يعتمد على الاتساق العالمي عبر جميع المواقع. لذلك لا نحصل على نفس حدّية NEXP في الحالة المركزية، بل تهبط التعقيد إلى فئات أدنى (مثل PSPACE في الأفق المحدود لـ POMDP المركزي)، ولا يمكن استخدام هذا الاختزال كما هو.

## 8) الخلاصة
بناءً على الاختزال من التبليط غير الحتمية، ومع إثبات الانتماء إلى NEXP، نحصل على أن مسألة Dec-POMDP ذات أفق محدود لوكيلين هي NEXP-Complete.
