[tool.ruff]
line-length = 100
target-version = "py312"
exclude = [".git", "migrations"]

[tool.ruff.lint]
select = ["E", "F", "I", "W", "UP", "B", "C4", "SIM", "RUF", "PL", "N", "TID", "RET", "ARG"]
# E501: Line too long (Often unavoidable with Arabic docs or URLs)
# E402: Module level import not at top of file (scripts need sys.path.append first)
# RUF001/2/3: Unicode characters (Arabic text triggers this, so we ignore it to allow Arabic)
# B008: Do not perform function call `Depends` in argument defaults (Standard FastAPI pattern)
# B027: Empty method in abstract base class (Standard Hooks pattern)
# SIM117: Use a single `with` statement with multiple contexts (Avoids httpx context issues)
# PLR0913: Too many arguments (Factory patterns often require this)
ignore = [
    "ARG001",
    "ARG002",
    "E402",
    "E501",
    "PLC0415",
    "PLR0913",
    "PLR0911",
    "PLR0912",
    "PLR0915",
    "PLR2004",
    "PLW0603",
    "RUF001",
    "RUF002",
    "RUF003",
    "B008",
    "B027",
    "SIM117",
]

[tool.ruff.lint.isort]
known-first-party = ["app", "microservices"]
section-order = ["future", "standard-library", "third-party", "first-party", "local-folder"]

[tool.pytest.ini_options]
asyncio_mode = "auto"
testpaths = ["tests"]
python_files = ["test_*.py"]
addopts = "-v --cov=app --cov-report=term-missing --cov-report=xml:reports/omega/coverage.xml"
filterwarnings = [
    "ignore:.*datetime.utcnow.*:DeprecationWarning",
    "ignore:.*The 'app' shortcut.*:DeprecationWarning"
]
env = [
    "DATABASE_URL=sqlite+aiosqlite:///:memory:",
    "SECRET_KEY=test_secret_key_super_secure",
    "ENVIRONMENT=testing",
    "LLM_MOCK_MODE=1"
]
