# 📊 دليل عرض جداول قاعدة البيانات

## الهدف
هذا الدليل يشرح كيفية التحقق من الجداول الموجودة في قاعدة البيانات للمشروع.

## الجداول المتوقعة في المشروع

> **🔥 تحديث v14.0 - قاعدة بيانات نقية!**
>
> تم تنقية المشروع! الآن يحتوي فقط على **5 جداول أساسية** لنظام Overmind.
> جميع الجداول القديمة تم حذفها لتحقيق **النقاء المعماري**.

### ✅ الجداول الأساسية (Pure Overmind v14.0):

1. **users** 👤 - جدول المستخدمين
   - حسابات المستخدمين والصلاحيات
   
2. **missions** 🎯 - جدول المهام الرئيسية
   - المهام والأهداف الرئيسية للذكاء الاصطناعي
   
3. **mission_plans** 📋 - جدول خطط المهام
   - خطط تنفيذ المهام المختلفة
   
4. **tasks** ✅ - جدول المهام الفرعية
   - المهام الفرعية والخطوات التفصيلية
   
5. **mission_events** 📊 - جدول أحداث المهام
   - سجل الأحداث والتغييرات في المهام

### 🔥 الجداول المُنقّاة (تم حذفها):

#### ❌ نظام التعليم القديم (تم الإزالة):
- ❌ `subjects` - المواد الدراسية
- ❌ `lessons` - الدروس  
- ❌ `exercises` - التمارين
- ❌ `submissions` - إجابات الطلاب

#### ❌ نظام الدردشة القديم (تم الإزالة):
- ❌ `admin_conversations` - محادثات الأدمن
- ❌ `admin_messages` - رسائل الأدمن

#### ❌ جداول مساعدة قديمة (تم الإزالة):
- ❌ `task_dependencies` - جدول التبعيات (استُبدل بـ depends_on_json)

### 🔧 جداول النظام (System Tables)
- **alembic_version** 🔄 - جدول إصدارات الهجرات
  - تتبع إصدارات هجرات قاعدة البيانات

**النتيجة: قاعدة بيانات نقية 100% جاهزة للسحابة! 🚀**

## طريقة الاستخدام

### الطريقة الأولى: استخدام السكريبت الجديد (موصى به)

```bash
# تشغيل السكريبت لعرض جميع الجداول
python3 list_database_tables.py
```

هذا السكريبت سيعرض:
- ✅ جميع الجداول الموجودة في قاعدة البيانات
- 📊 عدد السجلات في كل جدول
- 📋 عدد الأعمدة في كل جدول
- ⚠️ الجداول المفقودة (إن وجدت)
- 📈 إحصائيات عامة عن قاعدة البيانات

### الطريقة الثانية: استخدام سكريبت فحص الهجرات

```bash
# تشغيل سكريبت فحص حالة الهجرات
python3 check_migrations_status.py
```

هذا السكريبت سيعرض:
- 🔄 حالة الهجرات المطبقة
- 📊 الجداول الموجودة
- ✅ نسبة النجاح
- 💡 التوصيات للإصلاح

### الطريقة الثالثة: استخدام واجهة الأدمن

1. سجل الدخول كمسؤول:
   ```
   Email: benmerahhoussam16@gmail.com
   Password: 1111
   ```

2. انتقل إلى صفحة إدارة قاعدة البيانات:
   ```
   http://localhost:5000/admin/database
   ```

3. ستشاهد جميع الجداول مع إمكانية:
   - عرض البيانات
   - البحث والتصفية
   - تعديل السجلات
   - تصدير البيانات

## إنشاء الجداول المفقودة

إذا وجدت أن بعض الجداول مفقودة، قم بتشغيل:

```bash
# تطبيق جميع الهجرات
flask db upgrade
```

## التحقق من الاتصال بقاعدة البيانات

```bash
# التحقق من الاتصال
python3 verify_supabase_connection.py
```

## معلومات إضافية

### متطلبات البيئة

تأكد من وجود ملف `.env` يحتوي على:

```env
DATABASE_URL="postgresql://postgres:password@host:port/database"
```

### الوثائق ذات الصلة

- `DATABASE_MANAGEMENT.md` - دليل إدارة قاعدة البيانات
- `DATABASE_GUIDE_AR.md` - دليل قاعدة البيانات بالعربية
- `IMPLEMENTATION_SUMMARY.md` - ملخص التنفيذ
- `SUPABASE_NEW_PROJECT_SETUP_AR.md` - دليل إعداد Supabase

## الدعم والمساعدة

إذا واجهت أي مشاكل:

1. تحقق من الاتصال بقاعدة البيانات
2. تأكد من تطبيق جميع الهجرات
3. راجع الوثائق المذكورة أعلاه
4. تحقق من ملف `.env`

## الأوامر السريعة

```bash
# عرض جميع الجداول
python3 list_database_tables.py

# فحص حالة الهجرات
python3 check_migrations_status.py

# تطبيق الهجرات
flask db upgrade

# التحقق من الاتصال
python3 verify_supabase_connection.py

# عرض معلومات قاعدة البيانات
python3 demo_database_management.py
```

---

## ملاحظات مهمة

- ⚠️ تأكد من تشغيل السكريبتات من المجلد الرئيسي للمشروع
- ⚠️ تأكد من وجود ملف `.env` يحتوي على معلومات الاتصال
- ⚠️ بعض السكريبتات تتطلب تثبيت المكتبات المطلوبة (`pip install -r requirements.txt`)

---

**تم إنشاء هذا الدليل**: 2024
**الإصدار**: 1.0.0
**المؤلف**: CogniForge System
