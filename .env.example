# .env.example - The Unified Brain Protocol (Professional Template v4.0)
# Copy this file to .env and replace placeholders with your actual values

# =====================================================================================
# .env.example  –  Unified Brain Protocol (Professional Template v4.5 Hyper Edition)
# Copy to .env and replace placeholders. DO NOT COMMIT REAL SECRETS.
# =====================================================================================

# ---------------------------------
# RUNTIME MODE & CORE FLASK
# ---------------------------------
FLASK_DEBUG=1
SECRET_KEY="replace-with-a-strong-secret"
OVERMIND_ENV=dev        # dev | staging | prod

# ---------------------------------
# DATABASE CONFIGURATION
# ---------------------------------
# Choose ONE of the following configurations:

# OPTION 1: LOCAL DATABASE (Default - for Docker Compose)
# Use this for local development with docker-compose
DATABASE_PASSWORD=Aog2Df4lIlIXiCGk
DATABASE_URL=postgresql://postgres:${DATABASE_PASSWORD}@db:5432/postgres

# OPTION 2: REMOTE SUPABASE (Optional - for production/remote)
# Uncomment and configure these if using remote Supabase:
# SUPABASE_URL="https://your-project-id.supabase.co"
# SUPABASE_KEY="your-supabase-anon-key-here"
# DATABASE_URL="postgresql://postgres.your-project-id:your-db-password@aws-0-region.pooler.supabase.com:5432/postgres"

# ---------------------------------
# AI / MODEL KEYS
# ---------------------------------
OPENROUTER_API_KEY="sk-or-v1-your-openrouter-api-key-here"
DEFAULT_AI_MODEL="openai/gpt-4o"              # Central default (referenced below)
LOW_COST_MODEL="openai/gpt-4o-mini"

# ---------------------------------
# ADMIN SEEDING (Automatic Provision)
# ---------------------------------
ADMIN_EMAIL="admin@yourproject.com"
ADMIN_PASSWORD="your-secure-admin-password"
ADMIN_NAME="Your Admin Name"

# ---------------------------------
# LOGGING / OBSERVABILITY
# ---------------------------------
AGENT_TOOLS_LOG_LEVEL=INFO
LLM_PLANNER_LOG_LEVEL=DEBUG
PLANNING_FACTORY_LOG_LEVEL=INFO
OVERMIND_LOG_DEBUG=1
LOG_FORMAT_JSON=0
LOG_REQUEST_ID_ENABLE=1
LOG_INCLUDE_TIMESTAMPS=1
OTEL_EXPORTER_OTLP_ENDPOINT=
OTEL_SERVICE_NAME="cogniforge-overmind"
METRICS_ENABLE=1
TRACE_ENABLE=0

# ---------------------------------
# PLANNER LANGUAGE / GENERAL
# ---------------------------------
PLANNER_FORCE_ARABIC=0
PLANNER_LANGUAGE_FALLBACK=ar
PLANNER_MAX_FILES=12
PLANNER_DEFAULT_EXT=.md                    # (Deprecated) – consider using PLANNER_FILE_DEFAULT_EXT
PLANNER_FILE_DEFAULT_EXT=.md               # Canonical default extension (write ops / reports)
PLANNER_SMART_FILENAME=1
PLANNER_ALLOW_SUBDIRS=1
PLANNER_MAX_TASKS_GLOBAL=400
PLANNER_DISABLE_VERBOSE_PROMPTS=0

# ---------------------------------
# STREAMING / CHUNKING
# ---------------------------------
PLANNER_STREAMING_ENABLE=1
PLANNER_ALLOW_APPEND_TOOL=auto
PLANNER_APPEND_FALLBACK_BATCH=1
PLANNER_CHUNK_SIZE_HINT=1200
PLANNER_MAX_CHUNKS=50
PLANNER_HARD_LINE_CAP=1000000
PLANNER_FAST_SINGLE_THRESHOLD=1800

# ---------------------------------
# ROLES / SECTIONS / HINTS
# ---------------------------------
PLANNER_ENABLE_SECTION_INFERENCE=1
PLANNER_ENABLE_ROLE_DERIVATION=1
PLANNER_MULTI_ROLE_JSON=1
PLANNER_ENABLE_CODE_HINTS=1

# ---------------------------------
# ENFORCEMENT / ARTIFACT INDEX
# ---------------------------------
PLANNER_ENSURE_FILE=1
PLANNER_STRICT_WRITE_ENFORCE=1
PLANNER_INDEX_FILE=1
PLANNER_INDEX_NAME=ARTIFACT_INDEX.md
PLANNER_FORCE_REPORT_NAME=ARCHITECTURE_PRINCIPLES.md

# ---------------------------------
# DEEP STRUCTURAL INDEX (Planner & Tools)
# ---------------------------------
PLANNER_DEEP_INDEX_ENABLE=1
PLANNER_DEEP_INDEX_JSON=1
PLANNER_DEEP_INDEX_JSON_NAME=STRUCTURAL_INDEX.json
PLANNER_DEEP_INDEX_MD=1
PLANNER_DEEP_INDEX_MD_NAME=STRUCTURAL_INDEX_SUMMARY.md
PLANNER_DEEP_INDEX_MAX_JSON_BYTES=180000
PLANNER_DEEP_INDEX_SUMMARY_MAX_LEN=3800

# Agent Tools structural deep map (used in agent_tools & registry enhancements):
AGENT_TOOLS_DEEP_MAP_PATH=./STRUCTURAL_INDEX.json
AGENT_TOOLS_DEEP_MAP_TTL=60
AGENT_TOOLS_DEEP_LIMIT_KEYS=0
AGENT_TOOLS_COMPRESS_JSON=1
AGENT_TOOLS_AUTOFILL_MISSING=1
AGENT_TOOLS_FORCE_INTENT=1
MEMORY_ALLOWLIST="session_topic,user_goal"

# ---------------------------------
# REPOSITORY READ SCAN (Seed Files)
# ---------------------------------
PLANNER_ALLOW_LIST_READ_ANALYSIS=1
PLANNER_CORE_READ_FILES=README.md,requirements.txt,Dockerfile,config.py,pyproject.toml

# ---------------------------------
# ALLOWED TOOLS
# ---------------------------------
PLANNER_ALLOWED_TOOLS=list_dir,read_file,ensure_file,generic_think,write_file,append_file
PLANNER_ENFORCE_ALLOWED_TOOLS=1

# ---------------------------------
# OPTIONAL FUTURE FLAGS
# ---------------------------------
PLANNER_DEP_AUDIT_ENABLE=1
PLANNER_BACKLOG_MODE_ENABLE=1

# ---------------------------------
# LEGACY L4 SCAN PIPELINE
# ---------------------------------
PLANNER_L4_ENABLED=1
PLANNER_L4_SCAN_DIRS=app,.
PLANNER_L4_MAX_LIST_DIRS=4
PLANNER_L4_CORE_FILES=README.md,requirements.txt,docker-compose.yml,config.py,Dockerfile
PLANNER_L4_INCLUDE_CODE_EXTS=.py,.md,.yml,.yaml,.toml,.json,.txt,.ini,.cfg
PLANNER_L4_MAX_CODE_FILES=12
PLANNER_L4_MAX_TOTAL_READS=24
PLANNER_L4_MULTI_ANALYSIS=1
PLANNER_L4_ENABLE_ENSURE=1
PLANNER_L4_FINAL_FILENAME_HINT=ARCHITECTURE_PRINCIPLES.md
PLANNER_L4_MIN_SYNTH_SECTIONS=6
PLANNER_L4_PRIORITY_KEYWORDS=service,api,model,config,core,main,router,controller
OVERMIND_L4_SOFT_MISSING_FILES=1
OVERMIND_L4_MISSING_FILE_MARKER="[MISSING]"
OVERMIND_L4_EXPECT_ARCH_FILE=ARCHITECTURE_PRINCIPLES.md

# ---------------------------------
# FILE / GUARD DEFAULTS
# ---------------------------------
PLANNER_FILE_DEFAULT_CONTENT="(auto-generated placeholder)"
OVERMIND_GUARD_ENABLED=1
OVERMIND_GUARD_FILE_AUTOFIX=1
OVERMIND_GUARD_ACCEPT_DOTTED=1
OVERMIND_GUARD_FORCE_FILE_INTENT=1
OVERMIND_GUARD_FILE_DEFAULT_EXT=.md
OVERMIND_GUARD_FILE_DEFAULT_CONTENT="(auto-generated placeholder)"

# ---------------------------------
# INTERPOLATION ENGINE
# ---------------------------------
OVERMIND_INTERPOLATION_ENABLED=1
OVERMIND_ALLOW_TEMPLATE_FAILURE=1   # 0 in strict prod

# ---------------------------------
# DIFFS / BACKUPS
# ---------------------------------
OVERMIND_DIFF_ENABLED=1
OVERMIND_BACKUP_ON_WRITE=0

# ---------------------------------
# AGENT TOOLS RUNTIME LIMITS
# ---------------------------------
AGENT_TOOLS_PROJECT_ROOT=.
AGENT_TOOLS_CREATE_MISSING=1
AGENT_TOOLS_CREATE_ALLOWED_EXTS=.md,.txt,.json,.log
AGENT_TOOLS_CREATE_DEFAULT_CONTENT="Auto-generated placeholder file."
AGENT_TOOLS_CREATE_MAX_BYTES=300000
AGENT_TOOLS_MAX_WRITE_BYTES=5000000
AGENT_TOOLS_MAX_APPEND_BYTES=3000000
AGENT_TOOLS_MAX_READ_BYTES=800000
AGENT_TOOLS_APPEND_ENFORCE_TOTAL=1
AGENT_TOOLS_AUTOFILL_EXTENSION=.txt
AGENT_TOOLS_ACCEPT_DOTTED=1
AGENT_TOOLS_HASH_AFTER_WRITE=1

# ---------------------------------
# SECURITY / SAFETY
# ---------------------------------
PLANNER_DISABLE_DELETE=1
PLANNER_PROTECTED_DIRS=app/overmind/planning,app/services
SAFE_GUARD_MAX_INTERPOLATION_REF=150
SAFE_GUARD_MAX_CHAIN_DEPTH=40
DISABLE_UNSAFE_EVAL=1
ENFORCE_CONTENT_POLICY=1
FORBID_RAW_SYSTEM_PROMPTS_EXPORT=1

# ---------------------------------
# KILL SWITCHES (Override quickly)
# ---------------------------------
DISABLE_STREAMING_MODE=0
DISABLE_ROLE_DERIVATION=0
DISABLE_SECTION_INFERENCE=0

# ---------------------------------
# FEATURE FLAGS
# ---------------------------------
FEATURE_FLAG_MISSION_TIMELINE=1
FEATURE_FLAG_INSIGHT_SUMMARY=1
FEATURE_FLAG_LLM_COST_TRACKING=1

# ---------------------------------
# MODELS CONFIG
# ---------------------------------
PLANNER_THINK_MODEL_PRIMARY=${DEFAULT_AI_MODEL}
PLANNER_THINK_MODEL_FAST=${LOW_COST_MODEL}

# ---------------------------------
# FACTORY DISCOVERY & SELECTION BOOSTS
# ---------------------------------
FACTORY_MIN_RELIABILITY=0.25
FACTORY_SELF_HEAL_ON_EMPTY=1
FACTORY_DEEP_INDEX_CAP_BOOST=0.05
FACTORY_HOTSPOT_CAP_BOOST=0.03
FACTORY_HOTSPOT_THRESHOLD=8
FACTORY_PROFILE_SELECTION=1
FACTORY_PROFILE_INSTANTIATION=1
FACTORY_FORCE_REDISCOVER=0

# ---------------------------------
# STRUCTURAL SCORING (BasePlanner v4.5+)
# ---------------------------------
PLANNER_STRUCT_SCORE_ENABLE=1
PLANNER_STRUCT_SCORE_WEIGHT=0.07
PLANNER_STRUCT_GRADE_BONUS_A=0.05
PLANNER_STRUCT_GRADE_BONUS_B=0.02
PLANNER_STRUCT_GRADE_BONUS_C=0.0
PLANNER_STRUCT_DRIFT_TASK_RATIO=0.30
PLANNER_STRUCT_DRIFT_GRADE_DROP=2
PLANNER_STRUCT_RELIABILITY_NUDGE=0.01

# ---------------------------------
# SCHEMAS / PLAN META GOVERNANCE
# ---------------------------------
PLAN_MAX_META_BYTES=64000
PLAN_MAX_TASKS=800
PLAN_MAX_DESCRIPTION_LEN=600

# ---------------------------------
# RATE LIMITING
# ---------------------------------
RATE_LIMIT_ENABLED=0
RATE_LIMIT_MISSION_PER_MIN=20
RATE_LIMIT_TASKS_PER_MIN=200

# ---------------------------------
# RESERVED / FUTURE
# ---------------------------------
RESERVED_FLAG_ALPHA=0
RESERVED_FLAG_BETA=0
FALLBACK_ALLOW=1

# ---------------------------------
# PRODUCTION OVERRIDES (Example – uncomment for prod)
# ---------------------------------
# FLASK_DEBUG=0
# OVERMIND_ENV=prod
# LOG_FORMAT_JSON=1
# PLANNER_STREAMING_ENABLE=1
# OVERMIND_ALLOW_TEMPLATE_FAILURE=0
# DISABLE_STREAMING_MODE=0
# TRACE_ENABLE=1
# METRICS_ENABLE=1
# FACTORY_FORCE_REDISCOVER=0
# PLANNER_STRUCT_RELIABILITY_NUDGE=0.005
# ENFORCE_CONTENT_POLICY=1
# PLANNER_FORCE_ARABIC=0