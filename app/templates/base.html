<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>{{ title }} - AI Platform</title>
    <style>
        body { font-family: sans-serif; margin: 2em; line-height: 1.5; }
        nav a { margin-right: 15px; text-decoration: none; font-weight: bold; }
        .alert-success { background-color: #28a745; color: white; padding: 10px; margin: 15px 0; border-radius: 5px; }
        .alert-danger { background-color: #dc3545; color: white; padding: 10px; margin: 15px 0; border-radius: 5px; }
        .alert-info { background-color: #17a2b8; color: white; padding: 10px; margin: 15px 0; border-radius: 5px; }
        fieldset { border: 1px solid #ccc; padding: 1em; margin-top: 1em; }
    </style>
</head>
<body>
    <header>
        <nav>
            <!-- === [SUPERCHARGED REFACTOR] === -->
            <!-- We are now using the correct blueprint name: 'main' -->
            <!-- This is the ONLY change required to fix the error. -->

            <a href="{{ url_for('main.home') }}">Home</a>
            {% if current_user.is_authenticated %}
                <a href="{{ url_for('main.dashboard') }}">Dashboard</a>
                <a href="{{ url_for('main.subjects_list') }}">Subjects</a>
                <a href="{{ url_for('main.logout') }}">Logout</a>
            {% else %}
                <a href="{{ url_for('main.login') }}">Login</a>
                <a href="{{ url_for('main.register') }}">Register</a>
            {% endif %}
        </nav>
    </header>
    <hr>
    <main>
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert-{{ category }}">
                {{ message }}
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}
        
        {% block content %}{% endblock %}
    </main>
</body>
</html>