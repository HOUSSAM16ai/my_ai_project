# ======================================================================================
# WORKFLOW LINTING - Prevent YAML Errors Early ðŸ”
# ======================================================================================
# Validates GitHub Actions workflow syntax before merge
# Uses actionlint to catch common mistakes
# ======================================================================================

name: ðŸ” Workflow Linting

on:
  pull_request:
    paths:
      - ".github/workflows/**.yml"
      - ".github/workflows/**.yaml"
      - ".github/actions/**/action.yml"
      - ".github/actions/**/action.yaml"
  push:
    branches: [main, develop]
    paths:
      - ".github/workflows/**.yml"
      - ".github/workflows/**.yaml"

jobs:
  actionlint:
    name: ðŸ” Validate Workflow Syntax
    runs-on: ubuntu-latest
    timeout-minutes: 10
    env:
      # ShellCheck options: treat warnings as errors for strict validation
      SHELLCHECK_OPTS: -S error

    steps:
      - name: ðŸ“¥ Checkout code
        uses: actions/checkout@v4

      - name: ðŸ” Run actionlint
        uses: rhysd/actionlint@v1.7.4
        with:
          # Use args for actionlint parameters (fail-on-error is not supported)
          args: "-color"

      - name: âœ… Validation complete
        run: |
          {
            echo "## âœ… Workflow Validation Passed"
            echo ""
            echo "All GitHub Actions workflows are syntactically correct!"
            echo ""
            echo "ðŸ† Quality: Superhuman"
          } >> "$GITHUB_STEP_SUMMARY"

          # Explicit success exit
          exit 0
