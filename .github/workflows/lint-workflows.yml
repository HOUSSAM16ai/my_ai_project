# ======================================================================================
# WORKFLOW LINTING - Prevent YAML Errors Early 🔍
# ======================================================================================
# Validates GitHub Actions workflow syntax before merge
# Uses actionlint to catch common mistakes
# ======================================================================================

name: 🔍 Workflow Linting

on:
  pull_request:
    paths:
      - ".github/workflows/**.yml"
      - ".github/workflows/**.yaml"
      - ".github/actions/**/action.yml"
      - ".github/actions/**/action.yaml"
  push:
    branches: [main, develop]
    paths:
      - ".github/workflows/**.yml"
      - ".github/workflows/**.yaml"

jobs:
  actionlint:
    name: 🔍 Validate Workflow Syntax
    runs-on: ubuntu-latest
    timeout-minutes: 10
    env:
      # ShellCheck options: treat warnings as errors for strict validation
      SHELLCHECK_OPTS: -S error

    steps:
      - name: 📥 Checkout code
        uses: actions/checkout@v4

      - name: 🔍 Run actionlint
        uses: rhysd/actionlint@v1.7.4
        with:
          # Use args for actionlint parameters (fail-on-error is not supported)
          args: "-color"

      - name: ✅ Validation complete
        run: |
          {
            echo "## ✅ Workflow Validation Passed"
            echo ""
            echo "All GitHub Actions workflows are syntactically correct!"
            echo ""
            echo "🏆 Quality: Superhuman"
          } >> "$GITHUB_STEP_SUMMARY"
