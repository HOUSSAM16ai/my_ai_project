============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-7.4.4, pluggy-1.6.0 -- /home/jules/.pyenv/versions/3.12.12/bin/python3
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /app
configfile: pytest.ini
plugins: asyncio-0.21.1, env-1.1.3, hypothesis-6.148.7, Faker-38.2.0, cov-4.1.0, anyio-4.12.0, factoryboy-2.8.1
asyncio: mode=Mode.AUTO
collecting ... collected 913 items

tests/test_adaptive_cache_eviction.py::test_adaptive_cache_eviction_fix PASSED [  0%]
tests/test_admin_auth_config_fix.py::test_admin_auth_uses_centralized_config PASSED [  0%]
tests/test_admin_chat_error_handling.py::test_chat_error_handling_no_auth PASSED [  0%]
tests/test_admin_chat_error_handling.py::test_chat_error_handling_with_auth_but_service_error PASSED [  0%]
tests/test_admin_chat_error_handling.py::test_analyze_project_error_handling PASSED [  0%]
tests/test_admin_chat_history.py::test_admin_chat_history_streaming PASSED [  0%]
tests/test_admin_chat_init_event.py::test_admin_chat_returns_conversation_init_event PASSED [  0%]
tests/test_analysis_module.py::TestAnomalyDataclasses::test_anomaly_type_values PASSED [  0%]
tests/test_analysis_module.py::TestAnomalyDataclasses::test_anomaly_severity_values PASSED [  0%]
tests/test_analysis_module.py::TestAnomalyDataclasses::test_anomaly_to_dict PASSED [  1%]
tests/test_analysis_module.py::TestAnomalyDetectorInit::test_default_initialization PASSED [  1%]
tests/test_analysis_module.py::TestAnomalyDetectorInit::test_custom_initialization PASSED [  1%]
tests/test_analysis_module.py::TestZScoreDetection::test_zscore_needs_minimum_data PASSED [  1%]
tests/test_analysis_module.py::TestZScoreDetection::test_zscore_detects_anomaly PASSED [  1%]
tests/test_analysis_module.py::TestZScoreDetection::test_zscore_zero_stdev_handling PASSED [  1%]
tests/test_analysis_module.py::TestIQRDetection::test_iqr_needs_minimum_data PASSED [  1%]
tests/test_analysis_module.py::TestIQRDetection::test_iqr_detects_outlier PASSED [  1%]
tests/test_analysis_module.py::TestIQRDetection::test_iqr_zero_iqr_handling PASSED [  1%]
tests/test_analysis_module.py::TestMovingAverageDetection::test_moving_average_needs_minimum_data PASSED [  2%]
tests/test_analysis_module.py::TestMovingAverageDetection::test_moving_average_detects_deviation PASSED [  2%]
tests/test_analysis_module.py::TestMLDetection::test_ml_needs_minimum_data PASSED [  2%]
tests/test_analysis_module.py::TestMLDetection::test_ml_detects_isolated_value PASSED [  2%]
tests/test_analysis_module.py::TestCheckValue::test_check_value_needs_minimum_history PASSED [  2%]
tests/test_analysis_module.py::TestCheckValue::test_check_value_detects_anomaly PASSED [  2%]
tests/test_analysis_module.py::TestCheckValue::test_check_value_with_context PASSED [  2%]
tests/test_analysis_module.py::TestDetermineAnomalySeverity::test_severity_critical PASSED [  2%]
tests/test_analysis_module.py::TestDetermineAnomalySeverity::test_severity_high PASSED [  2%]
tests/test_analysis_module.py::TestDetermineAnomalySeverity::test_severity_medium PASSED [  3%]
tests/test_analysis_module.py::TestDetermineAnomalySeverity::test_severity_low PASSED [  3%]
tests/test_analysis_module.py::TestRecommendedAction::test_critical_action PASSED [  3%]
tests/test_analysis_module.py::TestRecommendedAction::test_high_action PASSED [  3%]
tests/test_analysis_module.py::TestRecommendedAction::test_medium_action PASSED [  3%]
tests/test_analysis_module.py::TestRecommendedAction::test_low_action PASSED [  3%]
tests/test_analysis_module.py::TestCollectiveAnomalyDetection::test_collective_needs_minimum_data PASSED [  3%]
tests/test_analysis_module.py::TestCollectiveAnomalyDetection::test_collective_detects_pattern PASSED [  3%]
tests/test_analysis_module.py::TestStatisticsAndRetrieval::test_get_statistics PASSED [  3%]
tests/test_analysis_module.py::TestStatisticsAndRetrieval::test_get_recent_anomalies PASSED [  4%]
tests/test_analysis_module.py::TestStatisticsAndRetrieval::test_get_recent_anomalies_with_severity_filter PASSED [  4%]
tests/test_analysis_module.py::TestPatternDataclasses::test_pattern_type_values PASSED [  4%]
tests/test_analysis_module.py::TestPatternDataclasses::test_pattern_to_dict PASSED [  4%]
tests/test_analysis_module.py::TestPatternRecognizerInit::test_default_initialization PASSED [  4%]
tests/test_analysis_module.py::TestPatternRecognizerInit::test_custom_sensitivity PASSED [  4%]
tests/test_analysis_module.py::TestTrafficPatternAnalysis::test_analyze_needs_minimum_data PASSED [  4%]
tests/test_analysis_module.py::TestTrafficPatternAnalysis::test_analyze_detects_spike PASSED [  4%]
tests/test_analysis_module.py::TestTrafficPatternAnalysis::test_analyze_detects_drop PASSED [  4%]
tests/test_analysis_module.py::TestSpikeDetection::test_spike_detection_threshold PASSED [  5%]
tests/test_analysis_module.py::TestDropDetection::test_drop_detection_threshold PASSED [  5%]
tests/test_analysis_module.py::TestPeriodicPatternDetection::test_periodic_needs_minimum_data PASSED [  5%]
tests/test_analysis_module.py::TestPeriodicPatternDetection::test_periodic_detects_repeating_pattern PASSED [  5%]
tests/test_analysis_module.py::TestErrorPatternDetection::test_error_clustering_detection PASSED [  5%]
tests/test_analysis_module.py::TestErrorPatternDetection::test_no_error_clustering_below_threshold PASSED [  5%]
tests/test_analysis_module.py::TestSecurityPatternDetection::test_brute_force_detection PASSED [  5%]
tests/test_analysis_module.py::TestSecurityPatternDetection::test_no_brute_force_below_threshold PASSED [  5%]
tests/test_analysis_module.py::TestPatternRecognizerStatistics::test_get_statistics PASSED [  5%]
tests/test_analysis_module.py::TestPatternRecognizerStatistics::test_get_recent_patterns PASSED [  6%]
tests/test_analysis_module.py::TestPatternRecognizerStatistics::test_get_recent_patterns_with_type_filter PASSED [  6%]
tests/test_analysis_module.py::TestAnalysisIntegration::test_detector_and_recognizer_together PASSED [  6%]
tests/test_analysis_module.py::TestAnalysisIntegration::test_module_imports PASSED [  6%]
tests/test_api_crud.py::TestHealthEndpoints::test_database_health PASSED [  6%]
tests/test_api_crud.py::TestHealthEndpoints::test_database_stats PASSED  [  6%]
tests/test_api_crud.py::TestHealthEndpoints::test_database_tables PASSED [  6%]
tests/test_api_crud.py::TestCRUDOperations::test_create_user PASSED      [  6%]
tests/test_api_crud.py::TestCRUDOperations::test_read_users PASSED       [  6%]
tests/test_api_crud.py::TestCRUDOperations::test_read_single_user PASSED [  7%]
tests/test_api_crud.py::TestCRUDOperations::test_update_user PASSED      [  7%]
tests/test_api_crud.py::TestCRUDOperations::test_delete_user PASSED      [  7%]
tests/test_api_crud.py::TestValidation::test_create_user_invalid_email PASSED [  7%]
tests/test_api_crud.py::TestValidation::test_create_user_missing_required_field PASSED [  7%]
tests/test_api_crud.py::TestPaginationAndFiltering::test_pagination PASSED [  7%]
tests/test_api_crud.py::TestPaginationAndFiltering::test_search PASSED   [  7%]
tests/test_api_crud.py::TestPaginationAndFiltering::test_ordering PASSED [  7%]
tests/test_api_crud.py::TestErrorHandling::test_not_found_table PASSED   [  7%]
tests/test_api_crud.py::TestErrorHandling::test_not_found_record PASSED  [  7%]
tests/test_api_crud.py::TestErrorHandling::test_unauthorized_access PASSED [  8%]
tests/test_api_first_platform.py::TestAPIFirstPlatformService::test_track_api_usage PASSED [  8%]
tests/test_api_first_platform.py::TestIntegration::test_full_api_lifecycle PASSED [  8%]
tests/test_app.py::test_app_fixture_loads_correctly PASSED               [  8%]
tests/test_bootstrap_db.py::test_bootstrap_db_encoding PASSED            [  8%]
tests/test_bug_repro_sqlalchemy_foreign_keys.py::test_sqlalchemy_mapper_configuration PASSED [  8%]
tests/test_chat_session_factory.py::test_chat_orchestrator_passes_session_factory PASSED [  8%]
tests/test_circular_dependency.py::test_circular_dependency_drop PASSED  [  8%]
tests/test_cli_smoke.py::test_seed_dry_run_returns_zero_runner PASSED    [  8%]
tests/test_dependency_availability.py::test_import_api_contract_service PASSED [  9%]
tests/test_dependency_layer_smoke.py::test_get_logger_smoke PASSED       [  9%]
tests/test_dependency_layer_smoke.py::test_get_settings_smoke PASSED     [  9%]
tests/test_dependency_layer_smoke.py::test_get_session_smoke PASSED      [  9%]
tests/test_email_case_insensitivity.py::test_email_case_insensitivity PASSED [  9%]
tests/test_engine_factory_comprehensive.py::TestQuantumStatementNameGenerator::test_generate_returns_string PASSED [  9%]
tests/test_engine_factory_comprehensive.py::TestQuantumStatementNameGenerator::test_generate_has_correct_prefix PASSED [  9%]
tests/test_engine_factory_comprehensive.py::TestQuantumStatementNameGenerator::test_generate_unique_names PASSED [  9%]
tests/test_engine_factory_comprehensive.py::TestQuantumStatementNameGenerator::test_generate_thread_safety PASSED [  9%]
tests/test_engine_factory_comprehensive.py::TestQuantumStatementNameGenerator::test_get_generator_func PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_detect_none_for_empty_url PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_detect_supabase_pooler_by_hostname PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_detect_supabase_pooler_by_port PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_detect_pgbouncer_by_port PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_detect_pgbouncer_by_name PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_detect_neon_pooler PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_detect_none_for_direct_connection PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_detect_pgbouncer_from_env PASSED [ 10%]
tests/test_engine_factory_comprehensive.py::TestAdaptivePoolerDetector::test_requires_prepared_statement_protection PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_sanitize_normalizes_postgres_protocol PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_sanitize_translates_ssl_mode_for_async PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_sanitize_preserves_ssl_mode_for_sync PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_sanitize_raises_for_missing_url_in_production PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_sanitize_returns_sqlite_fallback_in_test PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_sanitize_validates_url_structure PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_sanitize_accepts_sqlite_without_host PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_reverse_ssl_for_sync PASSED [ 11%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizer::test_reverse_ssl_ignores_asyncpg PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizerEdgeCases::test_all_ssl_modes PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizerEdgeCases::test_url_with_special_characters_in_password PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestDatabaseURLSanitizerEdgeCases::test_url_with_query_params_preserved PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestDatabaseTypeDetection::test_detect_postgresql PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestDatabaseTypeDetection::test_detect_sqlite PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestDatabaseTypeDetection::test_detect_unknown PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestPostgresEngineConfiguration::test_auto_upgrade_to_asyncpg PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestPostgresEngineConfiguration::test_statement_cache_disabled PASSED [ 12%]
tests/test_engine_factory_comprehensive.py::TestPostgresEngineConfiguration::test_quantum_naming_enabled PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestPostgresEngineConfiguration::test_command_timeout_default PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestPostgresEngineConfiguration::test_pool_settings_default PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestSqliteEngineConfiguration::test_auto_upgrade_to_aiosqlite PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestSqliteEngineConfiguration::test_pool_settings_removed PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestSqliteEngineConfiguration::test_check_same_thread_disabled PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestSecurityValidation::test_validation_passes_with_correct_config PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestSecurityValidation::test_validation_fails_with_nonzero_statement_cache PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestSecurityValidation::test_validation_fails_with_nonzero_prepared_cache PASSED [ 13%]
tests/test_engine_factory_comprehensive.py::TestSecurityValidation::test_validation_fails_without_name_func PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestSecurityValidation::test_validation_fails_with_non_unique_name_func PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestEngineDiagnostics::test_verify_pgbouncer_compatibility_all_set PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestEngineDiagnostics::test_verify_pgbouncer_compatibility_missing_settings PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestCreateUnifiedAsyncEngine::test_create_engine_with_sqlite PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestCreateUnifiedAsyncEngine::test_create_engine_from_env PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestCreateUnifiedAsyncEngine::test_create_engine_with_custom_pool_settings PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestPoolerSignature::test_pooler_signature_immutable PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestPoolerSignature::test_pooler_signatures_list_populated PASSED [ 14%]
tests/test_engine_factory_comprehensive.py::TestFatalEngineError::test_fatal_error_is_exception PASSED [ 15%]
tests/test_engine_factory_comprehensive.py::TestFatalEngineError::test_fatal_error_message PASSED [ 15%]
tests/test_fastapi_health.py::test_health PASSED                         [ 15%]
tests/test_flexible_enum_crash.py::test_flexible_enum_resilience PASSED  [ 15%]
tests/test_frontend_smoke.py::test_frontend_smoke_flow PASSED            [ 15%]
tests/test_head_request_bug.py::test_head_root_endpoint PASSED           [ 15%]
tests/test_head_request_bug.py::test_head_spa_fallback PASSED            [ 15%]
tests/test_head_request_bug.py::test_static_file_head PASSED             [ 15%]
tests/test_head_request_bug.py::test_js_file_head PASSED                 [ 15%]
tests/test_health_checker_task_reference.py::test_health_checker_task_not_garbage_collected PASSED [ 15%]
tests/test_health_checker_task_reference.py::test_health_checker_maintains_background_tasks_set PASSED [ 16%]
tests/test_health_checker_task_reference.py::test_health_checker_task_cleanup_on_completion PASSED [ 16%]
tests/test_health_checker_task_reference.py::test_health_checker_multiple_start_calls PASSED [ 16%]
tests/test_health_checker_task_reference.py::test_health_checker_task_survives_gc_cycles PASSED [ 16%]
tests/test_health_checker_task_reference.py::test_health_checker_done_callback_registered PASSED [ 16%]
tests/test_health_endpoint.py::test_health_endpoint PASSED               [ 16%]
tests/test_json_field_persistence.py::test_task_json_field_persistence PASSED [ 16%]
tests/test_json_field_primitive_bug.py::test_json_text_primitive_persistence_bug PASSED [ 16%]
tests/test_list_conversations_order_bug.py::test_list_conversations_deterministic_order PASSED [ 16%]
tests/test_login_bug_repro.py::test_login_bug_reproduction PASSED        [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_default_initialization PASSED [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_success_factory PASSED [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_success_factory_custom_message PASSED [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_failure_factory PASSED [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_forbidden_factory PASSED [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_forbidden_custom_message PASSED [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_unauthorized_factory PASSED [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_rate_limited_factory PASSED [ 17%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_rate_limited_custom_retry PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_bad_request_factory PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultCreation::test_internal_error_factory PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultChaining::test_with_metadata PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultChaining::test_with_metadata_chaining PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultChaining::test_with_details PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultChaining::test_with_details_merges PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultSerialization::test_to_dict_success PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultSerialization::test_to_dict_failure_with_error_code PASSED [ 18%]
tests/test_middleware_core.py::TestMiddlewareResultSerialization::test_to_dict_with_details PASSED [ 19%]
tests/test_middleware_core.py::TestMiddlewareResultSerialization::test_to_dict_with_response_data PASSED [ 19%]
tests/test_middleware_core.py::TestMiddlewareResultSerialization::test_to_dict_omits_empty_fields PASSED [ 19%]
tests/test_middleware_core.py::TestLifecycleHooksRegistration::test_register_callback PASSED [ 19%]
tests/test_middleware_core.py::TestLifecycleHooksRegistration::test_register_multiple_callbacks PASSED [ 19%]
tests/test_middleware_core.py::TestLifecycleHooksRegistration::test_register_callbacks_different_events PASSED [ 19%]
tests/test_middleware_core.py::TestLifecycleHooksUnregistration::test_unregister_callback PASSED [ 19%]
tests/test_middleware_core.py::TestLifecycleHooksUnregistration::test_unregister_nonexistent_callback PASSED [ 19%]
tests/test_middleware_core.py::TestLifecycleHooksUnregistration::test_unregister_from_nonexistent_event PASSED [ 19%]
tests/test_middleware_core.py::TestLifecycleHooksTrigger::test_trigger_executes_callbacks PASSED [ 20%]
tests/test_middleware_core.py::TestLifecycleHooksTrigger::test_trigger_passes_arguments PASSED [ 20%]
tests/test_middleware_core.py::TestLifecycleHooksTrigger::test_trigger_handles_callback_errors PASSED [ 20%]
tests/test_middleware_core.py::TestLifecycleHooksTrigger::test_trigger_empty_event PASSED [ 20%]
tests/test_middleware_core.py::TestLifecycleHooksClear::test_clear_specific_event PASSED [ 20%]
tests/test_middleware_core.py::TestLifecycleHooksClear::test_clear_all_events PASSED [ 20%]
tests/test_middleware_core.py::TestGlobalHooksAndDecorators::test_get_global_hooks PASSED [ 20%]
tests/test_middleware_core.py::TestGlobalHooksAndDecorators::test_on_before_execution_decorator PASSED [ 20%]
tests/test_middleware_core.py::TestGlobalHooksAndDecorators::test_on_after_success_decorator PASSED [ 20%]
tests/test_middleware_core.py::TestGlobalHooksAndDecorators::test_on_after_failure_decorator PASSED [ 21%]
tests/test_middleware_core.py::TestGlobalHooksAndDecorators::test_on_after_execution_decorator PASSED [ 21%]
tests/test_middleware_core.py::TestSmartPipelineInit::test_default_initialization PASSED [ 21%]
tests/test_middleware_core.py::TestSmartPipelineInit::test_initialization_with_middlewares PASSED [ 21%]
tests/test_middleware_core.py::TestSmartPipelineAddRemove::test_add_middleware PASSED [ 21%]
tests/test_middleware_core.py::TestSmartPipelineAddRemove::test_add_middleware_sorted_by_order PASSED [ 21%]
tests/test_middleware_core.py::TestSmartPipelineAddRemove::test_remove_middleware PASSED [ 21%]
tests/test_middleware_core.py::TestSmartPipelineAddRemove::test_remove_nonexistent_middleware PASSED [ 21%]
tests/test_middleware_core.py::TestSmartPipelineExecution::test_run_executes_middlewares PASSED [ 21%]
tests/test_middleware_core.py::TestSmartPipelineExecution::test_run_calls_lifecycle_hooks PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineExecution::test_run_short_circuits_on_failure PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineExecution::test_run_handles_middleware_exception PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineExecution::test_run_skips_disabled_middleware PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineAsyncExecution::test_run_async_executes_middlewares PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineAsyncExecution::test_run_async_handles_exception PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineStatistics::test_get_statistics PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineStatistics::test_statistics_track_requests PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineStatistics::test_statistics_track_failures PASSED [ 22%]
tests/test_middleware_core.py::TestSmartPipelineStatistics::test_statistics_per_middleware PASSED [ 23%]
tests/test_middleware_core.py::TestSmartPipelineStatistics::test_reset_statistics PASSED [ 23%]
tests/test_middleware_core.py::TestSmartPipelineHelpers::test_get_middleware_list PASSED [ 23%]
tests/test_middleware_core.py::TestSmartPipelineHelpers::test_repr PASSED [ 23%]
tests/test_middleware_core.py::TestRequestContext::test_default_initialization PASSED [ 23%]
tests/test_middleware_core.py::TestRequestContext::test_custom_initialization PASSED [ 23%]
tests/test_middleware_core.py::TestRequestContext::test_set_trace_context PASSED [ 23%]
tests/test_middleware_core.py::TestRequestContext::test_set_user_context PASSED [ 23%]
tests/test_middleware_core.py::TestRequestContext::test_add_and_get_metadata PASSED [ 23%]
tests/test_middleware_core.py::TestRequestContext::test_get_header_case_insensitive PASSED [ 23%]
tests/test_middleware_core.py::TestRequestContext::test_get_header_default PASSED [ 24%]
tests/test_middleware_core.py::TestRequestContext::test_to_dict PASSED   [ 24%]
tests/test_middleware_frame.py::test_dev_frame_middleware_development FAILED [ 24%]
tests/test_middleware_frame.py::test_dev_frame_middleware_production PASSED [ 24%]
tests/test_missing_api_methods.py::test_missing_api_endpoint_returns_404_not_405 PASSED [ 24%]
tests/test_models.py::test_user_set_password ERROR                       [ 24%]
tests/test_models.py::test_user_repr ERROR                               [ 24%]
tests/test_models_comprehensive.py::TestUtcNow::test_returns_datetime PASSED [ 24%]
tests/test_models_comprehensive.py::TestUtcNow::test_returns_utc_timezone PASSED [ 24%]
tests/test_models_comprehensive.py::TestUtcNow::test_returns_current_time PASSED [ 25%]
tests/test_models_comprehensive.py::TestCaseInsensitiveEnum::test_lookup_by_uppercase_name PASSED [ 25%]
tests/test_models_comprehensive.py::TestCaseInsensitiveEnum::test_lookup_by_lowercase_value PASSED [ 25%]
tests/test_models_comprehensive.py::TestCaseInsensitiveEnum::test_lookup_by_uppercase_value PASSED [ 25%]
tests/test_models_comprehensive.py::TestCaseInsensitiveEnum::test_lookup_by_mixed_case PASSED [ 25%]
tests/test_models_comprehensive.py::TestCaseInsensitiveEnum::test_invalid_lookup_returns_none PASSED [ 25%]
tests/test_models_comprehensive.py::TestCaseInsensitiveEnum::test_non_string_lookup_returns_none PASSED [ 25%]
tests/test_models_comprehensive.py::TestMessageRoleEnum::test_all_values PASSED [ 25%]
tests/test_models_comprehensive.py::TestMissionStatusEnum::test_all_values PASSED [ 25%]
tests/test_models_comprehensive.py::TestPlanStatusEnum::test_all_values PASSED [ 26%]
tests/test_models_comprehensive.py::TestTaskStatusEnum::test_all_values PASSED [ 26%]
tests/test_models_comprehensive.py::TestMissionEventTypeEnum::test_key_values PASSED [ 26%]
tests/test_models_comprehensive.py::TestFlexibleEnum::test_process_bind_param_with_enum PASSED [ 26%]
tests/test_models_comprehensive.py::TestFlexibleEnum::test_process_bind_param_with_string PASSED [ 26%]
tests/test_models_comprehensive.py::TestFlexibleEnum::test_process_bind_param_with_none PASSED [ 26%]
tests/test_models_comprehensive.py::TestFlexibleEnum::test_process_result_value_returns_enum PASSED [ 26%]
tests/test_models_comprehensive.py::TestFlexibleEnum::test_process_result_value_case_insensitive PASSED [ 26%]
tests/test_models_comprehensive.py::TestFlexibleEnum::test_process_result_value_with_none PASSED [ 26%]
tests/test_models_comprehensive.py::TestJSONText::test_process_bind_param_with_dict PASSED [ 27%]
tests/test_models_comprehensive.py::TestJSONText::test_process_bind_param_with_list PASSED [ 27%]
tests/test_models_comprehensive.py::TestJSONText::test_process_bind_param_with_none PASSED [ 27%]
tests/test_models_comprehensive.py::TestJSONText::test_process_bind_param_with_primitive PASSED [ 27%]
tests/test_models_comprehensive.py::TestJSONText::test_process_result_value_with_dict PASSED [ 27%]
tests/test_models_comprehensive.py::TestJSONText::test_process_result_value_with_list PASSED [ 27%]
tests/test_models_comprehensive.py::TestJSONText::test_process_result_value_with_none PASSED [ 27%]
tests/test_models_comprehensive.py::TestJSONText::test_process_result_value_with_invalid_json PASSED [ 27%]
tests/test_models_comprehensive.py::TestJSONText::test_roundtrip_complex_data PASSED [ 27%]
tests/test_models_comprehensive.py::TestUserModel::test_user_creation PASSED [ 28%]
tests/test_models_comprehensive.py::TestUserModel::test_set_password PASSED [ 28%]
tests/test_models_comprehensive.py::TestUserModel::test_check_password_correct PASSED [ 28%]
tests/test_models_comprehensive.py::TestUserModel::test_check_password_incorrect PASSED [ 28%]
tests/test_models_comprehensive.py::TestUserModel::test_check_password_no_hash PASSED [ 28%]
tests/test_models_comprehensive.py::TestUserModel::test_verify_password_alias PASSED [ 28%]
tests/test_models_comprehensive.py::TestUserModel::test_user_repr PASSED [ 28%]
tests/test_models_comprehensive.py::TestUserModel::test_password_hashing_uses_argon2 PASSED [ 28%]
tests/test_models_comprehensive.py::TestAdminConversationModel::test_conversation_creation PASSED [ 28%]
tests/test_models_comprehensive.py::TestAdminConversationModel::test_conversation_custom_type PASSED [ 29%]
tests/test_models_comprehensive.py::TestAdminMessageModel::test_message_creation PASSED [ 29%]
tests/test_models_comprehensive.py::TestAdminMessageModel::test_message_with_all_roles PASSED [ 29%]
tests/test_models_comprehensive.py::TestMissionModel::test_mission_creation PASSED [ 29%]
tests/test_models_comprehensive.py::TestMissionModel::test_mission_default_status PASSED [ 29%]
tests/test_models_comprehensive.py::TestMissionPlanModel::test_plan_creation PASSED [ 29%]
tests/test_models_comprehensive.py::TestMissionPlanModel::test_plan_json_fields PASSED [ 29%]
tests/test_models_comprehensive.py::TestTaskModel::test_task_creation PASSED [ 29%]
tests/test_models_comprehensive.py::TestTaskModel::test_task_json_fields PASSED [ 29%]
tests/test_models_comprehensive.py::TestMissionEventModel::test_event_creation PASSED [ 30%]
tests/test_models_comprehensive.py::TestPromptTemplateModel::test_template_creation PASSED [ 30%]
tests/test_models_comprehensive.py::TestGeneratedPromptModel::test_prompt_creation PASSED [ 30%]
tests/test_models_comprehensive.py::TestLogMissionEvent::test_creates_event_without_session PASSED [ 30%]
tests/test_models_comprehensive.py::TestUpdateMissionStatus::test_updates_status PASSED [ 30%]
tests/test_models_comprehensive.py::TestPasswordHashingEdgeCases::test_empty_password PASSED [ 30%]
tests/test_models_comprehensive.py::TestPasswordHashingEdgeCases::test_unicode_password PASSED [ 30%]
tests/test_models_comprehensive.py::TestPasswordHashingEdgeCases::test_very_long_password PASSED [ 30%]
tests/test_models_comprehensive.py::TestPasswordHashingEdgeCases::test_special_characters_password PASSED [ 30%]
tests/test_models_comprehensive.py::TestJSONTextEdgeCases::test_empty_dict PASSED [ 30%]
tests/test_models_comprehensive.py::TestJSONTextEdgeCases::test_empty_list PASSED [ 31%]
tests/test_models_comprehensive.py::TestJSONTextEdgeCases::test_unicode_in_json PASSED [ 31%]
tests/test_models_comprehensive.py::TestJSONTextEdgeCases::test_nested_null_values PASSED [ 31%]
tests/test_models_comprehensive.py::TestJSONTextEdgeCases::test_large_json PASSED [ 31%]
tests/test_overmind_fault_tolerance.py::test_circuit_breaker_activates PASSED [ 31%]
tests/test_overmind_planning.py::test_base_planner_instantiation PASSED  [ 31%]
tests/test_overmind_planning.py::test_base_planner_generate_plan_raises_not_implemented PASSED [ 31%]
tests/test_overmind_planning.py::test_base_planner_a_generate_plan_raises_not_implemented PASSED [ 31%]
tests/test_overmind_planning.py::test_planner_registration PASSED        [ 31%]
tests/test_overmind_planning.py::test_planner_registration_with_allow_list PASSED [ 32%]
tests/test_overmind_planning.py::test_planner_registration_with_block_list PASSED [ 32%]
tests/test_overmind_planning_config.py::test_default_config_values PASSED [ 32%]
tests/test_overmind_planning_config.py::test_parse_csv PASSED            [ 32%]
tests/test_overmind_planning_config.py::test_parse_bool PASSED           [ 32%]
tests/test_overmind_planning_config.py::test_parse_float PASSED          [ 32%]
tests/test_overmind_planning_config.py::test_parse_int PASSED            [ 32%]
tests/test_preview_headers.py::test_middleware_enabled_in_dev FAILED     [ 32%]
tests/test_preview_headers.py::test_middleware_enabled_in_codespaces FAILED [ 32%]
tests/test_preview_headers.py::test_middleware_disabled_in_production FAILED [ 33%]
tests/test_preview_headers.py::test_headers_removed_in_dev_client FAILED [ 33%]
tests/test_preview_headers.py::test_headers_preserved_in_prod_client PASSED [ 33%]
tests/test_prompt_engineering.py::test_generate_prompt_success PASSED    [ 33%]
tests/test_refactored_architecture.py::TestRoutingStrategies::test_round_robin_strategy PASSED [ 33%]
tests/test_refactored_architecture.py::TestRoutingStrategies::test_latency_based_strategy PASSED [ 33%]
tests/test_refactored_architecture.py::TestRoutingStrategies::test_strategy_factory PASSED [ 33%]
tests/test_refactored_architecture.py::TestCircuitBreaker::test_circuit_breaker_closed_state PASSED [ 33%]
tests/test_refactored_architecture.py::TestCircuitBreaker::test_circuit_breaker_opens_on_failures PASSED [ 33%]
tests/test_refactored_architecture.py::TestCircuitBreaker::test_circuit_breaker_half_open_recovery PASSED [ 34%]
tests/test_refactored_architecture.py::TestEventBus::test_event_subscription_and_publishing PASSED [ 34%]
tests/test_refactored_architecture.py::TestEventBus::test_event_history PASSED [ 34%]
tests/test_refactored_architecture.py::TestDependencyInjection::test_register_and_resolve PASSED [ 34%]
tests/test_refactored_architecture.py::TestDependencyInjection::test_singleton_registration PASSED [ 34%]
tests/test_refactored_architecture.py::TestChainOfResponsibility::test_authentication_handler PASSED [ 34%]
tests/test_refactored_architecture.py::TestChainOfResponsibility::test_failed_authentication PASSED [ 34%]
tests/test_refactored_architecture.py::TestRefactoredPlanner::test_plan_generation PASSED [ 34%]
tests/test_refactored_architecture.py::TestRefactoredPlanner::test_plan_validation PASSED [ 34%]
tests/test_refactored_architecture.py::TestRefactoredPlanner::test_plan_optimization PASSED [ 35%]
tests/test_refactored_architecture.py::TestRefactoredPlanner::test_context_analyzer PASSED [ 35%]
tests/test_refactored_architecture.py::TestRefactoredPlanner::test_task_generator PASSED [ 35%]
tests/test_refactored_architecture.py::TestIntegration::test_full_planning_flow PASSED [ 35%]
tests/test_refactored_modules.py::TestToolBuilder::test_builder_creates_tool PASSED [ 35%]
tests/test_refactored_modules.py::TestToolBuilder::test_builder_with_aliases PASSED [ 35%]
tests/test_refactored_modules.py::TestToolBuilder::test_builder_validation PASSED [ 35%]
tests/test_refactored_modules.py::TestToolRegistry::test_registry_registers_tool PASSED [ 35%]
tests/test_refactored_modules.py::TestToolRegistry::test_registry_prevents_duplicate_registration PASSED [ 35%]
tests/test_refactored_modules.py::TestToolRegistry::test_registry_handles_aliases PASSED [ 36%]
tests/test_refactored_modules.py::TestAnalysisPipeline::test_pipeline_executes_steps PASSED [ 36%]
tests/test_refactored_modules.py::TestAnalysisPipeline::test_pipeline_handles_errors PASSED [ 36%]
tests/test_refactored_modules.py::TestApplicationServices::test_health_check_service PASSED [ 36%]
tests/test_refactored_modules.py::TestApplicationServices::test_system_service PASSED [ 36%]
tests/test_refactored_modules.py::TestComplexityReduction::test_refactored_code_has_low_complexity PASSED [ 36%]
tests/test_refactored_modules.py::TestSOLIDPrinciples::test_single_responsibility_principle PASSED [ 36%]
tests/test_refactored_modules.py::TestSOLIDPrinciples::test_dependency_inversion_principle PASSED [ 36%]
tests/test_refactored_modules.py::TestSOLIDPrinciples::test_interface_segregation_principle PASSED [ 36%]
tests/test_repro_bug_order.py::test_get_latest_chat_deterministic_order PASSED [ 37%]
tests/test_security_enterprise.py::TestSecureAuthentication::test_password_hashing PASSED [ 37%]
tests/test_separation_of_concerns.py::TestServiceBoundaries::test_event_bus_publish_subscribe PASSED [ 37%]
tests/test_separation_of_concerns.py::TestServiceBoundaries::test_circuit_breaker_opens_on_failures PASSED [ 37%]
tests/test_separation_of_concerns.py::TestServiceBoundaries::test_bulkhead_limits_concurrent_requests PASSED [ 37%]
tests/test_separation_of_concerns.py::TestServiceBoundaries::test_api_gateway_response_aggregation PASSED [ 37%]
tests/test_separation_of_concerns.py::TestDataBoundaries::test_database_boundary_access_control PASSED [ 37%]
tests/test_separation_of_concerns.py::TestDataBoundaries::test_saga_successful_execution PASSED [ 37%]
tests/test_separation_of_concerns.py::TestDataBoundaries::test_saga_compensation_on_failure PASSED [ 37%]
tests/test_separation_of_concerns.py::TestDataBoundaries::test_event_sourcing_rebuild_state PASSED [ 38%]
tests/test_separation_of_concerns.py::TestPolicyBoundaries::test_policy_engine_allow_rule PASSED [ 38%]
tests/test_separation_of_concerns.py::TestPolicyBoundaries::test_policy_engine_deny_rule PASSED [ 38%]
tests/test_separation_of_concerns.py::TestPolicyBoundaries::test_security_pipeline_all_layers PASSED [ 38%]
tests/test_separation_of_concerns.py::TestPolicyBoundaries::test_data_governance_classification PASSED [ 38%]
tests/test_separation_of_concerns.py::TestPolicyBoundaries::test_compliance_engine_validation PASSED [ 38%]
tests/test_separation_of_concerns.py::TestIntegration::test_end_to_end_create_order_scenario PASSED [ 38%]
tests/test_separation_of_concerns.py::TestIntegration::test_global_instances_singleton PASSED [ 38%]
tests/test_separation_of_concerns.py::TestPerformance::test_event_bus_throughput PASSED [ 38%]
tests/test_separation_of_concerns.py::TestPerformance::test_policy_engine_evaluation_speed PASSED [ 38%]
tests/test_settings_smoke.py::test_settings_validation_error_on_missing_required_fields PASSED [ 39%]
tests/test_spa_fallback_fix.py::test_spa_fallback_nested_api_fix PASSED  [ 39%]
tests/test_static_api_path_bug.py::test_static_file_with_api_in_path_should_be_served PASSED [ 39%]
tests/test_static_routing_fix.py::test_serve_root PASSED                 [ 39%]
tests/test_static_routing_fix.py::test_serve_css PASSED                  [ 39%]
tests/test_static_routing_fix.py::test_spa_fallback PASSED               [ 39%]
tests/test_static_routing_fix.py::test_api_404 PASSED                    [ 39%]
tests/test_static_routing_fix.py::test_serve_specific_html PASSED        [ 39%]
tests/test_static_routing_fix.py::test_directory_traversal_prevention PASSED [ 39%]
tests/test_streaming_event_type_bug.py::test_chat_stream_has_delta_event_type FAILED [ 40%]
tests/test_stub_bug_fix.py::test_chat_stream_is_real_implementation PASSED [ 40%]
tests/test_superhuman_system.py::test_basic_request PASSED               [ 40%]
tests/test_system_healthz_bug.py::test_healthz_endpoint_failure PASSED   [ 40%]
tests/test_unified_observability.py::TestTraceContext::test_trace_context_creation PASSED [ 40%]
tests/test_unified_observability.py::TestTraceContext::test_trace_context_from_headers PASSED [ 40%]
tests/test_unified_observability.py::TestTraceContext::test_trace_context_to_headers PASSED [ 40%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_anomaly_detection PASSED [ 40%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_baggage_propagation PASSED [ 40%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_child_spans PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_counter_and_gauge PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_error_tracking PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_golden_signals PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_percentile_calculation PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_prometheus_export PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_record_metrics PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_service_dependencies PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_span_events PASSED [ 41%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_start_and_end_trace PASSED [ 42%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_statistics PASSED [ 42%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_structured_logging_with_correlation PASSED [ 42%]
tests/test_unified_observability.py::TestUnifiedObservabilityService::test_trace_search PASSED [ 42%]
tests/test_unified_observability.py::TestObservabilitySingleton::test_singleton_instance PASSED [ 42%]
tests/test_unified_observability.py::TestSamplingStrategies::test_always_sample_errors PASSED [ 42%]
tests/test_unified_observability.py::TestSamplingStrategies::test_head_based_sampling PASSED [ 42%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_starts_closed PASSED [ 42%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_successful_calls_keep_circuit_closed PASSED [ 42%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_opens_after_threshold_failures PASSED [ 43%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_rejects_calls_when_open PASSED [ 43%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_transitions_to_half_open PASSED [ 43%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_closes_after_successful_half_open PASSED [ 43%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_circuit_reopens_on_half_open_failure PASSED [ 43%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_manual_reset PASSED [ 43%]
tests/ai/test_circuit_breaker.py::TestCircuitBreaker::test_async_circuit_breaker PASSED [ 43%]
tests/api/test_admin_router_refactored.py::test_get_latest_chat_integration PASSED [ 43%]
tests/api/test_admin_router_refactored.py::test_list_conversations_integration PASSED [ 43%]
tests/api/test_admin_router_refactored.py::test_get_conversation_details_integration PASSED [ 44%]
tests/api/test_overmind_router.py::test_create_mission_endpoint FAILED   [ 44%]
tests/api/test_overmind_router.py::test_stream_endpoint_structure FAILED [ 44%]
tests/config/test_ai_models.py::TestAIModelsConfiguration::test_opus_4_5_is_available PASSED [ 44%]
tests/config/test_ai_models.py::TestAIModelsConfiguration::test_primary_model_is_opus_4_5 PASSED [ 44%]
tests/config/test_ai_models.py::TestAIModelsConfiguration::test_gateway_primary_model_is_opus_4_5 PASSED [ 44%]
tests/config/test_ai_models.py::TestAIModelsConfiguration::test_ai_config_singleton_reflects_changes PASSED [ 44%]
tests/config/test_settings.py::test_database_url_fixer_handles_duplicates_gracefully PASSED [ 44%]
tests/config/test_settings.py::test_database_url_fixer_handles_simple_sslmode PASSED [ 44%]
tests/config/test_superhuman_config.py::TestSuperhumanConfiguration::test_codespaces_detection PASSED [ 45%]
tests/config/test_superhuman_config.py::TestSuperhumanConfiguration::test_database_url_auto_healing PASSED [ 45%]
tests/config/test_superhuman_config.py::TestSuperhumanConfiguration::test_secret_absorption PASSED [ 45%]
tests/config/test_superhuman_config.py::TestSuperhumanConfiguration::test_sqlite_fallback PASSED [ 45%]
tests/config/test_superhuman_config.py::TestSuperhumanConfiguration::test_cors_injection PASSED [ 45%]
tests/config/test_superhuman_config.py::TestSuperhumanConfiguration::test_production_strict_validation PASSED [ 45%]
tests/contract/test_api_contract.py::TestAPIContracts::test_contract_placeholder PASSED [ 45%]
tests/contract/test_api_contract.py::TestAPIContracts::test_consumer_contract PASSED [ 45%]
tests/contract/test_api_contract.py::TestAPIContracts::test_provider_contract PASSED [ 45%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[What is the capital of France?-CognitiveComplexity.REFLEX] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Hello, how are you?-CognitiveComplexity.REFLEX] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Translate 'book' to Spanish.-CognitiveComplexity.REFLEX] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Summarize the main points of the article about climate change.-CognitiveComplexity.THOUGHT] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Explain the difference between supervised and unsupervised machine learning.-CognitiveComplexity.THOUGHT] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[What are the implications of quantum computing on modern cryptography?-CognitiveComplexity.THOUGHT] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[def factorial(n):-CognitiveComplexity.DEEP_THOUGHT] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Write a Python function to find all prime numbers up to n.-CognitiveComplexity.DEEP_THOUGHT] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[```javascript\nconst x = 10;\n```-CognitiveComplexity.DEEP_THOUGHT] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Write a short story about a robot who discovers music.-CognitiveComplexity.CREATIVE] PASSED [ 46%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Imagine you are a dragon. Describe your hoard.-CognitiveComplexity.CREATIVE] PASSED [ 47%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Create a dialogue between Plato and a modern-day influencer.-CognitiveComplexity.CREATIVE] PASSED [ 47%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Solve the following equation for x: 2x + 5 = 15-CognitiveComplexity.LOGICAL_REASONING] PASSED [ 47%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[Calculate the derivative of x^3.-CognitiveComplexity.LOGICAL_REASONING] PASSED [ 47%]
tests/core/test_cognitive_fingerprint.py::test_assess_cognitive_complexity[If a train leaves station A at 60 mph and another leaves station B at 70 mph, when will they meet?-CognitiveComplexity.LOGICAL_REASONING] PASSED [ 47%]
tests/core/test_cognitive_fingerprint_bug_fix.py::test_cognitive_complexity_precedence[Write a python function to solve a quadratic equation-CognitiveComplexity.DEEP_THOUGHT] PASSED [ 47%]
tests/core/test_cognitive_fingerprint_bug_fix.py::test_cognitive_complexity_precedence[Write a Python function to calculate the factorial-CognitiveComplexity.DEEP_THOUGHT] PASSED [ 47%]
tests/core/test_cognitive_fingerprint_bug_fix.py::test_cognitive_complexity_precedence[Write a poem about a function-CognitiveComplexity.CREATIVE] PASSED [ 47%]
tests/core/test_cognitive_fingerprint_bug_fix.py::test_cognitive_complexity_precedence[Solve the following equation for x-CognitiveComplexity.LOGICAL_REASONING] PASSED [ 47%]
tests/core/test_duplication_elimination.py::TestCommonImports::test_import_helper_get_existing_module PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestCommonImports::test_import_helper_get_nonexistent_module PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestCommonImports::test_import_helper_has_module PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestCommonImports::test_import_helper_caching PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestCommonImports::test_feature_flags PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_safe_execute_success PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_safe_execute_with_error PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_safe_execute_with_none_default PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_retry_on_failure_success_first_try PASSED [ 48%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_retry_on_failure_success_after_retries PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_retry_on_failure_exhausted PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_suppress_errors_success PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_suppress_errors_suppresses_specified PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_suppress_errors_doesnt_suppress_others PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_safe_context_success PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_safe_context_with_error PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_capture_errors_captures PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_capture_errors_without_list PASSED [ 49%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_error_handler_handle PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_error_handler_wrap_function_success PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_error_handler_wrap_function_error PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_format_exception_without_traceback PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestErrorHandling::test_format_exception_with_traceback PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_ring_buffer_append PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_ring_buffer_overflow PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_ring_buffer_clear PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_base_profiler_init PASSED [ 50%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_base_profiler_enable_disable PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_base_profiler_clear PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_base_metrics_collector_record PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_base_metrics_collector_record_disabled PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_base_metrics_collector_reset PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_base_metrics_collector_statistics PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_time_profiler_record_duration PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_time_profiler_statistics PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_time_profiler_statistics_empty PASSED [ 51%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_count_profiler_increment PASSED [ 52%]
tests/core/test_duplication_elimination.py::TestBaseProfiler::test_count_profiler_statistics PASSED [ 52%]
tests/core/test_duplication_elimination.py::TestIntegrationScenarios::test_error_handler_with_retry PASSED [ 52%]
tests/core/test_duplication_elimination.py::TestIntegrationScenarios::test_profiler_with_error_handling PASSED [ 52%]
tests/core/test_engine_factory_hardened.py::test_create_unified_async_engine_postgres_hardening PASSED [ 52%]
tests/core/test_engine_factory_hardened.py::test_create_unified_async_engine_sqlite PASSED [ 52%]
tests/core/test_engine_factory_hardened.py::test_sanitize_database_url PASSED [ 52%]
tests/core/test_engine_factory_hardened.py::test_create_unified_async_engine_protocol_upgrade PASSED [ 52%]
tests/core/test_engine_factory_hardened.py::test_pgbouncer_compatibility_settings PASSED [ 52%]
tests/core/test_engine_factory_hardened.py::test_adaptive_pooler_detection PASSED [ 53%]
tests/core/test_engine_factory_hardened.py::test_quantum_statement_name_generator PASSED [ 53%]
tests/core/test_kernel_comprehensive.py::TestRealityKernel::test_kernel_initialization PASSED [ 53%]
tests/core/test_kernel_comprehensive.py::TestRealityKernel::test_get_app_returns_app PASSED [ 53%]
tests/core/test_kernel_comprehensive.py::TestRealityKernel::test_kernel_resilience_to_random_settings PASSED [ 53%]
tests/core/test_kernel_comprehensive.py::TestRealityKernel::test_route_weaving_logic PASSED [ 53%]
tests/core/test_kernel_comprehensive.py::TestRealityKernel::test_lifespan_startup_shutdown PASSED [ 53%]
tests/core/test_kernel_comprehensive.py::TestRealityKernel::test_cors_logic_dev_vs_prod PASSED [ 53%]
tests/core/test_middleware_duplication.py::test_middleware_chaos_interference PASSED [ 53%]
tests/core/test_rate_limit_middleware_config.py::test_rate_limit_middleware_exists PASSED [ 53%]
tests/core/test_schema_validation_bug.py::test_validate_and_fix_schema_bug_on_sqlite PASSED [ 54%]
tests/core/test_self_healing_core.py::TestSelfHealingSecurity::test_validate_table_name_security PASSED [ 54%]
tests/core/test_self_healing_core.py::TestSelfHealingSecurity::test_validate_column_name_security PASSED [ 54%]
tests/core/test_self_healing_core.py::TestSQLGenerator::test_add_column_sql PASSED [ 54%]
tests/core/test_self_healing_core.py::TestSQLGenerator::test_create_index_sql PASSED [ 54%]
tests/core/test_self_healing_core.py::TestSelfHealingEngineLogic::test_heal_async_detects_missing_column PASSED [ 54%]
tests/core/test_self_healing_core.py::TestSelfHealingEngineLogic::test_heal_api_error PASSED [ 54%]
tests/core/test_static_handler_refactor.py::test_serve_index_at_root PASSED [ 54%]
tests/core/test_static_handler_refactor.py::test_serve_static_asset PASSED [ 54%]
tests/core/test_static_handler_refactor.py::test_spa_fallback_for_routes PASSED [ 55%]
tests/core/test_static_handler_refactor.py::test_api_404_no_fallback PASSED [ 55%]
tests/core/test_static_handler_refactor.py::test_nested_api_404_no_fallback PASSED [ 55%]
tests/core/test_static_handler_refactor.py::test_directory_traversal_protection PASSED [ 55%]
tests/core/test_superhuman_ai_gateway.py::TestSuperhumanAIGateway::test_complexity_routing PASSED [ 55%]
tests/core/test_superhuman_ai_gateway.py::TestSuperhumanAIGateway::test_circuit_breaker_integration PASSED [ 55%]
tests/core/test_superhuman_ai_gateway.py::TestSuperhumanAIGateway::test_fallback_chain PASSED [ 55%]
tests/core/math/test_omni_router_semantic.py::TestSemanticAffinityEngine::test_coding_affinity PASSED [ 55%]
tests/core/math/test_omni_router_semantic.py::TestSemanticAffinityEngine::test_creative_affinity PASSED [ 55%]
tests/core/math/test_omni_router_semantic.py::TestSemanticAffinityEngine::test_neutral_prompt PASSED [ 56%]
tests/core/math/test_omni_router_semantic.py::TestOmniCognitiveRouterSemantic::test_ranking_with_semantics PASSED [ 56%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_int_env_default PASSED [ 56%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_int_env_from_env PASSED [ 56%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_int_env_invalid PASSED [ 56%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_default_false PASSED [ 56%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_default_true PASSED [ 56%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_truthy[1] PASSED [ 56%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_truthy[true] PASSED [ 56%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_truthy[TRUE] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_truthy[yes] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_truthy[YES] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_truthy[on] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_truthy[ON] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_falsy[0] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_falsy[false] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_falsy[FALSE] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_falsy[no] PASSED [ 57%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_falsy[NO] PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_falsy[off] PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_bool_env_falsy[OFF] PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_str_env_default PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_str_env_from_env PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_float_env_default PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_float_env_from_env PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestEnvReader::test_read_float_env_invalid PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestDuplicationElimination::test_single_implementation PASSED [ 58%]
tests/infrastructure/test_env_reader.py::TestDuplicationElimination::test_backward_compatibility PASSED [ 59%]
tests/integration/test_admin_chat_api.py::TestAdminChatAPI::test_health_check PASSED [ 59%]
tests/integration/test_admin_chat_api.py::TestAdminChatAPI::test_admin_chat_unauthorized PASSED [ 59%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_ClientInitialization::test_client_defaults_to_mock_without_api_key PASSED [ 59%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_ClientInitialization::test_force_mock_overrides_api_key PASSED [ 59%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_ClientInitialization::test_singleton_behavior PASSED [ 59%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_InvokeChat::test_invoke_chat_with_mock_client PASSED [ 59%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_InvokeChat::test_invoke_chat_respects_temperature PASSED [ 59%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_InvokeChat::test_invoke_chat_with_tools PASSED [ 59%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_LLMHealth::test_llm_health_structure PASSED [ 60%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_PayloadPreparation::test_payload_respects_llm_force_model PASSED [ 60%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_ErrorHandling::test_empty_response_triggers_retry PASSED [ 60%]
tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_Snapshots::test_create_baseline_snapshot PASSED [ 60%]
tests/phase3_refactoring/test_model_serving_e2e.py::TestModelServingE2E::test_full_inference_lifecycle PASSED [ 60%]
tests/phase3_refactoring/test_model_serving_e2e.py::TestModelServingE2E::test_routing_to_missing_model_fails_gracefully PASSED [ 60%]
tests/phase3_refactoring/test_model_serving_e2e.py::TestModelServingE2E::test_fallback_to_older_version_if_latest_not_ready PASSED [ 60%]
tests/phase3_refactoring/test_model_serving_refactored.py::TestDomainLayer::test_model_version_creation PASSED [ 60%]
tests/phase3_refactoring/test_model_serving_refactored.py::TestDomainLayer::test_model_status_enum PASSED [ 60%]
tests/phase3_refactoring/test_model_serving_refactored.py::TestInfrastructureLayer::test_in_memory_repository_save_and_get PASSED [ 61%]
tests/phase3_refactoring/test_model_serving_refactored.py::TestInfrastructureLayer::test_in_memory_repository_list_by_name PASSED [ 61%]
tests/phase3_refactoring/test_model_serving_refactored.py::TestInfrastructureLayer::test_mock_invoker_generates_response PASSED [ 61%]
tests/phase3_refactoring/test_model_serving_refactored.py::TestApplicationLayer::test_model_registry_registers_model PASSED [ 61%]
tests/phase3_refactoring/test_model_serving_refactored.py::TestApplicationLayer::test_model_registry_gets_latest_ready PASSED [ 61%]
tests/phase3_refactoring/test_model_serving_refactored.py::TestApplicationLayer::test_inference_router_serves_request PASSED [ 61%]
tests/security/test_admin_security_upgrades.py::test_access_control_isolation PASSED [ 61%]
tests/security/test_admin_security_upgrades.py::test_admin_can_access_any_conversation PASSED [ 61%]
tests/security/test_admin_security_upgrades.py::test_cors_strictness_mock PASSED [ 61%]
tests/security/test_bcrypt_compat.py::test_bcrypt_hashing_and_verification PASSED [ 61%]
tests/security/test_bcrypt_compat.py::test_bcrypt_backend_attributes PASSED [ 62%]
tests/security/test_encryption.py::test_encryption_decryption PASSED     [ 62%]
tests/security/test_encryption.py::test_decryption_with_invalid_key_id PASSED [ 62%]
tests/security/test_encryption.py::test_key_rotation PASSED              [ 62%]
tests/security/test_encryption.py::test_get_statistics PASSED            [ 62%]
tests/security/test_hyper_defense.py::test_chrono_shield_allowance_under_limit PASSED [ 62%]
tests/security/test_hyper_defense.py::test_chrono_shield_exponential_backoff PASSED [ 62%]
tests/security/test_hyper_defense.py::test_chrono_shield_hard_lockout PASSED [ 62%]
tests/security/test_hyper_defense.py::test_chrono_shield_reset PASSED    [ 62%]
tests/security/test_hyper_defense.py::test_chrono_shield_ip_persistence PASSED [ 63%]
tests/security/test_password_compat.py::test_legacy_hash_support PASSED  [ 63%]
tests/security/test_security_final.py::TestSecuritySuperhuman::test_sqli_resilience_static[' OR 1=1 --] PASSED [ 63%]
tests/security/test_security_final.py::TestSecuritySuperhuman::test_sqli_resilience_static['; DROP TABLE users; --] PASSED [ 63%]
tests/security/test_security_final.py::TestSecuritySuperhuman::test_generic_fuzzing_resilience PASSED [ 63%]
tests/security/test_user_me_endpoint.py::test_user_me_endpoint PASSED    [ 63%]
tests/security/test_user_me_endpoint.py::test_user_me_endpoint_invalid_token PASSED [ 63%]
tests/security/test_yaml_rce.py::TestYamlRCEProtection::test_unsafe_yaml_load_vulnerability_repro PASSED [ 63%]
tests/security/test_yaml_rce.py::TestYamlRCEProtection::test_safe_load_utility_success PASSED [ 63%]
tests/security/test_yaml_rce.py::TestYamlRCEProtection::test_safe_load_utility_file PASSED [ 64%]
tests/security/test_yaml_rce.py::TestYamlRCEProtection::test_prevention_of_rce_payload PASSED [ 64%]
tests/security/test_yaml_rce.py::TestYamlRCEProtection::test_codebase_scan_for_unsafe_load PASSED [ 64%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_validate_auth_header_valid PASSED [ 64%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_validate_auth_header_missing PASSED [ 64%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_validate_auth_header_invalid_format PASSED [ 64%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_validate_auth_header_not_bearer PASSED [ 64%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_validate_auth_header_invalid_token PASSED [ 64%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_validate_auth_header_missing_sub PASSED [ 64%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_validate_auth_header_invalid_user_id_type PASSED [ 65%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_get_or_create_conversation_create_new PASSED [ 65%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_get_or_create_conversation_existing PASSED [ 65%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_get_or_create_conversation_not_found PASSED [ 65%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_get_or_create_conversation_invalid_id FAILED [ 65%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_save_message PASSED [ 65%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_get_chat_history PASSED [ 65%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_stream_chat_response_flow PASSED [ 65%]
tests/services/test_admin_chat_boundary_service_comprehensive.py::test_stream_chat_response_error_handling PASSED [ 65%]
tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_validate_auth_header_valid PASSED [ 66%]
tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_validate_auth_header_missing PASSED [ 66%]
tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_validate_auth_header_malformed_fuzz PASSED [ 66%]
tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_validate_auth_header_invalid_token PASSED [ 66%]
tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_verify_conversation_access_success PASSED [ 66%]
tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_verify_conversation_access_failures PASSED [ 66%]
tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_get_or_create_conversation_delegation FAILED [ 66%]
tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_stream_chat_response_delegation PASSED [ 66%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_smart_token_chunker_chunk_text PASSED [ 66%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_smart_token_chunker_smart_chunk PASSED [ 67%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_speculative_decoder_patterns PASSED [ 67%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_streaming_metrics PASSED [ 67%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_streaming_metrics_empty PASSED [ 67%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_service_initialization PASSED [ 67%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_service_stream_response PASSED [ 67%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_service_async_stream_response PASSED [ 67%]
tests/services/test_admin_chat_streaming_service_coverage.py::test_singleton PASSED [ 67%]
tests/services/test_ai_adaptive_microservices.py::TestAIScalingEngine::test_predict_load_insufficient_data PASSED [ 67%]
tests/services/test_ai_adaptive_microservices.py::TestAIScalingEngine::test_predict_load_with_history PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestAIScalingEngine::test_calculate_optimal_instances_scale_up PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestAIScalingEngine::test_calculate_optimal_instances_scale_down PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestAIScalingEngine::test_calculate_optimal_instances_stable PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestAIScalingEngine::test_calculate_optimal_instances_latency_trigger PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestIntelligentRouter::test_select_instance_none_available PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestIntelligentRouter::test_select_instance_prefers_healthy PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestIntelligentRouter::test_select_instance_fallback_degraded PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestIntelligentRouter::test_calculate_instance_score PASSED [ 68%]
tests/services/test_ai_adaptive_microservices.py::TestIntelligentRouter::test_update_instance_score PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestPredictiveHealthMonitor::test_analyze_health_healthy PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestPredictiveHealthMonitor::test_analyze_health_critical PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestPredictiveHealthMonitor::test_analyze_health_degraded PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestPredictiveHealthMonitor::test_detect_anomalies PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestPredictiveHealthMonitor::test_predict_failure PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestSelfAdaptiveMicroservices::test_register_service PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestSelfAdaptiveMicroservices::test_update_metrics_and_health PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestSelfAdaptiveMicroservices::test_auto_scale_up PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestSelfAdaptiveMicroservices::test_auto_scale_down PASSED [ 69%]
tests/services/test_ai_adaptive_microservices.py::TestSelfAdaptiveMicroservices::test_route_request PASSED [ 70%]
tests/services/test_ai_adaptive_microservices.py::TestSelfAdaptiveMicroservices::test_get_service_status PASSED [ 70%]
tests/services/test_ai_adaptive_microservices.py::TestSelfAdaptiveMicroservices::test_aggregate_metrics PASSED [ 70%]
tests/services/test_ai_advanced_security.py::TestDeepLearningThreatDetector::test_detect_sql_injection_payload PASSED [ 70%]
tests/services/test_ai_advanced_security.py::TestDeepLearningThreatDetector::test_detect_sql_injection_url PASSED [ 70%]
tests/services/test_ai_advanced_security.py::TestDeepLearningThreatDetector::test_detect_xss PASSED [ 70%]
tests/services/test_ai_advanced_security.py::TestDeepLearningThreatDetector::test_detect_malformed_request_code PASSED [ 70%]
tests/services/test_ai_advanced_security.py::TestDeepLearningThreatDetector::test_detect_malformed_request_payload_size PASSED [ 70%]
tests/services/test_ai_advanced_security.py::TestBehavioralAnalyzer::test_get_or_create_profile PASSED [ 70%]
tests/services/test_ai_advanced_security.py::TestBehavioralAnalyzer::test_detect_unusual_endpoint PASSED [ 71%]
tests/services/test_ai_advanced_security.py::TestBehavioralAnalyzer::test_update_profile PASSED [ 71%]
tests/services/test_ai_advanced_security.py::TestAutomatedResponseSystem::test_block_ip PASSED [ 71%]
tests/services/test_ai_advanced_security.py::TestAutomatedResponseSystem::test_block_user PASSED [ 71%]
tests/services/test_ai_advanced_security.py::TestAutomatedResponseSystem::test_rate_limit PASSED [ 71%]
tests/services/test_ai_advanced_security.py::TestAutomatedResponseSystem::test_respond_to_critical_threat PASSED [ 71%]
tests/services/test_ai_advanced_security.py::TestSuperhumanSecuritySystem::test_process_legitimate_request PASSED [ 71%]
tests/services/test_ai_advanced_security.py::TestSuperhumanSecuritySystem::test_process_malicious_request PASSED [ 71%]
tests/services/test_ai_advanced_security.py::TestSuperhumanSecuritySystem::test_security_dashboard PASSED [ 71%]
tests/services/test_ai_intelligent_testing.py::test_analyze_code PASSED  [ 72%]
tests/services/test_ai_intelligent_testing.py::test_analyze_code_syntax_error PASSED [ 72%]
tests/services/test_ai_intelligent_testing.py::test_generate_tests_for_function PASSED [ 72%]
tests/services/test_ai_intelligent_testing.py::test_smart_selector PASSED [ 72%]
tests/services/test_ai_intelligent_testing.py::test_coverage_optimizer PASSED [ 72%]
tests/services/test_api_security_service.py::test_api_security_service_instantiation PASSED [ 72%]
tests/services/test_api_security_service.py::test_security_service_methods PASSED [ 72%]
tests/services/test_api_security_service.py::test_api_security_service_integration PASSED [ 72%]
tests/services/test_config_secrets_hexagonal.py::test_config_crud PASSED [ 72%]
tests/services/test_config_secrets_hexagonal.py::test_secret_lifecycle PASSED [ 73%]
tests/services/test_config_secrets_hexagonal.py::test_audit_logs PASSED  [ 73%]
tests/services/test_config_secrets_hexagonal.py::test_singleton PASSED   [ 73%]
tests/services/test_data_mesh_refactor.py::test_data_mesh_refactor_verification PASSED [ 73%]
tests/services/test_duplication_buster.py::TestDuplicationBuster::test_init PASSED [ 73%]
tests/services/test_duplication_buster.py::TestDuplicationBuster::test_analyze_file_parses_functions PASSED [ 73%]
tests/services/test_duplication_buster.py::TestDuplicationBuster::test_analyze_file_detects_duplicates PASSED [ 73%]
tests/services/test_duplication_buster.py::TestDuplicationBuster::test_analyze_file_ignores_non_duplicates PASSED [ 73%]
tests/services/test_duplication_buster.py::TestDuplicationBuster::test_scan_traverses_directories PASSED [ 73%]
tests/services/test_duplication_buster.py::TestDuplicationBuster::test_generate_report_format PASSED [ 74%]
tests/services/test_duplication_buster.py::TestDuplicationBuster::test_analyze_file_handles_exceptions PASSED [ 74%]
tests/services/test_duplication_buster.py::TestDuplicationBuster::test_async_functions PASSED [ 74%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_calculate_complexity_simple PASSED [ 74%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_calculate_complexity_complex PASSED [ 74%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_count_technical_terms PASSED [ 74%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_is_multi_step PASSED [ 74%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_measure_ambiguity PASSED [ 74%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_assess_creativity_need PASSED [ 74%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_is_urgent PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_detect_domain PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_estimate_response_length PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_needs_reasoning PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestQueryClassifier::test_analyze_integration PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestCostOptimizer::test_can_afford PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestCostOptimizer::test_suggest_cheaper_alternative PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestCostOptimizer::test_record_cost PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestIntelligentRouter::test_route_simple_urgent PASSED [ 75%]
tests/services/test_ensemble_ai.py::TestIntelligentRouter::test_route_simple_not_urgent PASSED [ 76%]
tests/services/test_ensemble_ai.py::TestIntelligentRouter::test_route_medium PASSED [ 76%]
tests/services/test_ensemble_ai.py::TestIntelligentRouter::test_route_complex PASSED [ 76%]
tests/services/test_ensemble_ai.py::TestIntelligentRouter::test_route_cost_downgrade PASSED [ 76%]
tests/services/test_ensemble_ai.py::TestIntelligentRouter::test_get_next_tier PASSED [ 76%]
tests/services/test_ensemble_ai.py::test_get_router_singleton PASSED     [ 76%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_get_recent_conversations_success ERROR [ 76%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_get_recent_conversations_limit ERROR [ 76%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_get_recent_conversations_error PASSED [ 76%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_success ERROR [ 76%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_invalid_rating PASSED [ 77%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_not_found ERROR [ 77%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_security_violation ERROR [ 77%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_db_error ERROR [ 77%]
tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_unexpected_error ERROR [ 77%]
tests/services/test_kubernetes_orchestration_refactored.py::test_kubernetes_orchestration_imports PASSED [ 77%]
tests/services/test_llm_client_service.py::TestLLMInitialization::test_get_llm_client_defaults_to_mock PASSED [ 77%]
tests/services/test_llm_client_service.py::TestLLMInitialization::test_force_mock_mode PASSED [ 77%]
tests/services/test_llm_client_service.py::TestLLMInitialization::test_openai_client_initialization PASSED [ 77%]
tests/services/test_llm_client_service.py::TestLLMInitialization::test_openrouter_http_fallback PASSED [ 78%]
tests/services/test_llm_client_service.py::TestLLMInitialization::test_real_client_init_failure_falls_back_to_mock PASSED [ 78%]
tests/services/test_llm_client_service.py::TestMockClient::test_mock_client_chat_completion PASSED [ 78%]
tests/services/test_llm_client_service.py::TestHttpFallbackClient::test_http_fallback_chat_completion_success PASSED [ 78%]
tests/services/test_llm_client_service.py::TestInvocationLogic::test_invoke_chat_success_mock PASSED [ 78%]
tests/services/test_llm_client_service.py::TestInvocationLogic::test_invoke_chat_hooks PASSED [ 78%]
tests/services/test_llm_client_service.py::TestInvocationLogic::test_invoke_chat_retry_logic PASSED [ 78%]
tests/services/test_llm_client_service.py::TestInvocationLogic::test_circuit_breaker PASSED [ 78%]
tests/services/test_llm_client_service.py::TestInvocationLogic::test_invoke_chat_stream PASSED [ 78%]
tests/services/test_llm_client_service.py::TestInvocationLogic::test_cost_estimation PASSED [ 79%]
tests/services/test_llm_client_service.py::TestInvocationLogic::test_sanitization PASSED [ 79%]
tests/services/test_llm_client_service.py::TestInvocationLogic::test_llm_health PASSED [ 79%]
tests/services/test_overmind_super_agent.py::test_council_of_wisdom_flow PASSED [ 79%]
tests/services/test_overmind_super_agent.py::test_self_correction_loop PASSED [ 79%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_project_structure PASSED [ 79%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_code_statistics PASSED [ 79%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_models_info PASSED [ 79%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_services_info PASSED [ 79%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_api_routes_info PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_recent_issues_no_issues PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_strengths PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_deep_file_analysis PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_architecture_layers PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_key_components PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_generate_context_for_ai PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_invalidate_cache PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_deep_search_issues PASSED [ 80%]
tests/services/test_project_context_service.py::TestProjectContextService::test_intelligent_code_search PASSED [ 81%]
tests/services/test_project_context_service.py::TestProjectContextService::test_detect_code_smells PASSED [ 81%]
tests/services/test_project_context_service.py::TestProjectContextService::test_get_comprehensive_analysis PASSED [ 81%]
tests/services/test_prompt_engineering_service.py::test_generate_prompt_existing_template PASSED [ 81%]
tests/services/test_prompt_engineering_service.py::test_generate_prompt_missing_template PASSED [ 81%]
tests/services/test_prompt_engineering_service.py::test_generate_prompt_formatting_error PASSED [ 81%]
tests/services/test_saga_coverage.py::test_saga_creation PASSED          [ 81%]
tests/services/test_saga_coverage.py::test_successful_saga PASSED        [ 81%]
tests/services/test_saga_coverage.py::test_failed_saga_compensation PASSED [ 81%]
tests/services/test_saga_coverage.py::test_retry_logic PASSED            [ 82%]
tests/services/test_saga_coverage.py::test_max_retries_exceeded PASSED   [ 82%]
tests/services/test_saga_coverage.py::test_concurrent_execution_prevention PASSED [ 82%]
tests/services/test_saga_coverage.py::test_not_found PASSED              [ 82%]
tests/services/test_saga_coverage.py::test_metrics_and_events PASSED     [ 82%]
tests/services/test_saga_coverage.py::test_singleton PASSED              [ 82%]
tests/services/test_security_metrics_coverage.py::test_metrics_calculator_empty PASSED [ 82%]
tests/services/test_security_metrics_coverage.py::test_metrics_calculator_basic_counts PASSED [ 82%]
tests/services/test_security_metrics_coverage.py::test_velocity_metrics PASSED [ 82%]
tests/services/test_security_metrics_coverage.py::test_quality_metrics PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_team_metrics PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_risk_calculator_empty PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_risk_calculator_basic PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_risk_calculator_exposure_logic PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_predictor_not_enough_data PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_predictor_linear_trend PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_predictor_decreasing_trend PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_in_memory_findings_repo PASSED [ 83%]
tests/services/test_security_metrics_coverage.py::test_in_memory_metrics_repo PASSED [ 84%]
tests/services/test_security_metrics_coverage.py::test_facade PASSED     [ 84%]
tests/services/test_security_metrics_coverage.py::test_singleton PASSED  [ 84%]
tests/services/test_service_catalog_coverage.py::test_initialization PASSED [ 84%]
tests/services/test_service_catalog_coverage.py::test_register_get_service PASSED [ 84%]
tests/services/test_service_catalog_coverage.py::test_api_spec PASSED    [ 84%]
tests/services/test_service_catalog_coverage.py::test_templates PASSED   [ 84%]
tests/services/test_service_catalog_coverage.py::test_health_update PASSED [ 84%]
tests/services/test_service_catalog_coverage.py::test_dependency_graph PASSED [ 84%]
tests/services/test_service_catalog_coverage.py::test_metrics_summary PASSED [ 84%]
tests/services/test_service_catalog_coverage.py::test_singleton PASSED   [ 85%]
tests/services/test_serving_coverage.py::test_ab_test_engine PASSED      [ 85%]
tests/services/test_serving_coverage.py::test_ensemble_router PASSED     [ 85%]
tests/services/test_serving_coverage.py::test_model_invoker PASSED       [ 85%]
tests/services/test_serving_coverage.py::test_shadow_deployment_manager PASSED [ 85%]
tests/services/test_serving_coverage.py::test_metrics_collector PASSED   [ 85%]
tests/services/test_serving_coverage.py::test_model_registry PASSED      [ 85%]
tests/services/test_serving_coverage.py::test_inference_router PASSED    [ 85%]
tests/services/test_serving_coverage.py::test_in_memory_repos PASSED     [ 85%]
tests/services/test_serving_coverage.py::test_experiment_manager PASSED  [ 86%]
tests/services/test_smart_chunker_whitespace.py::test_chunk_text_preserves_newlines PASSED [ 86%]
tests/services/test_smart_chunker_whitespace.py::test_chunk_text_preserves_indentation PASSED [ 86%]
tests/services/test_system_service.py::test_check_database_status_healthy PASSED [ 86%]
tests/services/test_system_service.py::test_check_database_status_unhealthy PASSED [ 86%]
tests/services/test_system_service.py::test_is_database_connected_true PASSED [ 86%]
tests/services/test_system_service.py::test_is_database_connected_false PASSED [ 86%]
tests/services/test_system_service_refactor.py::test_verify_system_integrity_healthy PASSED [ 86%]
tests/services/test_system_service_refactor.py::test_verify_system_integrity_db_down PASSED [ 86%]
tests/services/test_user_service_coverage.py::test_get_all_users PASSED  [ 87%]
tests/services/test_user_service_coverage.py::test_create_new_user_success PASSED [ 87%]
tests/services/test_user_service_coverage.py::test_create_new_user_duplicate_email PASSED [ 87%]
tests/services/test_user_service_coverage.py::test_create_new_user_exception PASSED [ 87%]
tests/services/test_user_service_coverage.py::test_ensure_admin_user_exists_create_new PASSED [ 87%]
tests/services/test_user_service_coverage.py::test_ensure_admin_user_exists_already_admin PASSED [ 87%]
tests/services/test_user_service_coverage.py::test_ensure_admin_user_exists_promote_user PASSED [ 87%]
tests/services/test_user_service_coverage.py::test_ensure_admin_user_missing_env PASSED [ 87%]
tests/services/admin/test_admin_chat_refactor.py::test_admin_chat_refactor_structure PASSED [ 87%]
tests/services/admin/test_admin_chat_refactor.py::test_admin_chat_persistence_delegation PASSED [ 88%]
tests/services/agent_tools/test_domain_tools.py::test_count_files_handler_git PASSED [ 88%]
tests/services/agent_tools/test_domain_tools.py::test_count_files_handler_fallback PASSED [ 88%]
tests/services/agent_tools/test_domain_tools.py::test_get_project_metrics_handler PASSED [ 88%]
tests/services/agent_tools/test_domain_tools.py::test_context_awareness_handler PASSED [ 88%]
tests/services/agent_tools/test_domain_tools.py::test_tool_classes PASSED [ 88%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestEnsureDirectory::test_ensure_new_directory PASSED [ 88%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestEnsureDirectory::test_ensure_existing_directory PASSED [ 88%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestEnsureDirectory::test_ensure_directory_fails_if_file_exists PASSED [ 88%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestEnsureDirectory::test_ensure_directory_must_be_new PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestWriteFile::test_write_file_simple PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestWriteFile::test_write_file_not_string PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestWriteFile::test_write_file_json_compression PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestWriteFile::test_write_file_too_large PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestWriteFile::test_write_file_create_parents PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestWriteFileIfChanged::test_write_new_file PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestWriteFileIfChanged::test_skip_unchanged_file PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestWriteFileIfChanged::test_overwrite_changed_file PASSED [ 89%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestAppendFile::test_append_existing_file PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestAppendFile::test_append_new_file PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestAppendFile::test_append_not_string PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestAppendFile::test_append_total_limit PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadFile::test_read_simple_file PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadFile::test_read_missing_file_ignore PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadFile::test_read_missing_file_error PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadFile::test_read_directory_error PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadFile::test_read_gzip_file PASSED [ 90%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadFile::test_read_truncated PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestDeleteFile::test_delete_file_success PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestDeleteFile::test_delete_no_confirm PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestDeleteFile::test_delete_missing_file PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestDeleteFile::test_delete_directory PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestEnsureFile::test_ensure_file_exists_returns_content PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestEnsureFile::test_ensure_file_creates_if_missing PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestEnsureFile::test_ensure_file_enforce_ext PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestEnsureFile::test_ensure_file_not_allow_create PASSED [ 91%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadBulkFiles::test_read_bulk_json_mode PASSED [ 92%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadBulkFiles::test_read_bulk_concat_mode PASSED [ 92%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadBulkFiles::test_read_bulk_ignore_missing PASSED [ 92%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestReadBulkFiles::test_read_bulk_error_missing PASSED [ 92%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestMetaTools::test_file_exists PASSED [ 92%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestMetaTools::test_list_dir PASSED [ 92%]
tests/services/agent_tools/test_fs_tools_comprehensive.py::TestMetaTools::test_list_dir_not_dir PASSED [ 92%]
tests/services/overmind/test_overmind_coverage_gap.py::test_overmind_orchestrator_run_mission_success PASSED [ 92%]
tests/services/overmind/test_overmind_coverage_gap.py::test_overmind_orchestrator_run_mission_not_found PASSED [ 92%]
tests/services/overmind/test_overmind_coverage_gap.py::test_overmind_orchestrator_run_mission_failure PASSED [ 92%]
tests/services/overmind/test_overmind_coverage_gap.py::test_overmind_factory_assembly PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestDottedNameStrategy::test_write_suffix PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestDottedNameStrategy::test_read_suffix PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestDottedNameStrategy::test_unknown_suffix PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestDottedNameStrategy::test_disabled_dotted PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestAliasStrategy::test_write_alias PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestAliasStrategy::test_read_alias PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestAliasStrategy::test_custom_aliases PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestAliasStrategy::test_case_insensitive PASSED [ 93%]
tests/services/overmind/test_tool_canonicalizer.py::TestDirectMatchStrategy::test_ensure_file PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestDirectMatchStrategy::test_append_file PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestDirectMatchStrategy::test_non_canonical PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestKeywordStrategy::test_write_keyword PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestKeywordStrategy::test_read_keyword PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestKeywordStrategy::test_multiple_keywords PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestDescriptionIntentStrategy::test_write_intent_from_description PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestDescriptionIntentStrategy::test_read_intent_from_description PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestDescriptionIntentStrategy::test_no_intent_without_description PASSED [ 94%]
tests/services/overmind/test_tool_canonicalizer.py::TestDescriptionIntentStrategy::test_disabled_intent_check PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestToolCanonicalizer::test_strategy_chain_priority PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestToolCanonicalizer::test_fallback_to_original PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestToolCanonicalizer::test_add_custom_strategy PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestToolCanonicalizer::test_remove_strategy PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestToolCanonicalizer::test_empty_strategies PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestBackwardCompatibility::test_canonicalize_tool_name_function PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestBackwardCompatibility::test_returns_tuple PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestComplexityReduction::test_each_strategy_simple PASSED [ 95%]
tests/services/overmind/test_tool_canonicalizer.py::TestComplexityReduction::test_main_canonicalizer_simple PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[str_replace_editor--write_file] PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[file.read--read_file] PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[create_new_document--write_file] PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[load_config_file--read_file] PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[ensure_file--ensure_file] PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[append_file--append_file] PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[file-creates a new file-write_file] PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[unknown-reads the contents-read_file] PASSED [ 96%]
tests/services/overmind/test_tool_canonicalizer.py::TestRealWorldScenarios::test_real_world_cases[completely_random_tool--completely_random_tool] PASSED [ 97%]
tests/smoke/test_api_smoke.py::test_health_check PASSED                  [ 97%]
tests/smoke/test_database_service_smoke.py::test_database_health_check PASSED [ 97%]
tests/smoke/test_service_integration.py::test_system_health_endpoint_healthy_integration PASSED [ 97%]
tests/smoke/test_startup.py::test_health_check PASSED                    [ 97%]
tests/smoke/test_startup.py::test_root PASSED                            [ 97%]
tests/smoke/test_startup.py::test_openapi_docs PASSED                    [ 97%]
tests/smoke/test_startup.py::test_api_health_v1 PASSED                   [ 97%]
tests/transcendent_v2/test_history_service_post_migration.py::test_rate_message_success PASSED [ 97%]
tests/transcendent_v2/test_history_service_post_migration.py::test_rate_message_permission_denied PASSED [ 98%]
tests/transcendent_v2/test_history_service_post_migration.py::test_get_recent_conversations_success PASSED [ 98%]
tests/transcendent_v2/test_history_service_post_migration.py::test_get_recent_conversations_returns_empty_on_error PASSED [ 98%]
tests/unit/test_enum_case_sensitivity.py::TestMessageRoleEnum::test_lowercase_lookup PASSED [ 98%]
tests/unit/test_enum_case_sensitivity.py::TestMessageRoleEnum::test_uppercase_lookup PASSED [ 98%]
tests/unit/test_enum_case_sensitivity.py::TestMessageRoleEnum::test_mixed_case_lookup PASSED [ 98%]
tests/unit/test_enum_case_sensitivity.py::TestMessageRoleEnum::test_all_roles PASSED [ 98%]
tests/unit/test_enum_case_sensitivity.py::TestMissionStatusEnum::test_all_statuses PASSED [ 98%]
tests/unit/test_enum_case_sensitivity.py::TestTaskStatusEnum::test_all_statuses PASSED [ 98%]
tests/unit/test_enum_case_sensitivity.py::TestDatabaseIntegration::test_create_and_read_admin_message PASSED [ 99%]
tests/unit/test_enum_case_sensitivity.py::TestDatabaseIntegration::test_simulate_supabase_uppercase PASSED [ 99%]
tests/unit/test_log_mission_event_double_encoding_bug.py::test_log_mission_event_payload_not_double_encoded PASSED [ 99%]
tests/unit/test_log_mission_event_double_encoding_bug.py::test_mission_event_payload_json_round_trip PASSED [ 99%]
tests/unit/test_orchestrator_unit.py::test_process_passes_session_factory PASSED [ 99%]
tests/unit/test_strategy_pattern_fix.py::test_strategy_registry_async_generator PASSED [ 99%]
tests/unit/test_strategy_pattern_fix.py::test_strategy_registry_coroutine PASSED [ 99%]
tests/unit/services/test_database_service.py::test_create_and_get_record PASSED [ 99%]
tests/unit/services/overmind/test_super_brain.py::test_super_brain_loop_success PASSED [ 99%]
tests/unit/services/overmind/test_super_brain.py::test_super_brain_self_correction PASSED [100%]

==================================== ERRORS ====================================
___________________ ERROR at setup of test_user_set_password ___________________

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f2338b64800>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
_______________________ ERROR at setup of test_user_repr _______________________

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f2338b229c0>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
_ ERROR at setup of TestHistoryServiceComprehensive.test_get_recent_conversations_success _

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f23347991f0>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
_ ERROR at setup of TestHistoryServiceComprehensive.test_get_recent_conversations_limit _

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f233471ab70>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
_ ERROR at setup of TestHistoryServiceComprehensive.test_rate_message_success __

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f233819d850>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
_ ERROR at setup of TestHistoryServiceComprehensive.test_rate_message_not_found _

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f23347186b0>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
_ ERROR at setup of TestHistoryServiceComprehensive.test_rate_message_security_violation _

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f2334703350>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
_ ERROR at setup of TestHistoryServiceComprehensive.test_rate_message_db_error _

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f233479ba70>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
_ ERROR at setup of TestHistoryServiceComprehensive.test_rate_message_unexpected_error _

db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f23347344d0>

    @pytest.fixture
    def user_factory(db_session: AsyncSession):
>       class AsyncUserFactory(UserFactory):

tests/conftest.py:217:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:80: in __new__
    meta.contribute_to_class(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:208: in contribute_to_class
    self._fill_from_meta(meta=meta, base_meta=base_meta)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <FactoryOptions for AsyncUserFactory>
meta = <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory.Meta'>
base_meta = <FactoryOptions for UserFactory>

    def _fill_from_meta(self, meta, base_meta):
        # Exclude private/protected fields from the meta
        if meta is None:
            meta_attrs = {}
        else:
            meta_attrs = {
                k: v
                for (k, v) in vars(meta).items()
                if not k.startswith('_')
            }

        for option in self._build_default_options():
            assert not hasattr(self, option.name), "Can't override field %s." % option.name
            value = option.apply(meta, base_meta)
            meta_attrs.pop(option.name, None)
            setattr(self, option.name, value)

        if meta_attrs:
            # Some attributes in the Meta aren't allowed here
>           raise TypeError(
                "'class Meta' for %r got unknown attribute(s) %s"
                % (self.factory, ','.join(sorted(meta_attrs.keys()))))
E           TypeError: 'class Meta' for <class 'tests.conftest.user_factory.<locals>.AsyncUserFactory'> got unknown attribute(s) sqlalchemy_session,sqlalchemy_session_persistence

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/factory/base.py:199: TypeError
=================================== FAILURES ===================================
____________________ test_dev_frame_middleware_development _____________________

    def test_dev_frame_middleware_development():
        """Verify that in development mode, security headers are relaxed to allow framing."""
        with mock.patch.dict(os.environ, {"ENVIRONMENT": "development"}, clear=True):
            app = Starlette(middleware=[Middleware(RemoveBlockingHeadersMiddleware)])

            @app.route("/")
            async def homepage(request):
                return Response(
                    "ok",
                    headers={
                        "X-Frame-Options": "DENY",
                        "Content-Security-Policy": "default-src 'self'; frame-ancestors 'none'",
                    },
                )

            client = TestClient(app)
            response = client.get("/")

            # Assertions
>           assert "x-frame-options" not in response.headers
E           assert 'x-frame-options' not in Headers({'x-frame-options': 'DENY', 'content-security-policy': "default-src 'self'; frame-ancestors 'none'", 'content-length': '2'})
E            +  where Headers({'x-frame-options': 'DENY', 'content-security-policy': "default-src 'self'; frame-ancestors 'none'", 'content-length': '2'}) = <Response [200 OK]>.headers

tests/test_middleware_frame.py:31: AssertionError
________________________ test_middleware_enabled_in_dev ________________________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f2338beadb0>

    def test_middleware_enabled_in_dev(monkeypatch):
        """Verify middleware identifies development environment correctly."""
        monkeypatch.setenv("ENVIRONMENT", "development")
        middleware = RemoveBlockingHeadersMiddleware(None)
>       assert middleware.enabled is True
E       AttributeError: 'RemoveBlockingHeadersMiddleware' object has no attribute 'enabled'

tests/test_preview_headers.py:11: AttributeError
____________________ test_middleware_enabled_in_codespaces _____________________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f2338beb650>

    def test_middleware_enabled_in_codespaces(monkeypatch):
        """Verify middleware identifies Codespaces environment correctly."""
        monkeypatch.setenv("CODESPACE_NAME", "my-codespace")
        middleware = RemoveBlockingHeadersMiddleware(None)
>       assert middleware.enabled is True
E       AttributeError: 'RemoveBlockingHeadersMiddleware' object has no attribute 'enabled'

tests/test_preview_headers.py:18: AttributeError
____________________ test_middleware_disabled_in_production ____________________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f2338be94c0>

    def test_middleware_disabled_in_production(monkeypatch):
        """Verify middleware is disabled in production."""
        monkeypatch.setenv("ENVIRONMENT", "production")
        monkeypatch.delenv("CODESPACE_NAME", raising=False)
        monkeypatch.delenv("CODESPACES", raising=False)
        middleware = RemoveBlockingHeadersMiddleware(None)
>       assert middleware.enabled is False
E       AttributeError: 'RemoveBlockingHeadersMiddleware' object has no attribute 'enabled'

tests/test_preview_headers.py:27: AttributeError
______________________ test_headers_removed_in_dev_client ______________________

monkeypatch = <_pytest.monkeypatch.MonkeyPatch object at 0x7f2338be87a0>

    def test_headers_removed_in_dev_client(monkeypatch):
        """
        Integration-like test using TestClient.
        """
        monkeypatch.setenv("ENVIRONMENT", "development")

        async def simple_app(scope, receive, send):
            await send(
                {
                    "type": "http.response.start",
                    "status": 200,
                    "headers": [
                        (b"content-type", b"text/plain"),
                        (b"x-frame-options", b"DENY"),
                        (b"content-security-policy", b"default-src 'self'; frame-ancestors 'none';"),
                    ],
                }
            )
            await send({"type": "http.response.body", "body": b"ok"})

        middleware = RemoveBlockingHeadersMiddleware(simple_app)

        client = TestClient(middleware)
        response = client.get("/")

        assert response.status_code == 200
        # X-Frame-Options should be gone
>       assert "x-frame-options" not in response.headers
E       assert 'x-frame-options' not in Headers({'content-type': 'text/plain', 'x-frame-options': 'DENY', 'content-security-policy': "default-src 'self'; frame-ancestors 'none';"})
E        +  where Headers({'content-type': 'text/plain', 'x-frame-options': 'DENY', 'content-security-policy': "default-src 'self'; frame-ancestors 'none';"}) = <Response [200 OK]>.headers

tests/test_preview_headers.py:57: AssertionError
____________________ test_chat_stream_has_delta_event_type _____________________

client = <starlette.testclient.TestClient object at 0x7f23377d2390>
test_app = <fastapi.applications.FastAPI object at 0x7f233ac6fd10>

    @pytest.mark.asyncio
    async def test_chat_stream_has_delta_event_type(client, test_app):
        """
        Verifies that the chat_stream endpoint correctly yields 'event: delta' events
        for content chunks, ensuring proper SSE streaming compatibility with the frontend.
        """

        # 1. Define Mocks
        mock_ai_client = MagicMock()
        mock_db_session = AsyncMock()
        # FIX: Explicitly set synchronous methods as MagicMock to prevent RuntimeWarnings
        # "coroutine 'AsyncMockMixin._execute_mock_call' was never awaited"
        mock_db_session.add = MagicMock()
        mock_db_session.refresh = (
            AsyncMock()
        )  # refresh is awaited in admin.py: await db.refresh(conversation)

        # Let's verify admin.py again.
        # line 128: db.add(conversation) -> sync
        # line 130: await db.refresh(conversation) -> async

        # Mock database execution results
        mock_result = MagicMock()
        mock_result.scalars.return_value.all.return_value = []
        mock_result.scalar_one_or_none.return_value = None  # No existing conversation
        mock_db_session.execute.return_value = mock_result

        # Mock AI response generator
        async def mock_stream_chat(messages):
            # We simulate the structure returned by many AI providers
            yield {"choices": [{"delta": {"content": "Hello"}}]}
            yield {"choices": [{"delta": {"content": " World"}}]}

        mock_ai_client.stream_chat.side_effect = mock_stream_chat

        # 2. Define Overrides
        def override_get_ai_client():
            return mock_ai_client

        async def override_get_db():
            yield mock_db_session

        def override_get_current_user_id():
            # Bypass auth validation entirely
            return 1

        def override_get_session_factory():
            # The endpoint uses session_factory() context manager
            # We need to return a factory that produces our mock_db_session
            mock_factory = MagicMock()
            mock_factory.return_value.__aenter__.return_value = mock_db_session
            mock_factory.return_value.__aexit__.return_value = None
            return mock_factory

        # 3. Apply Overrides Safely
        # Use patch.dict to modify the dependency_overrides dictionary in place,
        # and automatically restore it to its previous state (containing conftest.py overrides) upon exit.
        overrides = {
            get_ai_client: override_get_ai_client,
            get_db: override_get_db,
            get_current_user_id: override_get_current_user_id,
            get_session_factory: override_get_session_factory,
        }

        with patch.dict(test_app.dependency_overrides, overrides):
            # 4. Make Request
            response = client.post(
                "/admin/api/chat/stream",
                json={"question": "Test question"},
                headers={"Authorization": "Bearer test-token"},
            )

            # 5. Assertions
            assert response.status_code == 200, f"Response failed with: {response.text}"

            # Analyze stream content
            content = response.content.decode("utf-8")
            lines = content.split("\n\n")

            has_delta_event = False

            for line in lines:
                if not line.strip():
                    continue

                # Check if this block has "event: delta" with content
                if "data: " in line and "Hello" in line and "event: delta" in line:
                    has_delta_event = True

            # After the fix, we expect 'event: delta' events for content chunks
>           assert has_delta_event, "Expected 'event: delta' for content chunks (fix verified)"
E           AssertionError: Expected 'event: delta' for content chunks (fix verified)
E           assert False

tests/test_streaming_event_type_bug.py:103: AssertionError
_________________________ test_create_mission_endpoint _________________________
  + Exception Group Traceback (most recent call last):
  |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_utils.py", line 85, in collapse_excgroups
  |     yield
  |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 190, in __call__
  |     async with anyio.create_task_group() as task_group:
  |                ^^^^^^^^^^^^^^^^^^^^^^^^^
  |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/anyio/_backends/_asyncio.py", line 783, in __aexit__
  |     raise BaseExceptionGroup(
  | ExceptionGroup: unhandled errors in a TaskGroup (1 sub-exception)
  +-+---------------- 1 ----------------
    | Traceback (most recent call last):
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/_pytest/runner.py", line 341, in from_call
    |     result: Optional[TResult] = func()
    |                                 ^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/_pytest/runner.py", line 262, in <lambda>
    |     lambda: ihook(item=item, **kwds), when=when, reraise=reraise
    |             ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/_pytest/runner.py", line 177, in pytest_runtest_call
    |     raise e
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/_pytest/runner.py", line 169, in pytest_runtest_call
    |     item.runtest()
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/_pytest/python.py", line 1792, in runtest
    |     self.ihook.pytest_pyfunc_call(pyfuncitem=self)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_hooks.py", line 512, in __call__
    |     return self._hookexec(self.name, self._hookimpls.copy(), kwargs, firstresult)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_manager.py", line 120, in _hookexec
    |     return self._inner_hookexec(hook_name, methods, kwargs, firstresult)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 167, in _multicall
    |     raise exception
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 139, in _multicall
    |     teardown.throw(exception)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 53, in run_old_style_hookwrapper
    |     return result.get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_result.py", line 103, in get_result
    |     raise exc.with_traceback(tb)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 38, in run_old_style_hookwrapper
    |     res = yield
    |           ^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pluggy/_callers.py", line 121, in _multicall
    |     res = hook_impl.function(*args)
    |           ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/_pytest/python.py", line 194, in pytest_pyfunc_call
    |     result = testfunction(**testargs)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/pytest_asyncio/plugin.py", line 532, in inner
    |     _loop.run_until_complete(task)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/asyncio/base_events.py", line 691, in run_until_complete
    |     return future.result()
    |            ^^^^^^^^^^^^^^^
    |   File "/app/tests/api/test_overmind_router.py", line 32, in test_create_mission_endpoint
    |     response = await client.post("/api/v1/overmind/missions", json=payload)
    |                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py", line 593, in post
    |     return super().post(
    |            ^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py", line 1146, in post
    |     return self.request(
    |            ^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py", line 468, in request
    |     return super().request(
    |            ^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py", line 828, in request
    |     return self.send(request, auth=auth, follow_redirects=follow_redirects)
    |            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py", line 915, in send
    |     response = self._send_handling_auth(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py", line 943, in _send_handling_auth
    |     response = self._send_handling_redirects(
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py", line 980, in _send_handling_redirects
    |     response = self._send_single_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py", line 1016, in _send_single_request
    |     response = transport.handle_request(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py", line 344, in handle_request
    |     raise exc
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py", line 341, in handle_request
    |     portal.call(self.app, scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/anyio/from_thread.py", line 326, in call
    |     return cast(T_Retval, self.start_task_soon(func, *args).result())
    |                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/concurrent/futures/_base.py", line 449, in result
    |     return self.__get_result()
    |            ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/concurrent/futures/_base.py", line 401, in __get_result
    |     raise self._exception
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/anyio/from_thread.py", line 257, in _call_func
    |     retval = await retval_or_awaitable
    |              ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    |     await super().__call__(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/applications.py", line 123, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/errors.py", line 186, in __call__
    |     raise exc
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/errors.py", line 164, in __call__
    |     await self.app(scope, receive, _send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 24, in __call__
    |     await responder(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/gzip.py", line 44, in __call__
    |     await self.app(scope, receive, self.send_with_gzip)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          ^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
    |     raise exc
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/app/app/middleware/remove_blocking_headers.py", line 38, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 189, in __call__
    |     with collapse_excgroups():
    |          ^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/contextlib.py", line 158, in __exit__
    |     self.gen.throw(value)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_utils.py", line 91, in collapse_excgroups
    |     raise exc
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 191, in __call__
    |     response = await self.dispatch_func(request, call_next)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/app/app/middleware/core/base_middleware.py", line 151, in dispatch
    |     raise e
    |   File "/app/app/middleware/core/base_middleware.py", line 130, in dispatch
    |     response = await call_next(request)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 165, in call_next
    |     raise app_exc
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py", line 151, in coro
    |     await self.app(scope, receive_or_disconnect, send_no_error)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/cors.py", line 83, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/trustedhost.py", line 34, in __call__
    |     await self.app(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    |     await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py", line 762, in __call__
    |     await self.middleware_stack(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py", line 782, in app
    |     await route.handle(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py", line 297, in handle
    |     await self.app(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py", line 77, in app
    |     await wrap_app_handling_exceptions(app, request)(scope, receive, send)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    |     raise exc
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    |     await app(scope, receive, sender)
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py", line 72, in app
    |     response = await func(request)
    |                ^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/routing.py", line 285, in app
    |     raise e
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/routing.py", line 275, in app
    |     solved_result = await solve_dependencies(
    |                     ^^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/dependencies/utils.py", line 598, in solve_dependencies
    |     solved = await call(**sub_values)
    |              ^^^^^^^^^^^^^^^^^^^^^^^^
    |   File "/app/app/api/routers/overmind.py", line 52, in get_orchestrator
    |     return await create_overmind(db)
    |                  ^^^^^^^^^^^^^^^^^^^
    |   File "/app/app/services/overmind/factory.py", line 28, in create_overmind
    |     executor = TaskExecutor(state_manager)
    |                ^^^^^^^^^^^^^^^^^^^^^^^^^^^
    | TypeError: TaskExecutor() takes no arguments
    +------------------------------------

During handling of the above exception, another exception occurred:

client = <starlette.testclient.TestClient object at 0x7f233760ad80>
db_session = <sqlalchemy.orm.session.AsyncSession object at 0x7f2337663830>

    @pytest.mark.asyncio
    async def test_create_mission_endpoint(client: AsyncClient, db_session):
        """
        Test creating a mission via the API.
        """
        # Override dependency logic handled by framework or manual patch if needed
        # Here we assume the client + app setup works.

        # Mocking orchestrator creation if complex, but better to test integration if possible
        # We will rely on the real stack but mock the LLM part usually.
        # For now, let's verify the endpoint structure.

        payload = {
            "objective": "Build a Dyson Sphere",
            "context": {"radius": "1AU"},
            "priority": 1
        }

        # We need to authenticate usually (admin only?), but let's check open endpoint
        # or ensure we have admin headers if required.
        # Assuming open or mocked auth for this specific test scope.

        # Note: If security middleware is active, we might need headers.
>       response = await client.post("/api/v1/overmind/missions", json=payload)

tests/api/test_overmind_router.py:32:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py:593: in post
    return super().post(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:1146: in post
    return self.request(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py:468: in request
    return super().request(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:828: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:915: in send
    response = self._send_handling_auth(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:943: in _send_handling_auth
    response = self._send_handling_redirects(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:980: in _send_handling_redirects
    response = self._send_single_request(request)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:1016: in _send_single_request
    response = transport.handle_request(request)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py:344: in handle_request
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py:341: in handle_request
    portal.call(self.app, scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/anyio/from_thread.py:326: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/concurrent/futures/_base.py:449: in result
    return self.__get_result()
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/anyio/from_thread.py:257: in _call_func
    retval = await retval_or_awaitable
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/applications.py:123: in __call__
    await self.middleware_stack(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/gzip.py:24: in __call__
    await responder(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/gzip.py:44: in __call__
    await self.app(scope, receive, self.send_with_gzip)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:189: in __call__
    with collapse_excgroups():
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/contextlib.py:158: in __exit__
    self.gen.throw(value)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_utils.py:91: in collapse_excgroups
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:191: in __call__
    response = await self.dispatch_func(request, call_next)
app/middleware/remove_blocking_headers.py:38: in dispatch
    response = await call_next(request)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:165: in call_next
    raise app_exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:151: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:189: in __call__
    with collapse_excgroups():
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/contextlib.py:158: in __exit__
    self.gen.throw(value)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_utils.py:91: in collapse_excgroups
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:191: in __call__
    response = await self.dispatch_func(request, call_next)
app/middleware/core/base_middleware.py:151: in dispatch
    raise e
app/middleware/core/base_middleware.py:130: in dispatch
    response = await call_next(request)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:165: in call_next
    raise app_exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:151: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/cors.py:83: in __call__
    await self.app(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/trustedhost.py:34: in __call__
    await self.app(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/exceptions.py:62: in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_exception_handler.py:64: in wrapped_app
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    await app(scope, receive, sender)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py:762: in __call__
    await self.middleware_stack(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py:782: in app
    await route.handle(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py:297: in handle
    await self.app(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py:77: in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_exception_handler.py:64: in wrapped_app
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_exception_handler.py:53: in wrapped_app
    await app(scope, receive, sender)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/routing.py:72: in app
    response = await func(request)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/routing.py:285: in app
    raise e
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/routing.py:275: in app
    solved_result = await solve_dependencies(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/dependencies/utils.py:598: in solve_dependencies
    solved = await call(**sub_values)
app/api/routers/overmind.py:52: in get_orchestrator
    return await create_overmind(db)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

db = <sqlalchemy.orm.session.AsyncSession object at 0x7f233760bd40>

    def create_overmind(db: AsyncSession) -> OvermindOrchestrator:
        """
        Factory to assemble the Overmind with the Council of Wisdom.
        """
        state_manager = MissionStateManager(db)

        # Tools & Executors
        registry = get_registry()
        # Note: TaskExecutor might need updates to accept registry if not already
>       executor = TaskExecutor(state_manager)
E       TypeError: TaskExecutor() takes no arguments

app/services/overmind/factory.py:28: TypeError
________________________ test_stream_endpoint_structure ________________________

self = <sqlalchemy.engine.base.Connection object at 0x7f23377ea4b0>
dialect = <sqlalchemy.dialects.sqlite.aiosqlite.SQLiteDialect_aiosqlite object at 0x7f233cffa960>
context = <sqlalchemy.dialects.sqlite.aiosqlite.SQLiteExecutionContext_aiosqlite object at 0x7f23377e8050>
statement = <sqlalchemy.dialects.sqlite.base.SQLiteCompiler object at 0x7f23377eaa20>
parameters = [(1,)]

    def _exec_single_context(
        self,
        dialect: Dialect,
        context: ExecutionContext,
        statement: Union[str, Compiled],
        parameters: Optional[_AnyMultiExecuteParams],
    ) -> CursorResult[Any]:
        """continue the _execute_context() method for a single DBAPI
        cursor.execute() or cursor.executemany() call.

        """
        if dialect.bind_typing is BindTyping.SETINPUTSIZES:
            generic_setinputsizes = context._prepare_set_input_sizes()

            if generic_setinputsizes:
                try:
                    dialect.do_set_input_sizes(
                        context.cursor, generic_setinputsizes, context
                    )
                except BaseException as e:
                    self._handle_dbapi_exception(
                        e, str(statement), parameters, None, context
                    )

        cursor, str_statement, parameters = (
            context.cursor,
            context.statement,
            context.parameters,
        )

        effective_parameters: Optional[_AnyExecuteParams]

        if not context.executemany:
            effective_parameters = parameters[0]
        else:
            effective_parameters = parameters

        if self._has_events or self.engine._has_events:
            for fn in self.dispatch.before_cursor_execute:
                str_statement, effective_parameters = fn(
                    self,
                    cursor,
                    str_statement,
                    effective_parameters,
                    context,
                    context.executemany,
                )

        if self._echo:
            self._log_info(str_statement)

            stats = context._get_cache_stats()

            if not self.engine.hide_parameters:
                self._log_info(
                    "[%s] %r",
                    stats,
                    sql_util._repr_params(
                        effective_parameters,
                        batches=10,
                        ismulti=context.executemany,
                    ),
                )
            else:
                self._log_info(
                    "[%s] [SQL parameters hidden due to hide_parameters=True]",
                    stats,
                )

        evt_handled: bool = False
        try:
            if context.execute_style is ExecuteStyle.EXECUTEMANY:
                effective_parameters = cast(
                    "_CoreMultiExecuteParams", effective_parameters
                )
                if self.dialect._has_events:
                    for fn in self.dialect.dispatch.do_executemany:
                        if fn(
                            cursor,
                            str_statement,
                            effective_parameters,
                            context,
                        ):
                            evt_handled = True
                            break
                if not evt_handled:
                    self.dialect.do_executemany(
                        cursor,
                        str_statement,
                        effective_parameters,
                        context,
                    )
            elif not effective_parameters and context.no_parameters:
                if self.dialect._has_events:
                    for fn in self.dialect.dispatch.do_execute_no_params:
                        if fn(cursor, str_statement, context):
                            evt_handled = True
                            break
                if not evt_handled:
                    self.dialect.do_execute_no_params(
                        cursor, str_statement, context
                    )
            else:
                effective_parameters = cast(
                    "_CoreSingleExecuteParams", effective_parameters
                )
                if self.dialect._has_events:
                    for fn in self.dialect.dispatch.do_execute:
                        if fn(
                            cursor,
                            str_statement,
                            effective_parameters,
                            context,
                        ):
                            evt_handled = True
                            break
                if not evt_handled:
>                   self.dialect.do_execute(
                        cursor, str_statement, effective_parameters, context
                    )

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1969:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py:922: in do_execute
    cursor.execute(statement, parameters)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py:146: in execute
    self._adapt_connection._handle_exception(error)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py:298: in _handle_exception
    raise error
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py:128: in execute
    self.await_(_cursor.execute(operation, parameters))
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:130: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:195: in greenlet_spawn
    value = await result
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/aiosqlite/cursor.py:37: in execute
    await self._execute(self._cursor.execute, sql, parameters)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/aiosqlite/cursor.py:31: in _execute
    return await self._conn._execute(fn, *args, **kwargs)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/aiosqlite/core.py:129: in _execute
    return await future
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Connection(Thread-62, started daemon 139789103793856)>

    def run(self) -> None:
        """
        Execute function calls on a separate thread.

        :meta private:
        """
        while True:
            # Continues running until all queue items are processed,
            # even after connection is closed (so we can finalize all
            # futures)
            try:
                future, function = self._tx.get(timeout=0.1)
            except Empty:
                if self._running:
                    continue
                break
            try:
                LOG.debug("executing %s", function)
>               result = function()
E               sqlite3.OperationalError: no such table: missions

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/aiosqlite/core.py:102: OperationalError

The above exception was the direct cause of the following exception:

client = <starlette.testclient.TestClient object at 0x7f23376001d0>

    @pytest.mark.asyncio
    async def test_stream_endpoint_structure(client: AsyncClient):
        """
        Test that the streaming endpoint exists.
        """
>       response = await client.get("/api/v1/overmind/missions/1/stream")

tests/api/test_overmind_router.py:51:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py:502: in get
    return super().get(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:1055: in get
    return self.request(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py:468: in request
    return super().request(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:828: in request
    return self.send(request, auth=auth, follow_redirects=follow_redirects)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:915: in send
    response = self._send_handling_auth(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:943: in _send_handling_auth
    response = self._send_handling_redirects(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:980: in _send_handling_redirects
    response = self._send_single_request(request)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/httpx/_client.py:1016: in _send_single_request
    response = transport.handle_request(request)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py:344: in handle_request
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/testclient.py:341: in handle_request
    portal.call(self.app, scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/anyio/from_thread.py:326: in call
    return cast(T_Retval, self.start_task_soon(func, *args).result())
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/concurrent/futures/_base.py:456: in result
    return self.__get_result()
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/concurrent/futures/_base.py:401: in __get_result
    raise self._exception
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/anyio/from_thread.py:257: in _call_func
    retval = await retval_or_awaitable
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/fastapi/applications.py:1054: in __call__
    await super().__call__(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/applications.py:123: in __call__
    await self.middleware_stack(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/errors.py:186: in __call__
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/errors.py:164: in __call__
    await self.app(scope, receive, _send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/gzip.py:24: in __call__
    await responder(scope, receive, send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/gzip.py:44: in __call__
    await self.app(scope, receive, self.send_with_gzip)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:189: in __call__
    with collapse_excgroups():
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/contextlib.py:158: in __exit__
    self.gen.throw(value)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_utils.py:91: in collapse_excgroups
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/responses.py:257: in wrap
    await func()
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:217: in stream_response
    return await super().stream_response(send)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/responses.py:246: in stream_response
    async for chunk in self.body_iterator:
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:181: in body_stream
    raise app_exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:151: in coro
    await self.app(scope, receive_or_disconnect, send_no_error)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:189: in __call__
    with collapse_excgroups():
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/contextlib.py:158: in __exit__
    self.gen.throw(value)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/_utils.py:91: in collapse_excgroups
    raise exc
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/responses.py:257: in wrap
    await func()
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/responses.py:246: in stream_response
    async for chunk in self.body_iterator:
app/api/routers/overmind.py:139: in event_generator
    result = await session.execute(select(Mission).where(Mission.id == mission_id))
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/ext/asyncio/session.py:455: in execute
    result = await greenlet_spawn(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:200: in greenlet_spawn
    result = context.throw(*sys.exc_info())
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/orm/session.py:2308: in execute
    return self._execute_internal(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/orm/session.py:2190: in _execute_internal
    result: Result[Any] = compile_state_cls.orm_execute_statement(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/orm/context.py:293: in orm_execute_statement
    result = conn.execute(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1416: in execute
    return meth(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/sql/elements.py:517: in _execute_on_connection
    return connection._execute_clauseelement(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1639: in _execute_clauseelement
    ret = self._execute_context(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1848: in _execute_context
    return self._exec_single_context(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1988: in _exec_single_context
    self._handle_dbapi_exception(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py:2344: in _handle_dbapi_exception
    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/base.py:1969: in _exec_single_context
    self.dialect.do_execute(
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/engine/default.py:922: in do_execute
    cursor.execute(statement, parameters)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py:146: in execute
    self._adapt_connection._handle_exception(error)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py:298: in _handle_exception
    raise error
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/dialects/sqlite/aiosqlite.py:128: in execute
    self.await_(_cursor.execute(operation, parameters))
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:130: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/sqlalchemy/util/_concurrency_py3k.py:195: in greenlet_spawn
    value = await result
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/aiosqlite/cursor.py:37: in execute
    await self._execute(self._cursor.execute, sql, parameters)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/aiosqlite/cursor.py:31: in _execute
    return await self._conn._execute(fn, *args, **kwargs)
/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/aiosqlite/core.py:129: in _execute
    return await future
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <Connection(Thread-62, started daemon 139789103793856)>

    def run(self) -> None:
        """
        Execute function calls on a separate thread.

        :meta private:
        """
        while True:
            # Continues running until all queue items are processed,
            # even after connection is closed (so we can finalize all
            # futures)
            try:
                future, function = self._tx.get(timeout=0.1)
            except Empty:
                if self._running:
                    continue
                break
            try:
                LOG.debug("executing %s", function)
>               result = function()
E               sqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: missions
E               [SQL: SELECT missions.id, missions.objective, missions.status, missions.initiator_id, missions.active_plan_id, missions.created_at, missions.updated_at
E               FROM missions
E               WHERE missions.id = ?]
E               [parameters: (1,)]
E               (Background on this error at: https://sqlalche.me/e/20/e3q8)

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/aiosqlite/core.py:102: OperationalError
__________________ test_get_or_create_conversation_invalid_id __________________

service = <app.services.boundaries.admin_chat_boundary_service.AdminChatBoundaryService object at 0x7f2334740710>

    @pytest.mark.asyncio
    async def test_get_or_create_conversation_invalid_id(service):
        with pytest.raises(HTTPException) as exc:
            await service.get_or_create_conversation(user_id=1, question="Q", conversation_id="invalid")

>       assert exc.value.status_code == 404
E       AssertionError: assert 400 == 404
E        +  where 400 = HTTPException(status_code=400, detail='Invalid conversation ID format').status_code
E        +    where HTTPException(status_code=400, detail='Invalid conversation ID format') = <ExceptionInfo HTTPException(status_code=400, detail='Invalid conversation ID format') tblen=2>.value

tests/services/test_admin_chat_boundary_service_comprehensive.py:148: AssertionError
___ TestAdminChatBoundaryService.test_get_or_create_conversation_delegation ____

self = <test_admin_chat_boundary_service_final.TestAdminChatBoundaryService object at 0x7f233af3eff0>
service = <app.services.boundaries.admin_chat_boundary_service.AdminChatBoundaryService object at 0x7f23375ad1c0>

    @pytest.mark.asyncio
    async def test_get_or_create_conversation_delegation(self, service):
        service.persistence.get_or_create_conversation = AsyncMock(return_value="conv")
        result = await service.get_or_create_conversation(1, "Q", "123")
        assert result == "conv"
>       service.persistence.get_or_create_conversation.assert_called_with(1, "Q", "123")

tests/services/test_admin_chat_boundary_service_final.py:85:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <AsyncMock name='AdminChatPersistence().get_or_create_conversation' id='139789180570704'>
args = (1, 'Q', '123'), kwargs = {}, expected = call(1, 'Q', '123')
actual = call(1, 'Q', 123)
_error_message = <function NonCallableMock.assert_called_with.<locals>._error_message at 0x7f2338180cc0>
cause = None

    def assert_called_with(self, /, *args, **kwargs):
        """assert that the last call was made with the specified arguments.

        Raises an AssertionError if the args and keyword args passed in are
        different to the last call to the mock."""
        if self.call_args is None:
            expected = self._format_mock_call_signature(args, kwargs)
            actual = 'not called.'
            error_message = ('expected call not found.\nExpected: %s\n  Actual: %s'
                    % (expected, actual))
            raise AssertionError(error_message)

        def _error_message():
            msg = self._format_mock_failure_message(args, kwargs)
            return msg
        expected = self._call_matcher(_Call((args, kwargs), two=True))
        actual = self._call_matcher(self.call_args)
        if actual != expected:
            cause = expected if isinstance(expected, Exception) else None
>           raise AssertionError(_error_message()) from cause
E           AssertionError: expected call not found.
E           Expected: get_or_create_conversation(1, 'Q', '123')
E             Actual: get_or_create_conversation(1, 'Q', 123)

/home/jules/.pyenv/versions/3.12.12/lib/python3.12/unittest/mock.py:949: AssertionError
=============================== warnings summary ===============================
tests/test_api_crud.py::TestHealthEndpoints::test_database_stats
  /home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/middleware/base.py:110: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-3, started daemon 139789191874240)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
    async def call_next(request: Request) -> Response:

tests/test_api_crud.py::TestHealthEndpoints::test_database_tables
  /home/jules/.pyenv/versions/3.12.12/lib/python3.12/typing.py:392: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-6, started daemon 139789282051776)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
    @functools.wraps(func)

tests/test_api_crud.py::TestCRUDOperations::test_create_user
  <string>:8: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-8, started daemon 139789271566016)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.

tests/test_flexible_enum_crash.py::test_flexible_enum_resilience
  /app/tests/test_flexible_enum_crash.py:35: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-23, started daemon 139789261080256)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
    session.commit()

tests/test_system_healthz_bug.py::test_healthz_endpoint_failure
  /home/jules/.pyenv/versions/3.12.12/lib/python3.12/asyncio/locks.py:199: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-41, started daemon 139789240108736)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
    async def wait(self):

tests/integration/test_admin_chat_api.py::TestAdminChatAPI::test_admin_chat_unauthorized
  /home/jules/.pyenv/versions/3.12.12/lib/python3.12/asyncio/events.py:36: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-62, started daemon 139789103793856)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
    def __init__(self, callback, args, loop, context=None):

tests/smoke/test_service_integration.py::test_system_health_endpoint_healthy_integration
  /home/jules/.pyenv/versions/3.12.12/lib/python3.12/asyncio/selector_events.py:59: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-74, started daemon 139789093308096)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
    def __init__(self, selector=None):

tests/smoke/test_startup.py::test_root
  /home/jules/.pyenv/versions/3.12.12/lib/python3.12/site-packages/starlette/datastructures.py:415: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-84, started daemon 139788891981504)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
    parse_qsl(value.decode("latin-1"), keep_blank_values=True), **kwargs

tests/transcendent_v2/test_history_service_post_migration.py::test_rate_message_success
  /home/jules/.pyenv/versions/3.12.12/lib/python3.12/unittest/mock.py:2217: SAWarning: The garbage collector is trying to clean up non-checked-in connection <AdaptedConnection <Connection(Thread-89, started daemon 139789061850816)>>, which will be dropped, as it cannot be safely terminated.  Please ensure that SQLAlchemy pooled connections are returned to the pool explicitly, either by calling ``close()`` or by using appropriate context managers to manage their lifecycle.
    def __init__(self, name, parent):

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html

---------- coverage: platform linux, python 3.12.12-final-0 ----------
Name                                                                       Stmts   Miss  Cover   Missing
--------------------------------------------------------------------------------------------------------
app/__init__.py                                                                1      0   100%
app/ai/__init__.py                                                             1      0   100%
app/ai/application/__init__.py                                                 0      0   100%
app/ai/application/circuit_breaker.py                                        183     24    87%   50-52, 57, 153-154, 158, 163-165, 178, 183, 190, 293-296, 300, 304, 308, 313-315, 324
app/ai/application/cost_manager.py                                           220    220     0%   17-509
app/ai/application/payload_builder.py                                         11      0   100%
app/ai/application/response_normalizer.py                                     58      9    84%   29-30, 56-60, 121-122
app/ai/application/retry_strategy.py                                         197    197     0%   15-402
app/ai/domain/__init__.py                                                      2      2     0%   13-26
app/ai/domain/models.py                                                      127    127     0%   11-226
app/ai/domain/ports/__init__.py                                               37     37     0%   10-437
app/ai/facade.py                                                             128    128     0%   22-325
app/ai/infrastructure/__init__.py                                              4      4     0%   13-36
app/ai/infrastructure/cache.py                                               146    146     0%   13-332
app/ai/infrastructure/metrics.py                                             159    159     0%   11-277
app/ai/infrastructure/transports/__init__.py                                  70     70     0%   8-178
app/ai/infrastructure/transports/anthropic_transport.py                       71     71     0%   15-221
app/ai/infrastructure/transports/openai_transport.py                          41     41     0%   14-158
app/ai/observability/__init__.py                                             158    158     0%   14-277
app/ai/optimization/__init__.py                                              181    181     0%   13-343
app/analysis/__init__.py                                                       5      0   100%
app/analysis/anomaly_detector.py                                             181     10    94%   265, 293, 335, 376, 383, 389-407
app/analysis/pattern_recognizer.py                                           131      6    95%   136-137, 227, 234, 248, 271
app/analysis/predictor.py                                                    105     73    30%   44, 66-70, 80-110, 115-142, 146-158, 163-176, 180-182
app/analysis/root_cause.py                                                    86     50    42%   45, 69-73, 79, 86-87, 93-102, 107-117, 122-140, 146-159, 163-167, 171-173
app/analytics/__init__.py                                                     10     10     0%   7-79
app/analytics/ab_test_manager.py                                              70     70     0%   3-118
app/analytics/anomaly_detection.py                                            50     50     0%   3-92
app/analytics/behavior_analysis.py                                            62     62     0%   3-107
app/analytics/custom_report_generators.py                                     54     54     0%   6-120
app/analytics/entities.py                                                     55     55     0%   3-78
app/analytics/enums.py                                                        25     25     0%   3-39
app/analytics/event_tracker.py                                                51     51     0%   3-146
app/analytics/in_memory_repository.py                                         27     27     0%   3-46
app/analytics/in_memory_stores.py                                            144    144     0%   3-206
app/analytics/interfaces.py                                                   16     16     0%   3-44
app/analytics/metrics_calculator.py                                           76     76     0%   3-169
app/analytics/ml_anomaly_detection.py                                         43     43     0%   6-106
app/analytics/models.py                                                      213    213     0%   3-350
app/analytics/nps_manager.py                                                  26     26     0%   3-60
app/analytics/ports.py                                                        31     31     0%   3-115
app/analytics/report_generation.py                                            34     34     0%   3-67
app/analytics/service.py                                                     126    126     0%   3-323
app/analytics/session_manager.py                                              25     25     0%   3-55
app/analytics/user_segmentation.py                                            23     23     0%   3-38
app/analytics/value_objects.py                                                18     18     0%   3-32
app/api/routers/admin.py                                                      38      4    89%   88, 121-123
app/api/routers/crud.py                                                       26      3    88%   39, 85, 97
app/api/routers/data_mesh.py                                                  12      0   100%
app/api/routers/observability.py                                              26      6    77%   27, 47, 57, 67, 78, 88
app/api/routers/overmind.py                                                   56     25    55%   78-93, 104-107, 140-163
app/api/routers/security.py                                                   54      7    87%   56, 96-98, 107-109
app/api/routers/system/__init__.py                                            22      8    64%   39-42, 66-70, 86-87
app/api/v2/__init__.py                                                         2      0   100%
app/api/v2/dependencies.py                                                    13      5    62%   9, 18, 23, 28, 33
app/api/v2/endpoints/__init__.py                                               0      0   100%
app/api/v2/endpoints/chat.py                                                  33     18    45%   39-53, 75-99
app/api/v2/endpoints/health.py                                                15      4    73%   23-25, 44, 54
app/api/v2/endpoints/tools.py                                                 29     15    48%   30-52, 70-72, 95
app/api/v2/router.py                                                           8      5    38%   16-22
app/api/v2/schemas.py                                                         41      1    98%   26
app/api_docs.py                                                                7      7     0%   2-28
app/application/__init__.py                                                    3      0   100%
app/application/interfaces.py                                                 11      0   100%
app/application/services.py                                                   38     15    61%   33-34, 57-58, 68, 72-75, 83-87, 94-95
app/application/use_cases/planning/refactored_planner.py                     123     13    89%   39, 42, 48, 103-104, 116, 122, 141, 144, 188, 268, 280-281
app/application/use_cases/routing/routing_strategies.py                      117     47    60%   48, 57, 63, 71-73, 76, 84-93, 96, 105, 109, 117-118, 122-128, 131, 138-139, 143-149, 154-159, 163, 180, 186
app/boundaries/__init__.py                                                     6      0   100%
app/boundaries/data/core.py                                                   41      9    78%   30, 51, 65-66, 70-74
app/boundaries/data/database.py                                               54     22    59%   29, 34, 39, 44, 73, 77-86, 90-95, 99-103
app/boundaries/data/events.py                                                 56      7    88%   38, 43, 48, 70, 110-112
app/boundaries/data/saga.py                                                   74      2    97%   121-122
app/boundaries/data_boundaries.py                                              6      0   100%
app/boundaries/policy/__init__.py                                              7      0   100%
app/boundaries/policy/auth.py                                                 29      6    79%   30-32, 58, 63, 68
app/boundaries/policy/compliance.py                                           44      2    95%   80-81
app/boundaries/policy/engine.py                                              120     41    66%   113-116, 133, 137, 145, 162, 175, 189-205, 218-250
app/boundaries/policy/governance.py                                           32      1    97%   65
app/boundaries/policy/layers.py                                               87     10    89%   29, 38, 50, 67, 82, 100, 108, 154-157
app/boundaries/policy/main.py                                                 27      0   100%
app/boundaries/policy_boundaries.py                                            2      0   100%
app/boundaries/service_boundaries.py                                         214     42    80%   54-57, 62, 67, 119, 125, 149-150, 165-168, 228-230, 238, 241-244, 302-306, 310-311, 318-324, 331-333, 340-343, 377
app/cli.py                                                                    20      2    90%   20, 45
app/cli_handlers/db_cli.py                                                    70     17    76%   50-51, 54-55, 71-79, 97-102
app/cli_handlers/maintenance_cli.py                                           10      3    70%   10, 15-16
app/cli_handlers/migrate_cli.py                                               16      8    50%   13-20
app/config/__init__.py                                                         0      0   100%
app/config/ai_models.py                                                       91     27    70%   136, 157-181, 196-207
app/config/dependencies.py                                                     4      4     0%   3-20
app/config/settings.py                                                        91      6    93%   157, 174, 209-210, 223, 226
app/core/__init__.py                                                           0      0   100%
app/core/ai_client_factory.py                                                173     44    75%   91-98, 115-116, 120-123, 135-156, 166-189, 202-206, 224, 249, 271-273, 284, 394
app/core/ai_gateway.py                                                        15      2    87%   56, 64
app/core/base_profiler.py                                                     86      2    98%   45, 212
app/core/cli_logging.py                                                       10     10     0%   3-15
app/core/cognitive_cache.py                                                   78     12    85%   82, 98, 113, 122, 133-134, 137-142, 153, 165
app/core/common_imports.py                                                    76     22    71%   27-28, 33-34, 38-39, 44-48, 53-57, 62-66, 91
app/core/database.py                                                          18      0   100%
app/core/db_legacy.py                                                         41     41     0%   11-87
app/core/db_schema.py                                                         70     41    41%   73, 88-98, 104-124, 127-132, 135, 137, 146-159
app/core/di.py                                                                29      5    83%   53-58
app/core/engine/__init__.py                                                    0      0   100%
app/core/engine/diagnostics.py                                                 5      0   100%
app/core/engine/exceptions.py                                                  2      0   100%
app/core/engine/factory.py                                                   114     29    75%   61-64, 102-138
app/core/engine/naming.py                                                     25      0   100%
app/core/engine/pooler.py                                                     32      6    81%   90-91, 95-96, 99-100
app/core/engine/types.py                                                      18      0   100%
app/core/engine/url_tools.py                                                  62      7    89%   102-110, 144, 148
app/core/engine_factory.py                                                     8      0   100%
app/core/error_handling.py                                                   111     12    89%   59-60, 62, 108, 115, 120, 148, 184, 186, 289-291
app/core/error_messages.py                                                    40     40     0%   2-234
app/core/factories.py                                                         11      1    91%   50
app/core/gateway/circuit_breaker.py                                           51     18    65%   36-38, 54, 57, 64-65, 70-71, 80-93
app/core/gateway/connection.py                                                16      2    88%   33-34
app/core/gateway/exceptions.py                                                 6      0   100%
app/core/gateway/mesh.py                                                     194     47    76%   52, 125, 146, 151, 169, 190, 200-203, 207, 235, 246-249, 255-259, 302-306, 313-332, 335, 342, 357-360
app/core/gateway/node.py                                                      11      0   100%
app/core/http_client_factory.py                                               79     79     0%   29-236
app/core/interfaces/__init__.py                                                8      0   100%
app/core/interfaces/base.py                                                   33      8    76%   19, 24, 40, 46, 51, 66, 72, 77
app/core/interfaces/data.py                                                   22      5    77%   24, 29, 34, 46, 58
app/core/interfaces/planner_interface.py                                       9      0   100%
app/core/interfaces/processing.py                                             22      5    77%   24, 36, 41, 53, 58
app/core/interfaces/repository_interface.py                                   14      0   100%
app/core/interfaces/service_interface.py                                       9      0   100%
app/core/interfaces/strategy_interface.py                                     11      0   100%
app/core/logging/__init__.py                                                   1      0   100%
app/core/logging/spine.py                                                      9      2    78%   9, 21
app/core/math/cognitive_fingerprint.py                                        33      0   100%
app/core/math/hyper_flux.py                                                   23     10    57%   52-68
app/core/math/kalman.py                                                       26      0   100%
app/core/math/omni_router.py                                                 111     17    85%   71-74, 80-93, 100, 181-182, 248-253
app/core/patterns/__init__.py                                                  5      0   100%
app/core/patterns/builder.py                                                  15      3    80%   22, 27, 35
app/core/patterns/chain.py                                                    37     21    43%   18, 22-23, 27-33, 38, 43, 50-51, 55-61, 65-67
app/core/patterns/command.py                                                  53     26    51%   30-32, 37, 41, 45, 49, 56, 60, 65-80, 85-92, 101
app/core/patterns/strategy.py                                                 39      6    85%   21, 26, 50, 62, 66, 71
app/core/prompts.py                                                           52     31    40%   39, 55-81, 86-107, 132-135
app/core/protocols.py                                                         25      0   100%
app/core/rate_limiter.py                                                      71     71     0%   9-138
app/core/registry/__init__.py                                                  4      4     0%   9-13
app/core/registry/plugin_discovery.py                                         33     33     0%   10-64
app/core/registry/plugin_loader.py                                            31     31     0%   10-56
app/core/registry/plugin_registry.py                                          38     38     0%   11-89
app/core/resilience/__init__.py                                                2      2     0%   16-28
app/core/resilience/bulkhead.py                                               27     27     0%   5-63
app/core/resilience/circuit_breaker.py                                       172    172     0%   32-389
app/core/resilience/composite.py                                              43     43     0%   5-103
app/core/resilience/fallback.py                                               16     16     0%   5-42
app/core/resilience/retry.py                                                  37     37     0%   5-82
app/core/resilience/timeout.py                                                18     18     0%   5-46
app/core/scaling/__init__.py                                                   4      0   100%
app/core/scaling/health_checker.py                                            48      8    83%   64-65, 72-76, 85, 94
app/core/scaling/load_balancer.py                                             73     48    34%   23, 30-31, 36-41, 50-52, 61-72, 79-80, 85-97, 101-103, 116-117, 125-131
app/core/scaling/service_registry.py                                          58     25    57%   27, 45-49, 56-62, 67-72, 79-83, 91-92
app/core/security.py                                                          15      4    73%   13-15, 59
app/core/self_healing_db.py                                                  233     69    70%   25, 94, 164, 170, 173, 176, 179, 202-204, 226-230, 243-255, 259-275, 279-295, 305, 327, 336-339, 343-344
app/core/startup.py                                                            0      0   100%
app/core/static_handler.py                                                    32      5    84%   25-28, 52, 58, 69
app/core/superhuman_performance_optimizer.py                                 134     37    72%   68-70, 75-77, 81-83, 87, 122-135, 149-151, 159, 223, 227, 235, 249, 253-256, 264, 282
app/core/time.py                                                               0      0   100%
app/core/yaml_utils.py                                                        19      1    95%   35
app/domain/repositories.py                                                     9      0   100%
app/infrastructure/config/__init__.py                                          2      0   100%
app/infrastructure/config/env_reader.py                                       15      0   100%
app/infrastructure/patterns/__init__.py                                        5      0   100%
app/infrastructure/patterns/chain_of_responsibility.py                       115     25    78%   73-75, 91-93, 99-101, 121-123, 140-141, 144-145, 168-169, 173-180, 184
app/infrastructure/patterns/circuit_breaker.py                                70     15    79%   51, 77-78, 88-90, 104-119
app/infrastructure/patterns/dependency_injection.py                           61     24    61%   24, 28, 40, 47-49, 61-67, 73-75, 83, 89-100
app/infrastructure/patterns/event_bus.py                                      58     15    74%   39-42, 50-51, 53-56, 60-63, 69
app/infrastructure/repositories/__init__.py                                    3      0   100%
app/infrastructure/repositories/database_repository.py                        11      3    73%   20-22
app/infrastructure/repositories/user_repository.py                            33     22    33%   18, 22-25, 29-32, 36-39, 43-49, 53-58
app/kernel.py                                                                 75      7    91%   152-158, 215-216
app/main.py                                                                   32      2    94%   84, 87
app/middleware/__init__.py                                                     0      0   100%
app/middleware/adapters/__init__.py                                            0      0   100%
app/middleware/ai/__init__.py                                                  2      2     0%   12-13
app/middleware/config/__init__.py                                              3      3     0%   11-14
app/middleware/config/middleware_settings.py                                  10     10     0%   11-55
app/middleware/core/__init__.py                                                9      0   100%
app/middleware/core/base_middleware.py                                        95     41    57%   80, 102, 111, 117-125, 171, 179, 186-189, 193-213, 220-223, 226-227, 230-231, 234-245
app/middleware/core/context.py                                                43      0   100%
app/middleware/core/hooks.py                                                  39      0   100%
app/middleware/core/pipeline.py                                              113      2    98%   158, 190
app/middleware/core/registry.py                                               48     30    38%   39-42, 54-61, 76-84, 96, 108, 112-114, 118, 122, 138, 153
app/middleware/core/response_factory.py                                       21     12    43%   26-27, 37-43, 51-54
app/middleware/core/result.py                                                 48      0   100%
app/middleware/cors/__init__.py                                                3      3     0%   11-14
app/middleware/cors/cors_middleware.py                                        15     15     0%   11-61
app/middleware/error_handling/__init__.py                                      5      5     0%   12-22
app/middleware/error_handling/exception_mapper.py                              6      6     0%   6-38
app/middleware/error_handling/recovery_middleware.py                          26     26     0%   11-94
app/middleware/error_response_factory.py                                      38     38     0%   19-165
app/middleware/factory/__init__.py                                             3      3     0%   11-14
app/middleware/factory/middleware_factory.py                                  20     20     0%   11-92
app/middleware/fastapi_error_handlers.py                                      14      1    93%   21
app/middleware/fastapi_observability.py                                       30     30     0%   2-109
app/middleware/observability/__init__.py                                       8      8     0%   21-37
app/middleware/observability/analytics_adapter.py                             33     33     0%   12-128
app/middleware/observability/anomaly_inspector.py                             32     32     0%   12-110
app/middleware/observability/observability_middleware.py                      52     52     0%   12-222
app/middleware/observability/performance_profiler.py                          50     50     0%   7-109
app/middleware/observability/request_logger.py                                28     28     0%   12-123
app/middleware/observability/telemetry_bridge.py                              47     47     0%   12-161
app/middleware/rate_limiter_middleware.py                                     74     74     0%   14-179
app/middleware/remove_blocking_headers.py                                     16      1    94%   43
app/middleware/security/__init__.py                                            9      0   100%
app/middleware/security/ai_threat_middleware.py                               33     23    30%   34-37, 49-95, 99-110
app/middleware/security/plugins/__init__.py                                    2      2     0%   12-13
app/middleware/security/policy_enforcer.py                                    56     43    23%   30-33, 45-56, 68-74, 88-108, 118, 122-127
app/middleware/security/rate_limit_middleware.py                              40     28    30%   36-38, 50-89, 102-111, 115-125
app/middleware/security/security_headers.py                                   36     12    67%   54, 66-81, 104-111
app/middleware/security/telemetry_guard.py                                    48     32    33%   30-35, 47-56, 66-75, 85-88, 92-94, 98-100, 112, 116-122
app/middleware/security/waf_middleware.py                                     28     18    36%   35-37, 49-74, 78-88
app/middleware/security/zero_trust_middleware.py                              33     22    33%   35-38, 51-86, 90-99
app/middleware/security_logger.py                                             22     22     0%   16-103
app/middleware/superhuman_security.py                                         14      4    71%   15-21
app/models.py                                                                230      5    98%   44, 76, 434-437
app/plugins/__init__.py                                                        0      0   100%
app/plugins/chat/__init__.py                                                   0      0   100%
app/plugins/database/__init__.py                                               0      0   100%
app/plugins/llm/__init__.py                                                    0      0   100%
app/schemas/management.py                                                     46      0   100%
app/security/__init__.py                                                       5      0   100%
app/security/chrono_shield.py                                                 70      6    91%   19, 23-25, 81-82
app/security/encryption.py                                                    54      1    98%   67
app/security/owasp_validator.py                                              138    138     0%   18-365
app/security/rate_limiter.py                                                  37     20    46%   23-34, 43-51, 68-89
app/security/secure_auth.py                                                   12      1    92%   17
app/security/threat_detector.py                                               12      3    75%   15, 21-22
app/security/waf.py                                                           25      7    72%   25-29, 38-39
app/security/zero_trust.py                                                    10      4    60%   11-17
app/security_metrics/__init__.py                                               3      3     0%   7-15
app/security_metrics/api/__init__.py                                           2      2     0%   3-8
app/security_metrics/api/security_metrics_facade.py                           50     50     0%   3-134
app/security_metrics/application/__init__.py                                   4      4     0%   3-7
app/security_metrics/application/developer_scoring.py                         27     27     0%   3-54
app/security_metrics/application/report_generation.py                         52     52     0%   3-102
app/security_metrics/application/risk_scoring.py                              41     41     0%   3-79
app/security_metrics/domain/__init__.py                                        4      4     0%   3-17
app/security_metrics/domain/entities.py                                       59     59     0%   3-82
app/security_metrics/domain/interfaces.py                                     17     17     0%   3-48
app/security_metrics/domain/value_objects.py                                  17     17     0%   3-31
app/security_metrics/infrastructure/__init__.py                                2      2     0%   3-5
app/security_metrics/infrastructure/in_memory_repository.py                   31     31     0%   3-52
app/services/__init__.py                                                       0      0   100%
app/services/adaptive/__init__.py                                              5      0   100%
app/services/adaptive/application/__init__.py                                  4      0   100%
app/services/adaptive/application/health_monitor.py                           79     14    82%   38, 44, 46, 55, 57, 59, 67-68, 93, 121, 135-136, 142-143
app/services/adaptive/application/intelligent_router.py                       48      2    96%   45, 119
app/services/adaptive/application/scaling_engine.py                           52      4    92%   41, 78-80
app/services/adaptive/domain/__init__.py                                       3      0   100%
app/services/adaptive/domain/models.py                                        53      1    98%   52
app/services/adaptive/domain/ports.py                                         13      0   100%
app/services/adaptive/facade.py                                              100     16    84%   77-79, 90, 95, 121, 164, 194, 203, 208-209, 237-241
app/services/adaptive/infrastructure/__init__.py                               2      0   100%
app/services/adaptive/infrastructure/in_memory_repository.py                  39     24    38%   19-20, 24-27, 31, 35-36, 40-46, 50-51, 58, 62-65, 71-72, 78-79
app/services/admin/__init__.py                                                 0      0   100%
app/services/admin/chat_persistence.py                                        62      7    89%   30, 39-42, 102, 114, 126
app/services/admin/chat_streamer.py                                           55      2    96%   74-75
app/services/admin_chat_performance/__init__.py                                2      2     0%   1-3
app/services/admin_chat_performance/application/__init__.py                    2      2     0%   1-3
app/services/admin_chat_performance/application/manager.py                     3      3     0%   6-10
app/services/admin_chat_performance/domain/__init__.py                         0      0   100%
app/services/admin_chat_performance/domain/models.py                           1      1     0%   5
app/services/admin_chat_performance/domain/ports.py                            0      0   100%
app/services/admin_chat_performance/facade.py                                  6      6     0%   5-17
app/services/admin_chat_performance/infrastructure/__init__.py                 2      2     0%   1-3
app/services/admin_chat_performance/infrastructure/repository.py               6      6     0%   5-14
app/services/admin_chat_performance_service.py                               111    111     0%   18-250
app/services/admin_chat_streaming/__init__.py                                  2      2     0%   1-3
app/services/admin_chat_streaming/application/__init__.py                      2      2     0%   1-3
app/services/admin_chat_streaming/application/manager.py                       3      3     0%   6-10
app/services/admin_chat_streaming/domain/__init__.py                           0      0   100%
app/services/admin_chat_streaming/domain/models.py                             1      1     0%   5
app/services/admin_chat_streaming/domain/ports.py                              0      0   100%
app/services/admin_chat_streaming/facade.py                                    6      6     0%   5-17
app/services/admin_chat_streaming/infrastructure/__init__.py                   2      2     0%   1-3
app/services/admin_chat_streaming/infrastructure/repository.py                 6      6     0%   5-14
app/services/advanced_streaming/__init__.py                                    2      2     0%   1-3
app/services/advanced_streaming/application/__init__.py                        2      2     0%   1-3
app/services/advanced_streaming/application/manager.py                         3      3     0%   6-10
app/services/advanced_streaming/domain/__init__.py                             0      0   100%
app/services/advanced_streaming/domain/models.py                               1      1     0%   5
app/services/advanced_streaming/domain/ports.py                                0      0   100%
app/services/advanced_streaming/facade.py                                      6      6     0%   5-17
app/services/advanced_streaming/infrastructure/__init__.py                     2      2     0%   1-3
app/services/advanced_streaming/infrastructure/repository.py                   6      6     0%   5-14
app/services/agent_tools/__init__.py                                          84     26    69%   97, 123, 126, 129, 136, 140, 144, 148, 152, 156, 160, 164, 168, 172, 176, 180, 184, 188, 192, 196, 200, 204, 208, 212, 216, 220
app/services/agent_tools/cognitive_tools.py                                   65     49    25%   45-102, 129-134, 152-159
app/services/agent_tools/core.py                                             165     47    72%   74, 92, 100-101, 105-106, 118-132, 136-141, 145, 149-152, 156-161, 178, 181, 225, 227, 240, 251, 348-366
app/services/agent_tools/definitions.py                                       70      5    93%   29-30, 39-40, 81
app/services/agent_tools/dispatch_tools.py                                    53     45    15%   51-90, 108-129
app/services/agent_tools/domain/context.py                                    16      0   100%
app/services/agent_tools/domain/metrics.py                                    48      3    94%   34, 59-60
app/services/agent_tools/fs_tools.py                                         277     57    79%   60-61, 86, 93, 107, 122, 125-126, 159, 166, 169-170, 187, 203, 206-207, 241, 254-255, 266, 281, 284-287, 309-310, 346-347, 378-379, 418, 423, 426-432, 448, 456, 470, 473-476, 514-515, 518-520, 530-534
app/services/agent_tools/globals.py                                           15      0   100%
app/services/agent_tools/memory_tools.py                                      25     17    32%   29-41, 52-55
app/services/agent_tools/refactored/__init__.py                                4      0   100%
app/services/agent_tools/refactored/builder.py                                38      6    84%   38-39, 53-54, 58-59
app/services/agent_tools/refactored/registry.py                               66     25    62%   39, 52-59, 69, 73-76, 80-84, 88-89, 95-98
app/services/agent_tools/refactored/tool.py                                   48     12    75%   28, 55, 63-72, 76
app/services/agent_tools/search_tools.py                                     111     99    11%   46-108, 135-209, 224-249
app/services/agent_tools/structural_logic.py                                  83     59    29%   25-33, 37-68, 74-79, 86-92, 100-101, 107-116
app/services/agent_tools/structural_tools.py                                  27     18    33%   22-40, 51-56
app/services/agent_tools/utils.py                                             93     39    58%   32, 37, 41, 51-60, 64, 68-79, 89-90, 108, 110, 113, 115, 118, 126, 129, 131, 136-138
app/services/ai_engineering/ai_adaptive_microservices.py                       3      0   100%
app/services/ai_engineering/ai_advanced_security.py                           12      4    67%   73-77
app/services/ai_engineering/ai_intelligent_testing.py                          6      0   100%
app/services/ai_engineering/aiops/models.py                                   87      0   100%
app/services/ai_engineering/aiops/ports.py                                     8      0   100%
app/services/ai_engineering/aiops/repositories.py                             50     17    66%   25-26, 29-30, 33, 40, 43, 46, 49, 56, 59, 66, 69, 72, 79, 82, 85
app/services/ai_engineering/aiops/service.py                                 182    135    26%   75-78, 82-86, 97-99, 107-134, 140-168, 172-174, 184-201, 205-229, 233-249, 259-286, 291-302, 312-335, 343-368, 372-380, 388-396, 414-424
app/services/ai_engineering/ensemble_ai.py                                   125      0   100%
app/services/ai_engineering/prompt_engineering_service.py                     21      0   100%
app/services/ai_project_management/__init__.py                                 2      2     0%   6-19
app/services/ai_project_management/application/__init__.py                     0      0   100%
app/services/ai_project_management/application/services.py                   131    131     0%   5-222
app/services/ai_project_management/domain/__init__.py                          0      0   100%
app/services/ai_project_management/domain/models.py                           68     68     0%   4-95
app/services/ai_project_management/facade.py                                   3      3     0%   5-13
app/services/ai_project_management/infrastructure/__init__.py                  0      0   100%
app/services/ai_security/__init__.py                                           3      0   100%
app/services/ai_security/application/__init__.py                               2      0   100%
app/services/ai_security/application/security_manager.py                      32      5    84%   78-85, 120
app/services/ai_security/domain/__init__.py                                    3      0   100%
app/services/ai_security/domain/models.py                                     63      2    97%   62, 97
app/services/ai_security/domain/ports.py                                      18      0   100%
app/services/ai_security/facade.py                                            23      4    83%   78, 92-94
app/services/ai_security/infrastructure/__init__.py                            4      0   100%
app/services/ai_security/infrastructure/detectors/__init__.py                  3      0   100%
app/services/ai_security/infrastructure/detectors/behavioral_analyzer.py      15      0   100%
app/services/ai_security/infrastructure/detectors/ml_threat_detector.py       37      4    89%   104-107
app/services/ai_security/infrastructure/repositories/__init__.py               2      0   100%
app/services/ai_security/infrastructure/repositories/in_memory_repos.py       22      3    86%   31, 35, 66
app/services/ai_security/infrastructure/responders/__init__.py                 2      0   100%
app/services/ai_security/infrastructure/responders/auto_responder.py          16      0   100%
app/services/ai_testing/__init__.py                                            0      0   100%
app/services/ai_testing/application/__init__.py                                0      0   100%
app/services/ai_testing/application/manager.py                                12      1    92%   20
app/services/ai_testing/domain/__init__.py                                     0      0   100%
app/services/ai_testing/domain/models.py                                      45      1    98%   49
app/services/ai_testing/generators/__init__.py                                 0      0   100%
app/services/ai_testing/generators/test_generator.py                         152     13    91%   55-56, 129, 146, 150, 154, 166, 168, 178, 227, 278, 330, 386
app/services/ai_testing/optimizers/__init__.py                                 0      0   100%
app/services/ai_testing/optimizers/coverage_optimizer.py                      31      1    97%   49
app/services/ai_testing/selectors/__init__.py                                  0      0   100%
app/services/ai_testing/selectors/smart_selector.py                           31      1    97%   32
app/services/api/api_config_secrets_service.py                                61     12    80%   71, 75, 108, 111, 115, 121, 129, 144-147, 149-150
app/services/api/api_contract_service.py                                       2      0   100%
app/services/api/api_security_service.py                                       5      0   100%
app/services/api_config_secrets/application/config_secrets_manager.py         87     23    74%   121, 138, 151-152, 166, 177, 190-192, 200-209, 236-251
app/services/api_config_secrets/domain/models.py                              64      0   100%
app/services/api_config_secrets/domain/ports.py                               32      0   100%
app/services/api_config_secrets/infrastructure/memory_adapters.py             45      6    87%   31-32, 49-50, 67, 70
app/services/api_config_secrets/infrastructure/vault_adapters.py              73     25    66%   20, 50, 59-63, 66-69, 73, 82-83, 86, 89, 92, 95, 98, 107, 110, 113, 116, 119, 122
app/services/async_tool_bridge.py                                            164    164     0%   20-380
app/services/auth_boundary/__init__.py                                         2      2     0%   1-3
app/services/auth_boundary/application/__init__.py                             2      2     0%   1-3
app/services/auth_boundary/application/manager.py                              3      3     0%   6-10
app/services/auth_boundary/domain/__init__.py                                  0      0   100%
app/services/auth_boundary/domain/models.py                                    1      1     0%   5
app/services/auth_boundary/domain/ports.py                                     0      0   100%
app/services/auth_boundary/facade.py                                           6      6     0%   5-17
app/services/auth_boundary/infrastructure/__init__.py                          2      2     0%   1-3
app/services/auth_boundary/infrastructure/repository.py                        6      6     0%   5-14
app/services/boundaries/admin_chat_boundary_service.py                       104     15    86%   113, 224-228, 246-255, 262-263
app/services/boundaries/auth_boundary_service.py                              65     27    58%   77-87, 119-152, 181, 188-191, 214, 218
app/services/boundaries/crud_boundary_service.py                              56     23    59%   66-79, 86-88, 94-96, 102-105, 111-112, 132, 144, 154-156, 165, 169
app/services/boundaries/observability_boundary_service.py                     22      5    77%   33, 49, 55, 61, 68
app/services/chat/__init__.py                                                 10      0   100%
app/services/chat/context.py                                                  19      1    95%   30
app/services/chat/context_service.py                                          15      0   100%
app/services/chat/handlers/__init__.py                                         0      0   100%
app/services/chat/handlers/base.py                                            19     19     0%   1-87
app/services/chat/handlers/file_handler.py                                    96     96     0%   1-134
app/services/chat/handlers/mission_handler.py                                163    163     0%   1-291
app/services/chat/handlers/search_handler.py                                  58     58     0%   1-83
app/services/chat/handlers/strategy_handlers.py                              179    110    39%   43-60, 64-65, 76-83, 94-109, 113-114, 125-130, 134-135, 146-150, 154, 179-237, 244-246, 250-266, 276-282, 304-305
app/services/chat/handlers/system_handler.py                                  65     65     0%   1-88
app/services/chat/intent_detector.py                                          41      7    83%   52-54, 58, 65, 69, 73
app/services/chat/orchestrator.py                                             30      0   100%
app/services/chat/security.py                                                 13      6    54%   15-18, 27-30
app/services/chat/telemetry.py                                                 1      0   100%
app/services/chat_orchestrator_service.py                                      5      5     0%   1-10
app/services/crud/__init__.py                                                  2      0   100%
app/services/crud/crud_persistence.py                                         49     26    47%   44, 48-52, 57, 60-74, 96-102, 108, 114-120, 126
app/services/crud_boundary/__init__.py                                         2      2     0%   1-3
app/services/crud_boundary/application/__init__.py                             2      2     0%   1-3
app/services/crud_boundary/application/manager.py                              3      3     0%   6-10
app/services/crud_boundary/domain/__init__.py                                  0      0   100%
app/services/crud_boundary/domain/models.py                                    1      1     0%   5
app/services/crud_boundary/domain/ports.py                                     0      0   100%
app/services/crud_boundary/facade.py                                           6      6     0%   5-17
app/services/crud_boundary/infrastructure/__init__.py                          2      2     0%   1-3
app/services/crud_boundary/infrastructure/repository.py                        6      6     0%   5-14
app/services/data_mesh/__init__.py                                             2      2     0%   1-16
app/services/data_mesh/application/__init__.py                                 2      2     0%   1-3
app/services/data_mesh/application/manager.py                                  3      3     0%   6-10
app/services/data_mesh/application/mesh_manager.py                           150    150     0%   1-318
app/services/data_mesh/domain/__init__.py                                      0      0   100%
app/services/data_mesh/domain/models.py                                      100    100     0%   1-140
app/services/data_mesh/domain/ports.py                                         0      0   100%
app/services/data_mesh/facade.py                                              77     77     0%   1-157
app/services/data_mesh/infrastructure/__init__.py                              2      2     0%   1-3
app/services/data_mesh/infrastructure/repository.py                            6      6     0%   5-14
app/services/data_mesh_service.py                                              6      0   100%
app/services/domain_events.py                                                229    229     0%   17-596
app/services/llm/circuit_breaker.py                                           34      0   100%
app/services/llm/cost_manager.py                                              65     11    83%   47-49, 52, 86, 99-110
app/services/llm/retry_strategy.py                                            70     12    83%   75, 88, 90, 94, 96, 99-102, 114, 117, 120, 148
app/services/llm_client/__init__.py                                            2      2     0%   1-3
app/services/llm_client/application/__init__.py                                2      2     0%   1-3
app/services/llm_client/application/manager.py                                 3      3     0%   6-10
app/services/llm_client/domain/__init__.py                                     0      0   100%
app/services/llm_client/domain/models.py                                       1      1     0%   5
app/services/llm_client/domain/ports.py                                        0      0   100%
app/services/llm_client/facade.py                                              6      6     0%   5-17
app/services/llm_client/infrastructure/__init__.py                             2      2     0%   1-3
app/services/llm_client/infrastructure/repository.py                           6      6     0%   5-14
app/services/llm_client_service.py                                           150      7    95%   99, 136, 208-209, 254-255, 319
app/services/master_agent/__init__.py                                          2      2     0%   1-3
app/services/master_agent/application/__init__.py                              2      2     0%   1-3
app/services/master_agent/application/manager.py                               3      3     0%   6-10
app/services/master_agent/domain/__init__.py                                   0      0   100%
app/services/master_agent/domain/models.py                                     1      1     0%   5
app/services/master_agent/domain/ports.py                                      0      0   100%
app/services/master_agent/facade.py                                            6      6     0%   5-17
app/services/master_agent/infrastructure/__init__.py                           2      2     0%   1-3
app/services/master_agent/infrastructure/repository.py                         6      6     0%   5-14
app/services/micro_frontends_service.py                                      102    102     0%   1-171
app/services/orchestration/__init__.py                                         2      0   100%
app/services/orchestration/application/__init__.py                             6      0   100%
app/services/orchestration/application/auto_scaler.py                         44     32    27%   31-33, 44-51, 55-83, 87-93, 99-100, 105-106
app/services/orchestration/application/node_manager.py                        23     11    52%   41, 46-51, 55, 59, 63-66
app/services/orchestration/application/pod_scheduler.py                       30      2    93%   61, 104
app/services/orchestration/application/raft_consensus.py                      72     54    25%   30-38, 42-47, 51-53, 57-67, 71-72, 76-77, 81-94, 98, 103-111, 115-130
app/services/orchestration/application/self_healer.py                         71     50    30%   66-69, 73-79, 83-89, 94-98, 103-109, 113-146, 150-197, 207-220, 224
app/services/orchestration/domain/__init__.py                                  2      0   100%
app/services/orchestration/domain/models.py                                   98      0   100%
app/services/orchestration/domain/ports.py                                     8      8     0%   8-53
app/services/orchestration/infrastructure/__init__.py                          2      2     0%   8-14
app/services/orchestration/infrastructure/in_memory_repository.py             58     58     0%   8-107
app/services/overmind/__init__.py                                              3      0   100%
app/services/overmind/agents/architect.py                                      8      2    75%   12, 18
app/services/overmind/agents/auditor.py                                       15      7    53%   33, 39-54
app/services/overmind/agents/operator.py                                      12      6    50%   12, 18-25
app/services/overmind/agents/strategist.py                                    31     21    32%   35, 43-98, 112-116
app/services/overmind/code_intelligence/__init__.py                            0      0   100%
app/services/overmind/code_intelligence/analyzers/__init__.py                  0      0   100%
app/services/overmind/code_intelligence/analyzers/complexity.py               57     57     0%   1-105
app/services/overmind/code_intelligence/analyzers/git.py                      33     33     0%   1-109
app/services/overmind/code_intelligence/analyzers/smells.py                   28     28     0%   2-60
app/services/overmind/code_intelligence/cli.py                                35     35     0%   1-69
app/services/overmind/code_intelligence/core.py                              133    133     0%   1-253
app/services/overmind/code_intelligence/models.py                             50     50     0%   1-76
app/services/overmind/code_intelligence/reporters/__init__.py                  0      0   100%
app/services/overmind/code_intelligence/reporters/csv_reporter.py             14     14     0%   1-37
app/services/overmind/code_intelligence/reporters/html_reporter.py            20     20     0%   1-288
app/services/overmind/code_intelligence/reporters/json_reporter.py             9      9     0%   1-13
app/services/overmind/code_intelligence/reporters/markdown_reporter.py        48     48     0%   1-92
app/services/overmind/domain/api_schemas.py                                   48      0   100%
app/services/overmind/domain/cognitive.py                                     61      4    93%   95, 149-151
app/services/overmind/domain/context.py                                        9      0   100%
app/services/overmind/executor.py                                             32     22    31%   19-20, 34-74
app/services/overmind/factory.py                                              22      0   100%
app/services/overmind/orchestrator.py                                         38      7    82%   70-78, 97
app/services/overmind/planning/__init__.py                                    55     27    51%   71-73, 80-84, 92, 96, 101-106, 112, 119-122, 136-138, 142-144
app/services/overmind/planning/_configs.py                                    18      0   100%
app/services/overmind/planning/_drift_detection.py                            34     18    47%   42-60
app/services/overmind/planning/_layer_detection.py                            18     18     0%   5-51
app/services/overmind/planning/_self_test_runner.py                           72     43    40%   42, 59-87, 114-115, 120-138, 164-166
app/services/overmind/planning/_structural_scoring.py                         48     30    38%   17, 32-41, 57-71, 76-78, 95-98, 115-119, 148-152
app/services/overmind/planning/_tag_detection.py                              13     13     0%   5-45
app/services/overmind/planning/base_planner.py                               263    168    36%   15-16, 62-63, 69, 77-79, 86-87, 119-123, 129-139, 142-147, 151-169, 173-182, 186, 190-208, 212, 218-253, 260-295, 305-337, 340-348, 352-367, 371, 375, 379
app/services/overmind/planning/config.py                                      58      1    98%   149
app/services/overmind/planning/deep_indexer.py                                22     22     0%   12-41
app/services/overmind/planning/dependency_grapher.py                          51     51     0%   9-70
app/services/overmind/planning/discovery.py                                   79     79     0%   5-128
app/services/overmind/planning/exceptions.py                                  78     46    41%   19-22, 40-74, 77, 109, 121-126, 133-140, 147-154, 167-173
app/services/overmind/planning/execution.py                                   42     30    29%   31-59, 68-71, 78-86
app/services/overmind/planning/factory.py                                    196    196     0%   37-589
app/services/overmind/planning/factory_core.py                               239    239     0%   6-560
app/services/overmind/planning/fault_tolerance.py                             38      4    89%   34-35, 57-58
app/services/overmind/planning/generators/__init__.py                          7      7     0%   11-18
app/services/overmind/planning/generators/context_enricher.py                 24     24     0%   8-92
app/services/overmind/planning/generators/dependency_builder.py               32     32     0%   4-56
app/services/overmind/planning/generators/objective_analyzer.py               58     58     0%   8-143
app/services/overmind/planning/generators/plan_generator.py                   27     27     0%   4-60
app/services/overmind/planning/generators/plan_optimizer.py                   15     15     0%   4-33
app/services/overmind/planning/generators/task_decomposer.py                  43     43     0%   4-100
app/services/overmind/planning/governance.py                                  21      1    95%   54
app/services/overmind/planning/llm_planner.py                                 12     12     0%   10-50
app/services/overmind/planning/multi_pass_arch_planner.py                    107    107     0%   121-584
app/services/overmind/planning/ranking.py                                     55     55     0%   11-246
app/services/overmind/planning/reliability.py                                 48     24    50%   38-47, 51-59, 66-69, 73-75
app/services/overmind/planning/sandbox.py                                     51     51     0%   11-167
app/services/overmind/planning/schemas.py                                    265    115    57%   136-137, 140, 240-243, 247-250, 254-256, 260-275, 279-281, 285-287, 339-393, 404-406, 413, 416-417, 420, 423, 426, 429, 432, 435-441, 444, 456-466, 486, 495-506, 517-536
app/services/overmind/planning/strategies/__init__.py                          2      0   100%
app/services/overmind/planning/strategies/base_strategy.py                     8      0   100%
app/services/overmind/planning/strategies/linear_strategy.py                  23     11    52%   26-27, 31-40, 43, 48
app/services/overmind/planning/strategies/recursive_strategy.py               23     23     0%   7-45
app/services/overmind/planning/telemetry.py                                   75     75     0%   5-166
app/services/overmind/planning/validators/__init__.py                         10     10     0%   9-19
app/services/overmind/planning/validators/basic_validator.py                  12     12     0%   9-40
app/services/overmind/planning/validators/depth_validator.py                  13     13     0%   9-41
app/services/overmind/planning/validators/fanout_validator.py                 12     12     0%   9-40
app/services/overmind/planning/validators/graph_builder.py                    48     48     0%   8-119
app/services/overmind/planning/validators/hash_computer.py                    14     14     0%   9-75
app/services/overmind/planning/validators/heuristic_validator.py              51     51     0%   9-153
app/services/overmind/planning/validators/orchestrator.py                     57     57     0%   11-137
app/services/overmind/planning/validators/stats_computer.py                   38     38     0%   9-107
app/services/overmind/planning/validators/topology_validator.py               36     36     0%   9-97
app/services/overmind/state.py                                                83     64    23%   27, 40-49, 52-61, 66-79, 84-91, 102-154, 157-159, 162-168, 171-180, 183-189
app/services/overmind/tool_canonicalizer.py                                  130      3    98%   121, 176, 212
app/services/project_context/__init__.py                                       8      3    62%   29, 33-34
app/services/project_context/application/__init__.py                           2      0   100%
app/services/project_context/application/context_analyzer.py                 282     33    88%   77-78, 90-91, 108-109, 169, 182, 186, 208, 217, 227-228, 247, 306-307, 422, 438, 462-473, 488, 496, 521, 532-535, 558, 562, 612-613
app/services/project_context/domain/__init__.py                                2      0   100%
app/services/project_context/domain/models.py                                 42      0   100%
app/services/project_context/refactored/__init__.py                            4      0   100%
app/services/project_context/refactored/context.py                            15      0   100%
app/services/project_context/refactored/pipeline.py                           15      0   100%
app/services/project_context/refactored/steps.py                              41      9    78%   36, 40-43, 57, 62-63, 89
app/services/saga_orchestrator.py                                            197     10    95%   268-273, 343, 354, 396-397
app/services/security/__init__.py                                              2      0   100%
app/services/security/auth_persistence.py                                     25      4    84%   34, 55-57, 64
app/services/security_metrics/__init__.py                                      3      0   100%
app/services/security_metrics/application/__init__.py                          4      0   100%
app/services/security_metrics/application/metrics_calculator.py               43      0   100%
app/services/security_metrics/application/predictive_analytics.py             32      1    97%   72
app/services/security_metrics/application/risk_calculator.py                  41      1    98%   52
app/services/security_metrics/domain/__init__.py                               3      0   100%
app/services/security_metrics/domain/models.py                                63      0   100%
app/services/security_metrics/domain/ports.py                                 29      5    83%   20, 25, 36, 47, 58
app/services/security_metrics/facade.py                                       33      0   100%
app/services/security_metrics/infrastructure/__init__.py                       2      0   100%
app/services/security_metrics/infrastructure/in_memory_repositories.py        32      2    94%   32, 35
app/services/serving/__init__.py                                               7      0   100%
app/services/serving/application/__init__.py                                   0      0   100%
app/services/serving/application/ab_test_engine.py                            40      1    98%   60
app/services/serving/application/ensemble_router.py                           31      0   100%
app/services/serving/application/experiment_manager.py                        78      9    88%   149, 154, 214-219, 226-227
app/services/serving/application/inference_router.py                          32      2    94%   103, 134
app/services/serving/application/model_invoker.py                             37      0   100%
app/services/serving/application/model_registry.py                            73     15    79%   175-181, 193-201
app/services/serving/application/shadow_deployment.py                         29      0   100%
app/services/serving/domain/__init__.py                                        0      0   100%
app/services/serving/domain/models.py                                        110      0   100%
app/services/serving/domain/ports.py                                          20     20     0%   10-140
app/services/serving/infrastructure/__init__.py                                0      0   100%
app/services/serving/infrastructure/in_memory_repository.py                   58      1    98%   56
app/services/serving/infrastructure/metrics_collector.py                      22      0   100%
app/services/serving/infrastructure/mock_model_invoker.py                     41      9    78%   66, 83-84, 116, 134-152
app/services/serving/observability/__init__.py                                 0      0   100%
app/services/streaming/admin_chat_streaming_service.py                       130      5    96%   84, 171, 256, 333, 339
app/services/streaming/breakthrough_streaming.py                              61     17    72%   29-44, 48, 74-75, 81, 97
app/services/system/database_service.py                                       44     15    66%   33-35, 38, 43, 46, 57, 63, 68, 71, 74-78
app/services/system/duplication_buster.py                                     39      7    82%   61-67
app/services/system/project_context_service.py                                 3      0   100%
app/services/system/service_catalog_service.py                               131      0   100%
app/services/system/system_service.py                                         28      0   100%
app/services/users/history_service.py                                         43      8    81%   80, 97, 105-110
app/services/users/user_service.py                                            75     11    85%   162-167, 179-182, 192-194
app/telemetry/__init__.py                                                     43     14    67%   50-51, 54-55, 58-59, 62-63, 66-67, 74, 77, 80, 94
app/telemetry/events.py                                                       64     32    50%   44, 64-68, 77-95, 99-104, 109-110, 114, 118
app/telemetry/metrics.py                                                      61      3    95%   53, 72, 78
app/telemetry/models.py                                                      116      5    96%   40, 44, 62-63, 102
app/telemetry/performance.py                                                  89     44    51%   52, 90-94, 100-109, 113, 118-127, 131-139, 146-157, 162
app/telemetry/structured_logging.py                                           23      0   100%
app/telemetry/tracing.py                                                      94      4    96%   76-77, 88, 96
app/telemetry/unified_observability.py                                       202     28    86%   58, 62, 66, 84, 96, 100, 121, 125, 140, 148, 165, 198, 200, 297-305, 312-320, 327-339, 342-347
app/utils/__init__.py                                                          4      0   100%
app/utils/model_registry.py                                                   30     17    43%   46-62, 67, 73, 78, 83, 88, 93
app/utils/service_locator.py                                                  48     24    50%   44, 50, 52, 54, 57-69, 74-79, 84, 97, 103, 108, 113, 117
app/utils/text_processing.py                                                  40     38     5%   27-36, 57-95
--------------------------------------------------------------------------------------------------------
TOTAL                                                                      23529  11841    50%

============================= slowest 10 durations =============================
38.80s call     tests/security/test_admin_security_upgrades.py::test_admin_can_access_any_conversation
20.27s call     tests/test_admin_chat_init_event.py::test_admin_chat_returns_conversation_init_event
20.18s call     tests/security/test_admin_security_upgrades.py::test_access_control_isolation
6.00s call     tests/services/test_saga_coverage.py::test_retry_logic
2.00s call     tests/services/test_saga_coverage.py::test_max_retries_exceeded
1.52s call     tests/security/test_security_final.py::TestSecuritySuperhuman::test_generic_fuzzing_resilience
1.51s call     tests/phase3_refactoring/test_llm_client_golden_master.py::TestGoldenMaster_ErrorHandling::test_empty_response_triggers_retry
1.34s call     tests/security/test_password_compat.py::test_legacy_hash_support
1.10s call     tests/test_unified_observability.py::TestUnifiedObservabilityService::test_trace_search
0.91s call     tests/test_unified_observability.py::TestUnifiedObservabilityService::test_anomaly_detection
=========================== short test summary info ============================
FAILED tests/test_middleware_frame.py::test_dev_frame_middleware_development
FAILED tests/test_preview_headers.py::test_middleware_enabled_in_dev - Attrib...
FAILED tests/test_preview_headers.py::test_middleware_enabled_in_codespaces
FAILED tests/test_preview_headers.py::test_middleware_disabled_in_production
FAILED tests/test_preview_headers.py::test_headers_removed_in_dev_client - as...
FAILED tests/test_streaming_event_type_bug.py::test_chat_stream_has_delta_event_type
FAILED tests/api/test_overmind_router.py::test_create_mission_endpoint - Type...
FAILED tests/api/test_overmind_router.py::test_stream_endpoint_structure - sq...
FAILED tests/services/test_admin_chat_boundary_service_comprehensive.py::test_get_or_create_conversation_invalid_id
FAILED tests/services/test_admin_chat_boundary_service_final.py::TestAdminChatBoundaryService::test_get_or_create_conversation_delegation
ERROR tests/test_models.py::test_user_set_password - TypeError: 'class Meta' ...
ERROR tests/test_models.py::test_user_repr - TypeError: 'class Meta' for <cla...
ERROR tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_get_recent_conversations_success
ERROR tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_get_recent_conversations_limit
ERROR tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_success
ERROR tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_not_found
ERROR tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_security_violation
ERROR tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_db_error
ERROR tests/services/test_history_service_comprehensive.py::TestHistoryServiceComprehensive::test_rate_message_unexpected_error
======= 10 failed, 894 passed, 9 warnings, 9 errors in 140.96s (0:02:20) =======
