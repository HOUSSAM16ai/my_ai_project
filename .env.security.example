# ==========================================
# === Security Scanning Environment Configuration ===
# ==========================================
# Enterprise-grade security settings for different environments
# Usage: source .env.security before running security scans

# =========================================
# Environment Detection
# =========================================
# AUTO, DEVELOPMENT, STAGING, PRODUCTION
SECURITY_ENV=AUTO

# =========================================
# Semgrep Configuration
# =========================================

# Semgrep Scan Mode (rapid, full, deep, audit)
# - rapid: Fast scan with basic security rules (5-10 min)
# - full: Complete scan with all security rules (15-20 min)
# - deep: Comprehensive scan including experimental rules (30+ min)
# - audit: Full audit mode with maximum coverage (60+ min)
SEMGREP_SCAN_MODE=rapid

# Semgrep Rule Sets (comma-separated)
# Common rulesets: p/ci, p/security-audit, p/owasp-top-ten, p/cwe-top-25
SEMGREP_RULESETS=p/ci,p/security-audit,p/owasp-top-ten

# Semgrep Severity Filter (INFO, WARNING, ERROR)
# Only report issues at or above this severity
SEMGREP_MIN_SEVERITY=WARNING

# Semgrep Exit Code Behavior
# true = Fail build on findings (blocking)
# false = Report findings but don't fail (non-blocking)
SEMGREP_FAIL_ON_FINDINGS=false

# Semgrep Timeout (seconds)
SEMGREP_TIMEOUT=300

# Semgrep Max Memory (MB)
SEMGREP_MAX_MEMORY=4096

# Semgrep Jobs (parallel execution)
# 0 = auto-detect CPU cores
SEMGREP_JOBS=0

# =========================================
# Development Environment Settings
# =========================================
# Optimized for speed and developer experience

DEV_SEMGREP_MODE=rapid
DEV_MIN_SEVERITY=ERROR
DEV_FAIL_ON_FINDINGS=false
DEV_CONTINUE_ON_ERROR=true
DEV_SKIP_TESTS=true
DEV_SKIP_MIGRATIONS=true
DEV_SKIP_DOCS=true

# =========================================
# Staging Environment Settings
# =========================================
# Balance between speed and thoroughness

STAGING_SEMGREP_MODE=full
STAGING_MIN_SEVERITY=WARNING
STAGING_FAIL_ON_FINDINGS=false
STAGING_CONTINUE_ON_ERROR=true
STAGING_SKIP_TESTS=true
STAGING_SKIP_MIGRATIONS=true
STAGING_SKIP_DOCS=true

# =========================================
# Production Environment Settings
# =========================================
# Maximum security with strict enforcement

PROD_SEMGREP_MODE=deep
PROD_MIN_SEVERITY=INFO
PROD_FAIL_ON_FINDINGS=true
PROD_CONTINUE_ON_ERROR=false
PROD_SKIP_TESTS=true
PROD_SKIP_MIGRATIONS=true
PROD_SKIP_DOCS=true

# =========================================
# Audit Mode Settings
# =========================================
# Comprehensive security audit (manual runs only)

AUDIT_SEMGREP_MODE=audit
AUDIT_MIN_SEVERITY=INFO
AUDIT_FAIL_ON_FINDINGS=false
AUDIT_CONTINUE_ON_ERROR=false
AUDIT_SKIP_TESTS=false
AUDIT_SKIP_MIGRATIONS=false
AUDIT_SKIP_DOCS=false

# =========================================
# GitHub Actions Integration
# =========================================

# Enable SARIF upload to GitHub Security
GITHUB_SARIF_UPLOAD=true

# Enable PR comments with findings
GITHUB_PR_COMMENTS=true

# Enable GitHub annotations
GITHUB_ANNOTATIONS=true

# =========================================
# Reporting Configuration
# =========================================

# Report Format (json, sarif, text, gitlab, junit)
SECURITY_REPORT_FORMAT=json,sarif

# Report Output Directory
SECURITY_REPORT_DIR=./security-reports

# Report Retention (days)
SECURITY_REPORT_RETENTION=30

# Enable Detailed Reports
SECURITY_DETAILED_REPORTS=true

# Enable Trend Analysis
SECURITY_TREND_ANALYSIS=true

# =========================================
# Performance Optimization
# =========================================

# Enable caching of scan results
SEMGREP_CACHE_ENABLED=true

# Cache directory
SEMGREP_CACHE_DIR=.semgrep_cache

# Incremental scanning (only changed files)
SEMGREP_INCREMENTAL=true

# =========================================
# Auto-Fix Configuration
# =========================================

# Enable auto-fix for safe issues
SEMGREP_AUTOFIX_ENABLED=false

# Auto-fix mode (dry-run, apply)
SEMGREP_AUTOFIX_MODE=dry-run

# Auto-fix severity threshold (only fix issues at or below this level)
SEMGREP_AUTOFIX_MAX_SEVERITY=INFO

# =========================================
# Notification Configuration
# =========================================

# Enable Slack notifications
SECURITY_SLACK_ENABLED=false
SECURITY_SLACK_WEBHOOK_URL=

# Enable email notifications
SECURITY_EMAIL_ENABLED=false
SECURITY_EMAIL_TO=

# =========================================
# Advanced Settings
# =========================================

# Enable experimental rules
SEMGREP_EXPERIMENTAL=false

# Enable proprietary rules (if available)
SEMGREP_PROPRIETARY=false

# Semgrep App Token (for Semgrep Cloud)
# SEMGREP_APP_TOKEN=

# Enable metrics collection
SEMGREP_METRICS=true

# Enable anonymous usage statistics
SEMGREP_ANONYMOUS_STATS=true

# =========================================
# Exclusions and Filters
# =========================================

# Additional paths to exclude (comma-separated)
# These supplement .semgrepignore
SEMGREP_EXCLUDE_PATHS=

# File patterns to include (comma-separated)
SEMGREP_INCLUDE_PATTERNS=*.py,*.js,*.ts,*.jsx,*.tsx

# Maximum file size to scan (MB)
SEMGREP_MAX_FILE_SIZE=10

# =========================================
# CI/CD Integration Flags
# =========================================

# Skip scan on draft PRs
SKIP_DRAFT_PR=true

# Skip scan on dependabot PRs
SKIP_DEPENDABOT_PR=false

# Only scan changed files in PRs
PR_SCAN_CHANGED_ONLY=true

# =========================================
# Quality Gates
# =========================================

# Maximum allowed critical findings
MAX_CRITICAL_FINDINGS=0

# Maximum allowed high findings
MAX_HIGH_FINDINGS=5

# Maximum allowed medium findings
MAX_MEDIUM_FINDINGS=20

# Maximum allowed low findings
MAX_LOW_FINDINGS=50

# =========================================
# Notes
# =========================================
# 1. This file should NOT be committed to git (.gitignore it)
# 2. Copy .env.security.example and customize for your environment
# 3. Load with: source .env.security
# 4. Override settings via CLI or GitHub Actions secrets
# 5. Production settings should be stored in CI/CD secrets
