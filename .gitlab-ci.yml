# .gitlab-ci.yml
# ======================================================================================
# ==          OMEGA INTELLIGENCE PIPELINE (GITLAB EDITION)                        ==
# ======================================================================================

stages:
  - intelligence_scan
  - synchronization

variables:
  # Enable Workload Identity (GitLab OIDC)
  GITLAB_OIDC_TOKEN: $CI_JOB_JWT_V2

.omega_base:
  image: python:3.12-slim
  before_script:
    - pip install requests pyyaml
    - chmod +x scripts/omega_orchestrator.py

omega_verification:
  stage: intelligence_scan
  extends: .omega_base
  script:
    - echo "ðŸš€ Initiating Omega-Level Verification..."
    - python scripts/omega_orchestrator.py --mode=autonomous
  artifacts:
    when: on_failure
    paths:
      - omega_diagnostics.log

omega_sync:
  stage: synchronization
  extends: .omega_base
  only:
    - main
  script:
    - echo "ðŸ”„ Initiating Cross-Platform Synchronization..."
    - python scripts/omega_orchestrator.py --mode=sync
  environment:
    name: production
    url: https://github.com/cogniforge/reality-kernel-v3
